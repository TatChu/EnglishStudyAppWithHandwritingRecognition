"use strict";var languageJs=function(){return{vi:{MESSAGE:"Thông báo!",MESSAGE_REQUIRE_LOGIN:"Bạn chưa đăng nhập.",MESSAGE_LOGIN_FACEBOOK:"Bạn chưa đăng nhập facebook.",MESSAGE_REQUIRE_ROLE:"Bạn không có quyền đề truy cập trang này.",EVENT_STOP:"Thời gian tham gia chương trình đã hết, cảm ơn bạn đã quan tâm.",MENU_HOME:"Trang chủ",MENU_ABOUT:"Giới thiệu",MENU_CONTACT:"Liên hệ",MENU_LANGUAGE:"Ngôn ngữ",DT_SUNDAY:"Cn",DT_MONDAY:"Hai",DT_TUESDAY:"Ba",DT_WEDNESDAY:"Tư",DT_THURSDAY:"Năm",DT_FRIDAY:"Sáu",DT_SATURDAY:"Bảy",DT_JANUARY:"Tháng 1",DT_FEBRUARY:"Tháng 2",DT_MARCH:"Tháng 3",DT_APRIL:"Tháng 4",DT_MAY:"Tháng 5",DT_JUNE:"Tháng 6",DT_JULY:"Tháng 7",DT_AUGUST:"Tháng 8",DT_SEPTEMBER:"Tháng 9",DT_OCTOBER:"Tháng 10",DT_NOVEMBER:"Tháng 11",DT_DECEMBER:"Tháng 12"},en:{MESSAGE:"Infomation!",MESSAGE_REQUIRE_LOGIN:"Bạn chưa đăng nhập.",MESSAGE_LOGIN_FACEBOOK:"Bạn chưa đăng nhập facebook.",MESSAGE_REQUIRE_ROLE:"Bạn không có quyền đề truy cập trang này.",EVENT_STOP:"Thời gian tham gia chương trình đã hết, cảm ơn bạn đã quan tâm EN.",MENU_HOME:"Home",MENU_ABOUT:"About",MENU_CONTACT:"Contact",MENU_LANGUAGE:"Languages",DT_SUNDAY:"Sun",DT_MONDAY:"Mon",DT_TUESDAY:"Tue",DT_WEDNESDAY:"Wed",DT_THURSDAY:"Thu",DT_FRIDAY:"Fri",DT_SATURDAY:"Sat",DT_JANUARY:"Jan",DT_FEBRUARY:"Feb",DT_MARCH:"Mar",DT_APRIL:"Apr",DT_MAY:"May",DT_JUNE:"Jun",DT_JULY:"Jul",DT_AUGUST:"Aug",DT_SEPTEMBER:"Sep",DT_OCTOBER:"Otc",DT_NOVEMBER:"Nov",DT_DECEMBER:"Dec"}}}(),settingJs=function(){var e=(new Date,window.location.host,{facebookAppId:settings.facebookId,appPrefix:"EnglishStudyApp",webUrl:settings.services.webUrl,apiUrl:settings.services.apiUrl,socketUrl:settings.services.socketApi,adminUrl:settings.services.admin,userApiUrl:settings.services.apiUrl,logApiUrl:settings.services.logApi,uploadApiUrl:settings.services.uploadApi,uploadDirectory:{general:"/files/",category:"/files/category_image/",vocabulary:"/files/vocabulary_image/",product:"/files/product_image/",certificate:"/files/certificate_image/",blog:"/files/blog_image/",banner:"/files/banner_image/",thumb:"/files/thumb_image/",thumb_product:"/files/thumb_image/product_image/",tmp:"/files/tmp/",media_old:"/files/media_old/",media_old_product:"/files/media_old/product/"}});return{configs:e,appPrefix:e.appPrefix,storageExpireTime:void 0}}(),DateTime=function(){function e(e,t){var n=864e5;return Math.round((t.getTime()-e.getTime())/n)}function t(e,t){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())+1}function n(e,t,n){return e>=t&&e<=n}function a(e,t){var n=t.filter(function(t){return new Date(t).toDateString()===e.toDateString()});return 0!==n.length}function r(e){return e.getTime()/1e3}function o(e){var t=e;t=t.replace(/\D/g," ");var n=t.split(" ");n[1]--;var a=new Date(Date.UTC(n[0],n[1],n[2],n[3],n[4],n[5]));return a}function i(e){var t=new Date;return new Date(t.getFullYear(),e,0).getDate()}function s(e){var t=new Date,n=0;t.getMonth()<e.getMonth()?n=1:t.getMonth()==e.getMonth()&&t.getDate()<e.getDate()&&(n=1);var a=t.getFullYear()-e.getFullYear()-n;return a}return{dayCount:e,monthCount:t,dateBetween:n,dateContain:a,dateToTimestamp:r,isoDateToDate:o,daysInMonth:i,getAge:s}}(),ExcelJs=function(){function e(){var e=[[1,2,3,.5,7],[!0,!1,null,"sheetjs"],["foo","bar",new Date("2014-02-19T14:30Z"),"0.3"],["baz",null,"qux"]],n={type:"xlsx",sheetName:"SheetJS1",fileName:"dl"};t(e,n)}function t(e,t){t={type:t.type||"xlsx",sheetName:t.sheetName||"SheetJS",fileName:t.fileName||"test"};var n=t.sheetName,i=new o,s=a(e);i.SheetNames.push(n),i.Sheets[n]=s;var u={bookType:t.type,bookSST:!1,type:"binary"},c=XLSX.write(i,u);saveAs(new Blob([r(c)],{type:""}),t.fileName+"."+t.type)}function n(e,t){t&&(e+=1462);var n=Date.parse(e);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function a(e,t){for(var a={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!=e.length;++o)for(var i=0;i!=e[o].length;++i){r.s.r>o&&(r.s.r=o),r.s.c>i&&(r.s.c=i),r.e.r<o&&(r.e.r=o),r.e.c<i&&(r.e.c=i);var s={v:e[o][i]};if(null!=s.v){var u=XLSX.utils.encode_cell({c:i,r:o});"number"==typeof s.v?s.t="n":"boolean"==typeof s.v?s.t="b":s.v instanceof Date?(s.t="n",s.z=XLSX.SSF._table[14],s.v=n(s.v)):s.t="s",a[u]=s}}return r.s.c<1e7&&(a["!ref"]=XLSX.utils.encode_range(r)),a}function r(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!=e.length;++a)n[a]=255&e.charCodeAt(a);return t}function o(){return this instanceof o?(this.SheetNames=[],void(this.Sheets={})):new o}return{exportExcel:t,testExcel:e}}(),helperJs=function(){function e(e,t,n){function a(n){return n[e]===t}return n.find(a)}function t(){var e=0;$(window).on("scroll",function(t){var n=$(this).scrollTop();n>e?console.log("down"):console.log("up"),e=n})}function n(e){e.replaceWith(e.val("").clone(!0))}function a(e){var t=!0;if(isNaN(e))if(null===e||void 0===e)t=!0;else for(var n in e)e.hasOwnProperty(n)&&(t=!1);else t=!1;return t}function r(e,t){var n=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),a="[\\?&]"+n+"=([^&#]*)",r=new RegExp(a),o=r.exec(e);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))}function o(e,t,n,a,r){e=e||0,t=isNaN(t=Math.abs(t))?0:t,n=void 0!==n?n:"",a=a||".",r=r||",";var o=e<0?"-":"",i=parseInt(e=Math.abs(+e||0).toFixed(t),10)+"",s=(s=i.length)>3?s%3:0;return n+o+(s?i.substr(0,s)+a:"")+i.substr(s).replace(/(\d{3})(?=\d)/g,"$1"+a)+(t?r+Math.abs(e-i).toFixed(t).slice(2):"")}function i(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function s(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function u(e,t){var n=null;return function(){var a=this,r=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(a,r)},t)}}function c(e,t,n){t||(t=250);var a,r;return function(){var o=n||this,i=+new Date,s=arguments;a&&i<a+t?(clearTimeout(r),r=setTimeout(function(){a=i,e.apply(o,s)},t)):(a=i,e.apply(o,s))}}function l(e,t){var n=e.replace("#","");n=n.match(new RegExp("(.{"+n.length/3+"})","g"));for(var a=0;a<n.length;a++)n[a]=parseInt(1==n[a].length?n[a]+n[a]:n[a],16);return"undefined"!=typeof t&&n.push(t),"rgba("+n.join(",")+")"}function d(e,t){function n(e){r++,r===e&&a()}function a(){"function"==typeof t&&t()}var r=0,o=e.length;if(o)for(var i=0;i<o;i++){var s=new Image;s.src=e[i],s.onload=function(e){n(o),console.info("File loaded: ",e.target.currentSrc)},s.onerror=function(e){n(o),console.info("Cannot load file: ",e.target.currentSrc)}}else a()}function p(e,t,n){t="undefined"!=typeof t?t:1e3,n="undefined"!=typeof n?n:0;var a=$(e).offset(),r=a.top+n;$("html,body").animate({scrollTop:r},t)}function g(e){e="undefined"!=typeof e?e:1e3,$("html,body").animate({scrollTop:0},e)}function m(e,t){return Math.random()*(t-e+1)+e}function h(e,t){return Math.floor(Math.random()*(t-e+1))+e}function f(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}return{detectScrollDirection:t,clearFileInput:n,isUndefinedNullEmpty:a,getQueryString:r,formatMoney:o,enterFullScreen:i,exitFullScreen:s,debounce:u,throttle:c,hexToRgb:l,preloader:d,scrollToElement:p,scrollToTop:g,randomRangeFloat:m,randomRangeInt:h,extend:f,findObject:e}}();!function(){$.fn.bzAccordion=function(e,t){var n=this.find(".item");t&&(n.first().find(".question").addClass("expanded"),n.first().find(".answer").show()),n.find(".question").click(function(){$(this).hasClass("expanded")?($(this).removeClass("expanded"),$(this).parent().find(".answer").slideUp(200)):(e&&$.each(n.find(".question"),function(e,t){$(t).removeClass("expanded"),$(t).parent().find(".answer").slideUp(200)}),$(this).addClass("expanded"),$(this).parent().find(".answer").slideDown(200))})}}(),function(){Array.prototype.getIndexBy=function(e,t){for(var n=0;n<this.length;n++)if(this[n][e]==t)return n;return-1},Array.prototype.removeAt=function(e){var t=this.splice(e,1);return t},String.prototype.format=function(){var e=arguments;return this.replace(/\{\{|\}\}|\{(\d+)\}/g,function(t,n){return"{{"==t?"{":"}}"==t?"}":e[n]})},String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}();var sortJs=function(){function e(e){if(e.length<=1)return e;for(var t=e.length,n=0;n<t;n++)for(var a=0;a<t-1;a++)if(e[a]>e[a+1]){var r=e[a];e[a]=e[a+1],e[a+1]=r}return e}function t(e){if(e.length<=1)return e;var n=Math.floor((e.length-1)/2),a=e[n],r=[],o=[];e=e.slice(0,n).concat(e.slice(n+1));for(var i=0;i<e.length;i++)e[i]<a?r.push(e[i]):o.push(e[i]);return[].concat(t(r),[a],t(o))}function n(e){if(e.length<=1)return e;var t=Math.floor(e.length/2),a=e.slice(0,t),r=e.slice(t),o=function(e,t){for(var n=[];e.length&&t.length;)e[0]<t[0]?n.push(e.shift()):n.push(t.shift());return n.concat(e).concat(t)};return o(n(a),n(r))}function a(e){for(var t=0;t<e.length;t++){for(var n=t,a=t+1;a<e.length;a++)e[a]<e[n]&&(n=a);if(n!=t){var r=e[n];e[n]=e[t],e[t]=r}}return e}function r(e){for(var t=0;t<e.length;t++)for(var n=t-1,a=e[t];n>=0&&e[n]>a;)e[n+1]=e[n],e[n]=a,n--;return e}return{bubble:e,quick:t,merge:n,selection:a,insertion:r}}(),Storage=function(){function e(e){var t=new Date,a=Math.round(+t/1e3),r=JSON.parse(localStorage.getItem(settingJs.appPrefix+"."+e))||{},o=r.storageExpireTime||0;return o&&o<a?void n(settingJs.appPrefix+"."+e):r.store}function t(e,t,n){var a=new Date,r=Math.round(a.setSeconds(a.getSeconds()+n)/1e3),o=JSON.stringify({storageExpireTime:r,store:t});try{localStorage.setItem(settingJs.appPrefix+"."+e,o)}catch(i){i==QUOTA_EXCEEDED_ERR&&alert("Quota exceeded!")}return o}function n(e){localStorage.removeItem(settingJs.appPrefix+"."+e)}function a(){localStorage.clear()}return{get:e,set:t,remove:n,clear:a}}(),Application=function(){function e(e){angular.module(o).requires.push(e)}function t(e){s.push(e)}function n(e,t){function n(n){function a(n,a){n.forEach(function(t){t.config.params=t.config.params||{},e.state(t.state,t.config)}),a&&!o&&(o=!0,t.otherwise(a))}function r(){return n.get()}var o=!1;return{configureStates:a,getStates:r}}n.$inject=["$state"],this.$get=n}function a(e,t,n,a,r,o,i){e.errorOnUnhandledRejections(!1),a.setMessageTemplate("assets/global/message/view.html"),angular.extend(r,{extendedTimeOut:1e3,timeOut:1e3,newestOnTop:!0,positionClass:"toast-bottom-right",preventDuplicates:!1,preventOpenDuplicates:!1,tapToDismiss:!0,allowHtml:!0,closeButton:!0,target:"body"}),o.startSymbol("[["),o.endSymbol("]]"),n.html5Mode(!1).hashPrefix("!"),t.defaults.withCredentials=!0,t.defaults.headers.post["Content-Type"]="application/json; charset=UTF-8"}function r(e,t,n,a,r,o,i,u){function c(e,t,n){r.go(e,t,n)}window.fbAsyncInit=function(){FB.init({appId:settingJs.configs.facebookAppId,status:!0,xfbml:!0,version:"v2.9"})},e.configureStates(s,"/"),angular.element("body").removeClass("hide"),t._=window._,t.pageData={},t.pageMethods={},t.pageMethods.authSvc=i,t.pageMethods.redirect=c,t.$on("$stateChangeStart",function(e,n,a,r,o){t.pageData.title=n.data.title,t.pageData.className=n.name,t.pageData.menuType=n.data.menuType}),t.$on("$stateChangeSuccess",function(e,r,o,i,s){n.scrollTop=a[0].body.scrollTop=a[0].documentElement.scrollTop=0,t.pageData.currentState=r,t.pageData.currentParams=o}),t.promotionForOrderDeleveryOnAffternoon={value:0,status:!1,type:"PC"},t.promotionForFirstOrder={value:0,status:!1,type:"PC"},t.freeShipUrban={value:999999999,status:!1,type:"MN"},t.freeShipSuburb={value:999999999,status:!1,type:"MN"}}n.$inject=["$stateProvider","$urlRouterProvider"],a.$inject=["$qProvider","$httpProvider","$locationProvider","$bzPopupProvider","toastrConfig","$interpolateProvider","$resourceProvider"],r.$inject=["routerHelper","$rootScope","$window","$document","$state","$timeout","authSvc","notiSvc"];var o="bzApp",i=["ui.bootstrap","ngSanitize","ngAnimate","ngMessages","ngResource","ui.router","toastr","ngPopup","daterangepicker","angularjs-datetime-picker","ngTable","ngFileUpload","ui.select2","ckeditor"],s=[];return angular.module(o,i).provider("routerHelper",n).config(a).run(r),angular.element(document).ready(function(){!function(e,t,n){var a,r=e.getElementsByTagName(t)[0];e.getElementById(n)||(a=e.createElement(t),a.id=n,a.src="//connect.facebook.net/en_US/sdk.js",r.parentNode.insertBefore(a,r))}(document,"script","facebook-jssdk"),angular.bootstrap(document,[o])}),{registerModule:e,registerRouter:t}}();!function(){function e(e,t,n,a){function r(t,n){var a=e.defer();return"add-product"===t?c(n.product,n.quantity):"set-quantity"===t?u(n.product,n.quantity):"delete-product"===t?s(n.product):"delete-cart"===t?i():(a.reject("Type mismach"),a.promise)}function o(){var r=e.defer();return a.api(t.settings.services.apiUrl+"/order/cart").get({},function(e){n.Cart=e.cart,n.$broadcast("Cart:getCart",e.cart),r.resolve(e)},function(e){r.reject(e)}),r.promise}function i(){var r=e.defer();return a.api(t.settings.services.apiUrl+"/order/delete-cart").get({},function(e){n.Cart={items:[],total:0},n.$broadcast("Cart:getCart",e.cart),r.resolve(e)},function(e){r.reject(e)}),r.promise}function s(r){var o=e.defer();return a.api(t.settings.services.apiUrl+"/order/delete-product/"+r).get({},function(e){n.Cart=e.cart,n.$broadcast("Cart:getCart",e.cart),o.resolve(e)},function(e){o.reject(e)}),o.promise}function u(r,o){var i=e.defer();return a.api(t.settings.services.apiUrl+"/order/set-quantity/"+r+"/"+o).get({},function(e){e.success&&(n.Cart=e.cart,n.$broadcast("Cart:getCart",e.cart)),i.resolve(e)},function(e){i.reject(e)}),i.promise}function c(t,r){var o=e.defer();return a.api(settingJs.configs.userApiUrl+"/order/"+t+"/"+r).get({},function(e){e.success&&(n.Cart=e.cart,n.$broadcast("Cart:getCart",e.cart)),o.resolve(e)},function(e){o.reject(e)}),o.promise}return{getCart:o,update:r}}function t(e,t){return t.api(settingJs.configs.userApiUrl+"/user/:method/:id",{method:"@method",id:"@id"})}function n(e,t){function n(n){var a=e.defer();return t.api(settingJs.configs.userApiUrl+"/upload/base64").save(n,function(e){a.resolve(e)},function(e){a.reject(e)}),a.promise}return{uploadBase64:n}}function a(e,t){function n(){var n=e.defer();return t.api(settingJs.configs.adminUrl+"/noti-dup-contact").get({},{},function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise}return{getDupContact:n}}function r(e,t,n,a,r){function o(){return 0!==_.intersection(n.user.scope,["super-admin"]).length}function i(){return 0!==_.intersection(n.user.scope,["admin"]).length}function s(e,t){var a="string"==typeof t,r=n.permissions,o=null;if(angular.forEach(r,function(t,n){n===e&&(o=t)}),o){if("*"===o[0])return!0;if(a&&1===_.intersection([t],o).length)return!0;if(_.intersection(t,o).length===t.length)return!0}return!1}function u(e){return _.intersection(n.user.scope,e).length>0}function c(e){var t=new a(e);return t.$save({method:"register"})}function l(){var e=n.user;return e}function d(e){return Storage.set(settingJs.appPrefix+"bzp",e,settingJs.storageExpireTime),Storage.set(settingJs.appPrefix+"bzl",!0,settingJs.storageExpireTime),e}function p(){var e=Storage.get(settingJs.appPrefix+"bzl");return!!e}function g(e,a,o){var i=t.defer();return r.api(n.settings.services.apiUrl+"/user/login").save({},e,function(e){d(e),i.resolve(e),angular.isFunction(a)&&a(e)},function(e){i.reject(e),angular.isFunction(o)&&o(e)}),i.promise}function m(e){l();r.api(n.settings.services.apiUrl+"/user/logout").save({},{},function(t){d(void 0),angular.isFunction(e)&&e(t),n.location.href=settings.services.webUrl})}function h(t){var a=e.open({animation:!0,templateUrl:settings.services.webUrl+"/modules/web-auth/view/client/popup/login/view.html",controller:"popLoginCtrl",controllerAs:"vmLogin"});a.result.then(function(e){return e||(t?n.location.href=t:n.location.reload()),e})}function f(){e.open({animation:!0,templateUrl:settings.services.webUrl+"/modules/web-auth/view/client/popup/register/view.html",controller:"popRegisterCtrl",controllerAs:"vmRegister"})}function v(){e.open({animation:!0,templateUrl:settings.services.webUrl+"/modules/web-auth/view/client/popup/forgot-pass/view.html",controller:"popForgotPassCtrl",controllerAs:"vmForgotPass"})}function y(){e.open({animation:!0,templateUrl:"modules/admin-user/view/client/popup/change-pass/view.html",controller:"popChangePassCtrl",controllerAs:"mvCPass"})}function b(e){var t=new a(e);return t.$save({method:"change-password"})}function T(e){var t=new a(e);return t.$save({method:"forgot-password"})}function P(e){var t=new a(e);return t.$save({method:"reset-password"})}function $(e,t){var n=new a(e);return n.$update({id:t})}function C(){var e=t.defer();return FB.getLoginStatus(function(t){if("connected"===t.status){t.authResponse.accessToken;FB.api("/me",{fields:"id,name,email,picture"},function(t){e.resolve(t)})}else FB.login(function(t){if("not_authorized"===t.status&&e.resolve({error:"Vui lòng đồng ý sử dụng ứng dụng để đăng nhập tài khoản"}),"connected"===t.status){t.authResponse.accessToken;FB.api("/me",{fields:"id,name,email,picture"},function(t){e.resolve(t)})}},{scope:"email"})}),e.promise}function S(e,a,o){var i=t.defer(),s={email:e.email,provider_id:e.id,name:e.name,profile_picture:e.profile_picture};return r.api(n.settings.services.userApi+"/user/facebook-login").save({},s,function(e){d(e),i.resolve(e),angular.isFunction(a)&&a(e)},function(e){i.reject(e),angular.isFunction(o)&&o(e)}),i.promise}return n.user=n.user||{},{isSuperAdmin:o,isAdmin:i,hasPermission:s,exist:u,register:c,getProfile:l,setProfile:d,isSignedIn:p,siteLogin:g,siteLogout:m,popLogin:h,popRegister:f,popForgotPass:v,popChangePass:y,postChangePass:b,forgotPassword:T,resetPassword:P,update:$,getFacebook:C,facebookLogin:S}}function o(e){function t(e){if(e){var t=e.toLowerCase();return t=t.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a"),t=t.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),t=t.replace(/i|í|ì|ỉ|ĩ|ị/gi,"i"),t=t.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),t=t.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),t=t.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),t=t.replace(/đ/gi,"d"),t=t.replace(/\`|\~|\!|\@|\#|\||\$|\%|\^|\&|\*|\(|\)|\+|\=|\,|\.|\/|\?|\>|\<|\'|\"|\:|\;|_/gi,""),t=t.replace(/ /gi,"-"),t=t.replace(/\-\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-/gi,"-"),t=t.replace(/\-\-/gi,"-"),t="@"+t+"@",t=t.replace(/\@\-|\-\@|\@/gi,"")}return e}function n(e,t,n){function a(n){return n[e]===t}return n.find(a)}function a(e,t,n){var r,o=[];if(n=n||"",angular.isArray(e)){var i=e.filter(function(e){return e.parentId===t});if(i.length)for(var s=0;s<i.length;s++){i[s].name=n+i[s].name,o.push(i[s]);for(var u=a(e,i[s].id,n+"—"),c=0;c<u.length;c++)o.push(u[c])}r=o}else r=e;return r}function r(){e.open({templateUrl:"modules/popup/cropper/view.html",closeOnBg:!1,data:{ratio:1,width:320,height:320,type:"image/jpeg",event:"bz:CropperAvatarSuccess",image:"images/demo.jpg",props:{btnOk:"Lưu",btnCancel:"Huỷ bỏ",btnOkEvent:"bz:CropperAvatarOk",btnCancelEvent:"bz:CroppperAvatarCancel"}}})}function o(e,t){"undefined"!=typeof Storage?Storage.set(e,t,settingJs.storageExpireTime):console.error("Sorry! The browser does not support Storage.")}function i(e){if("undefined"!=typeof Storage){var t=Storage.get(e);return t}return console.error("Sorry! The browser does not support Storage."),null}function s(e){"undefined"!=typeof Storage?Storage.remove(e):console.error("Sorry! The browser does not support Storage.")}function u(e){o(settingJs.appPrefix+"_infoUser",e)}function c(){return i(settingJs.appPrefix+"_infoUser")}function l(){s(settingJs.appPrefix+"_infoUser")}return{recusive:a,cropAvatar:r,findObject:n,textToSlug:t,setLocalStorage:o,getLocalStorage:i,removeLocalStorage:s,setInfoUser:u,getInfoUser:c,removeInfoUser:l}}function i(e){function t(t,n,a){return a=a||{},a.get=angular.extend({},a.get),a.query=angular.extend({isArray:!0},a.query),a.update=angular.extend({method:"PUT"},a.update),a.upload=angular.extend({method:"POST",headers:{"Content-Type":void 0},transformRequest:angular.identity},a.upload),e(t,n,a)}return{api:t}}function s(e){return{load:function(t){var n=e.defer();return helperJs.preloader(t,function(){n.resolve()}),n.promise}}}o.$inject=["$bzPopup"],i.$inject=["$resource"],s.$inject=["$q"],r.$inject=["$uibModal","$q","$window","userApiFac","bzResourceSvc"],a.$inject=["$q","bzResourceSvc"],t.$inject=["$window","bzResourceSvc"],e.$inject=["$q","$window","$rootScope","bzResourceSvc"],n.$inject=["$q","bzResourceSvc"],angular.module("bzApp").service("bzUtilsSvc",o).service("bzResourceSvc",i).factory("bzPreloadSvc",s).service("authSvc",r).service("notiSvc",a).factory("userApiFac",t).service("orderApiSvc",e).service("bzUpload",n)}(),function(){function e(e){return function(t){return e.trustAsHtml(t)}}function t(e){return function(t){return e.trustAsResourceUrl(t)}}function n(){return function(e){return helperJs.formatMoney(e)}}function a(){return function(e,t){return helperJs.hexToRgb(e,t)}}function r(){return function(e){return String(e).replace(/<[^>]+>/gm,"")}}function o(){return function(e,t){var n=new Date(e),a=moment(n).format(t);return a}}function i(){return function(e,t){return t=+t,angular.isArray(e)?e.slice(t):e}}function s(){return function(e){return Object.keys(e).length}}e.$inject=["$sce"],t.$inject=["$sce"],angular.module("bzApp").filter("bzTrustHtml",e).filter("bzTrustResource",t).filter("bzCurrency",n).filter("bzHexToRgb",a).filter("bzTripHtml",r).filter("bzFormatDate",o).filter("bzFirstPage",i).filter("bzObjectKeysLength",s)}(),function(){function e(e,t){return{require:"ngModel",link:function(t,n,a,r){return e(function(){var e,o=a.checkboxClass;return e=a.value,t.$watch(a.ngModel,function(e){$(n).iCheck("update")}),$(n).iCheck({radioClass:"iradio_square-blue",checkboxClass:o||"icheckbox_square-blue",increaseArea:"20%"}).on("ifChanged",function(o){if("checkbox"===$(n).attr("type")&&a.ngModel&&t.$apply(function(){return r.$setViewValue(o.target.checked)}),"radio"===$(n).attr("type")&&a.ngModel)return t.$apply(function(){return r.$setViewValue(e)})})})}}}function t(){return{require:"ngModel",scope:{atrOptions:"=atrOptions"},link:function(e,t,n,a){var r={timePicker:!1,timePickerIncrement:30,singleDatePicker:!0,autoUpdateInput:!1,locale:{format:"DD/MM/YYYY"}};r=angular.extend({},r,e.atrOptions),t.daterangepicker(r),t.on("apply.daterangepicker",function(e,t){var n={startDate:t.startDate,endDate:t.endDate};return r.singleDatePicker?(t.element.val(t.startDate.format(t.locale.format)),a.$setViewValue(n.startDate)):(t.element.val(t.startDate.format(t.locale.format)+" - "+t.endDate.format(t.locale.format)),a.$setViewValue(n))}),a&&(a.$render=function(){if(a.$viewValue){var e=moment(a.$viewValue).format(r.locale.format);t.val(e||"")}})}}}function n(e){return{require:"ngModel",scope:{atrOptions:"=atrOptions"},link:function(t,n,a,r){var o={timePicker:!1,timePickerIncrement:30,singleDatePicker:!0,autoUpdateInput:!1,locale:{format:"DD/MM/YYYY"}};o=angular.extend({},o,t.atrOptions),e(function(){n.daterangepicker(o),n.on("apply.daterangepicker",function(e,t){var n={startDate:t.startDate,endDate:t.endDate};return t.element.val(t.startDate.format(t.locale.format)),r.$setViewValue(n.startDate)}),r&&(r.$render=function(){if(r.$viewValue){var e=moment(r.$viewValue).format(o.locale.format);n.val(e||"")}})},10)}}}function a(e){return{require:"ngModel",scope:{modelValue:"=ngModel"},link:function(t,n,a,r){e(function(){var e=n.colorpicker({color:t.modelValue});e.on("changeColor",function(e){t.$apply(function(){r.$setViewValue(e.color.toString())})})})}}}function r(e,t){return{link:function(t,n,a){function r(t){e(function(){autosize(n)},t)}r(0),t.$on("bz:redrawAutogrow",function(){r(100)})}}}function o(e){return{require:"?ngModel",transclude:!0,restrict:"A",link:function(t,n,a,r){var o;e(function(){function e(){return t.$apply(function(){return r.$setViewValue(o.getData())})}if(o=CKEDITOR.replace(n[0],{}),r)return o.on("instanceReady",function(){return o.setData(r.$viewValue)}),o.on("change",e),o.on("dataReady",e),o.on("key",e),o.on("paste",e),o.on("selectionChange",e),r.$render=function(){return o.setData(r.$viewValue)}})}}}function i(){return{link:function(e,t,n){var a=e.$eval(n.bzInputMask);Inputmask(a).mask(t[0])}}}function s(){return{restrict:"E",replace:!0,template:'<div id="bz-progressbar"><div></div></div>',link:function(e,t,n){e.$on("$stateChangeStart",function(e,n,a,r,o){function i(e){setTimeout(function(){if(e<90){var n=helperJs.randomRangeInt(e,e+10);t.find(">div").css("width",n+"%"),e+=n,i(e)}},helperJs.randomRangeInt(200,500))}setTimeout(function(){t.find(">div").css("width",0),t.fadeIn(200)},500),i(0)}),e.$on("$stateChangeSuccess",function(e,n,a,r,o){t.find(">div").css("width","100%"),setTimeout(function(){t.fadeOut(200)},500)})}}}function u(){return{replace:!0,transclude:!0,template:'<div><img ng-src="{{icon}}" /><span>{{caption}}</span></div>',link:function(e,t,n){var a=angular.element(n["for"]);e.caption=n.caption,e.icon=n.icon,t.on("click",function(e){t.hide(),a.focus()}),a.on("focus",function(e){t.hide()}),a.on("blur",function(e){var n=a.val();n.length||t.show()})}}}function c(e){return{link:function(t,n,a){var r=e(a.bzFileModel),o=r.assign;n.bind("change",function(){t.$apply(function(){o(t,n[0].files)})})}}}function l(e,t){return{restrict:"A",link:function(n,a,r){function o(a,r){n.allowInputControls&&(n.allowInputControls=!1,"up"===r?c++:c--,settingJs.pageTransitionLoop?(c>i&&(c=0),c<0&&(c=i)):(c>i&&(c=i),c<0&&(c=0),t(function(){n.allowInputControls=!0},settingJs.pageTransitionDelay)),e.go(settingJs.pageTransitionSequence[c].stateName))}var i=settingJs.pageTransitionSequence.length-1,s="",u="",c=0;n.allowInputControls=!0,n.$on("bz:allowInputControls",function(e,t){n.allowInputControls=t}),n.$on("$stateChangeSuccess",function(e,a,r,o,i){s=a.name,c=settingJs.pageTransitionSequence.getIndexBy("stateName",s),t(function(){n.allowInputControls=!0},settingJs.pageTransitionDelay)}),a.on("keydown",function(t){s=e.current.name,38!==t.keyCode&&39!==t.keyCode||(u="down",o(s,u)),37!==t.keyCode&&40!==t.keyCode||(u="up",o(s,u))}),a.mousewheel(function(e,t,n,a){u=t>0?"down":"up",o(s,u)})}}}function d(){return{require:"ngModel",link:function(e,t,n,a){var r=$(n.bzValidPasswordMatch);a.$parsers.push(function(e){return a.$setValidity("match",""!==e&&e===r[0].value),e})}}}function p(){return{require:"ngModel",link:function(e,t,n,a){var r=[/[^\w\s]+/,/[A-Z]+/,/\w+/,/\d+/],o=$(n.bzPasswordStrength);t.on("focus",function(e){o.show()}),t.on("blur",function(e){o.hide()}),a.$parsers.push(function(t){var n=0;t.length>=8&&(angular.forEach(r,function(e){e.test(t)&&n++}),e.passwordStrength=n)})}}}function g(){return{require:"ngModel",link:function(e,t,n,a){var r=parseInt(n.maxWords),o=parseInt(n.minWords)||0,i=0;a.$parsers.push(function(e){return i=e.trim().replace(/(\r\n|\n|\r)/gm," ").replace(/\.\s+/g," ").split(" ").length,a.$setValidity("mixwords",i>=o),a.$setValidity("maxwords",i<=r),e})}}}function m(e){return{require:"ngModel",scope:{bzValidExist:"="},link:function(t,n,a,r){var o=t.bzValidExist;n.on("focus",function(e){$(o.selector).hide()}),n.on("blur",function(n){o.value=r.$viewValue;var a=e(o.url),i=new a(o);i.$save(function(e){e.status&&$(o.selector).show()}),t.$apply()})}}}function h(){var e=[/[^\w\s]+/,/[A-Z]+/,/\w+/,/\d+/];return{require:"ngModel",link:function(t,n,a,r){r.$parsers.push(function(t){var n=!0;return angular.forEach(e,function(e){n=n&&e.test(t)}),r.$setValidity("passwordcharacters",n),t})}}}function f(e){return{require:"ngModel",link:function(t,n,a,r){function o(e){for(var t=[],n=[],a=0;a<i.length;a++)i[a].size>s&&t.push(i[a]),u.indexOf(i[a].type)===-1&&n.push(i[a]);return r.$setValidity("filesize",0===t.length),r.$setValidity("filetype",0===n.length),e}var i=[],s=a.fileSize,u=a.fileType.split(","),c=e(a.ngModel),l=c.assign;t.$on("bz:clearFileInput",function(){r.$setViewValue(null),r.$render(),n.val("")}),n.on("change",function(){t.$apply(function(){i=n[0].files,l(t,n[0].files),o(n.val())})})}}}function v(){return{replace:!0,transclude:!0,template:'<button><ng-transclude></ng-transclude><div class="circle animFade" ng-if="type===\'circle\'"></div><div class="bar animFade" ng-if="type===\'bar\'"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div></div></button>',link:function(e,t,n){e.type=n.loadingIcon||"circle"}}}function y(e,t){return{link:function(n,a,r){function o(e){switch(e){case 0:s="pt-page-fadeOut",i="pt-page-fadeIn";break;case 1:s="pt-page-moveToLeft",i="pt-page-moveFromRight";break;case 2:s="pt-page-moveToRight",i="pt-page-moveFromLeft";break;case 3:s="pt-page-moveToTop",i="pt-page-moveFromBottom";break;case 4:s="pt-page-moveToBottom",i="pt-page-moveFromTop";break;case 5:s="pt-page-fade",i="pt-page-moveFromRight pt-page-ontop";break;case 6:s="pt-page-fade",i="pt-page-moveFromLeft pt-page-ontop";break;case 7:s="pt-page-fade",i="pt-page-moveFromBottom pt-page-ontop";break;case 8:s="pt-page-fade",i="pt-page-moveFromTop pt-page-ontop";break;case 9:s="pt-page-moveToLeftFade",i="pt-page-moveFromRightFade";break;case 10:s="pt-page-moveToRightFade",i="pt-page-moveFromLeftFade";break;case 11:s="pt-page-moveToTopFade",i="pt-page-moveFromBottomFade";break;case 12:s="pt-page-moveToBottomFade",i="pt-page-moveFromTopFade";break;case 13:s="pt-page-moveToLeftEasing pt-page-ontop",i="pt-page-moveFromRight";break;case 14:s="pt-page-moveToRightEasing pt-page-ontop",i="pt-page-moveFromLeft";break;case 15:s="pt-page-moveToTopEasing pt-page-ontop",i="pt-page-moveFromBottom";break;case 16:s="pt-page-moveToBottomEasing pt-page-ontop",i="pt-page-moveFromTop";break;case 17:s="pt-page-scaleDown",i="pt-page-moveFromRight pt-page-ontop";break;case 18:s="pt-page-scaleDown",i="pt-page-moveFromLeft pt-page-ontop";break;case 19:s="pt-page-scaleDown",i="pt-page-moveFromBottom pt-page-ontop";break;case 20:s="pt-page-scaleDown",i="pt-page-moveFromTop pt-page-ontop";break;case 21:s="pt-page-scaleDown",i="pt-page-scaleUpDown pt-page-delay300";break;case 22:s="pt-page-scaleDownUp",i="pt-page-scaleUp pt-page-delay300";break;case 23:s="pt-page-moveToLeft pt-page-ontop",i="pt-page-scaleUp";break;case 24:s="pt-page-moveToRight pt-page-ontop",i="pt-page-scaleUp";break;case 25:s="pt-page-moveToTop pt-page-ontop",i="pt-page-scaleUp";break;case 26:s="pt-page-moveToBottom pt-page-ontop",i="pt-page-scaleUp";break;case 27:s="pt-page-scaleDownCenter",i="pt-page-scaleUpCenter pt-page-delay400";break;case 28:s="pt-page-rotateRightSideFirst",i="pt-page-moveFromRight pt-page-delay200 pt-page-ontop";break;case 29:s="pt-page-rotateLeftSideFirst",i="pt-page-moveFromLeft pt-page-delay200 pt-page-ontop";break;case 30:s="pt-page-rotateTopSideFirst",i="pt-page-moveFromTop pt-page-delay200 pt-page-ontop";break;case 31:s="pt-page-rotateBottomSideFirst",i="pt-page-moveFromBottom pt-page-delay200 pt-page-ontop";break;case 32:s="pt-page-flipOutRight",i="pt-page-flipInLeft pt-page-delay500";break;case 33:s="pt-page-flipOutLeft",i="pt-page-flipInRight pt-page-delay500";break;case 34:s="pt-page-flipOutTop",i="pt-page-flipInBottom pt-page-delay500";break;case 35:s="pt-page-flipOutBottom",i="pt-page-flipInTop pt-page-delay500";break;case 36:s="pt-page-rotateFall pt-page-ontop",i="pt-page-scaleUp";break;case 37:s="pt-page-rotateOutNewspaper",i="pt-page-rotateInNewspaper pt-page-delay500";break;case 38:s="pt-page-rotatePushLeft",i="pt-page-moveFromRight";break;case 39:s="pt-page-rotatePushRight",i="pt-page-moveFromLeft";break;case 40:s="pt-page-rotatePushTop",i="pt-page-moveFromBottom";break;case 41:s="pt-page-rotatePushBottom",i="pt-page-moveFromTop";break;case 42:s="pt-page-rotatePushLeft",i="pt-page-rotatePullRight pt-page-delay180";break;case 43:s="pt-page-rotatePushRight",i="pt-page-rotatePullLeft pt-page-delay180";break;case 44:s="pt-page-rotatePushTop",i="pt-page-rotatePullBottom pt-page-delay180";break;case 45:s="pt-page-rotatePushBottom",i="pt-page-rotatePullTop pt-page-delay180";break;case 46:s="pt-page-rotateFoldLeft",i="pt-page-moveFromRightFade";break;case 47:s="pt-page-rotateFoldRight",i="pt-page-moveFromLeftFade";break;case 48:
s="pt-page-rotateFoldTop",i="pt-page-moveFromBottomFade";break;case 49:s="pt-page-rotateFoldBottom",i="pt-page-moveFromTopFade";break;case 50:s="pt-page-moveToRightFade",i="pt-page-rotateUnfoldLeft";break;case 51:s="pt-page-moveToLeftFade",i="pt-page-rotateUnfoldRight";break;case 52:s="pt-page-moveToBottomFade",i="pt-page-rotateUnfoldTop";break;case 53:s="pt-page-moveToTopFade",i="pt-page-rotateUnfoldBottom";break;case 54:s="pt-page-rotateRoomLeftOut pt-page-ontop",i="pt-page-rotateRoomLeftIn";break;case 55:s="pt-page-rotateRoomRightOut pt-page-ontop",i="pt-page-rotateRoomRightIn";break;case 56:s="pt-page-rotateRoomTopOut pt-page-ontop",i="pt-page-rotateRoomTopIn";break;case 57:s="pt-page-rotateRoomBottomOut pt-page-ontop",i="pt-page-rotateRoomBottomIn";break;case 58:s="pt-page-rotateCubeLeftOut pt-page-ontop",i="pt-page-rotateCubeLeftIn";break;case 59:s="pt-page-rotateCubeRightOut pt-page-ontop",i="pt-page-rotateCubeRightIn";break;case 60:s="pt-page-rotateCubeTopOut pt-page-ontop",i="pt-page-rotateCubeTopIn";break;case 61:s="pt-page-rotateCubeBottomOut pt-page-ontop",i="pt-page-rotateCubeBottomIn";break;case 62:s="pt-page-rotateCarouselLeftOut pt-page-ontop",i="pt-page-rotateCarouselLeftIn";break;case 63:s="pt-page-rotateCarouselRightOut pt-page-ontop",i="pt-page-rotateCarouselRightIn";break;case 64:s="pt-page-rotateCarouselTopOut pt-page-ontop",i="pt-page-rotateCarouselTopIn";break;case 65:s="pt-page-rotateCarouselBottomOut pt-page-ontop",i="pt-page-rotateCarouselBottomIn";break;case 66:s="pt-page-rotateSidesOut",i="pt-page-rotateSidesIn pt-page-delay200";break;case 67:s="pt-page-rotateSlideOut",i="pt-page-rotateSlideIn"}}var i="",s="",u=r.bzPageTransition.split(",");n.$on("$stateChangeSuccess",function(a,r,c,l,d){var p=$(".mainView");if(t.loadCounter>1){if(is.desktop()){var g=0,m=0;if(r.name===l.name)o(0),p.eq(0).addClass(i),p.eq(1).addClass(s);else{for(var h=0;h<settingJs.pageTransitionSequence.length;h++)settingJs.pageTransitionSequence[h].stateName===l.name&&(g=h),settingJs.pageTransitionSequence[h].stateName===r.name&&(m=h);p.removeClass(i+" "+s),g<m&&(o(parseInt(u[0])),p.eq(0).addClass(i),p.eq(1).addClass(s)),g>m&&(o(parseInt(u[1])),p.eq(0).addClass(i),p.eq(1).addClass(s))}}e.on("enter",p.eq(0),function(e,t){"close"===t&&n.$broadcast("bz:pageTransitionCompleted","")})}else o(0),p.eq(0).addClass(i),p.eq(1).addClass(s)})}}}function b(e){return{restrict:"A",link:function(e,t,n,a){t.timepicker()}}}function T(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,a){function r(){var e=t.val(),n=moment(e,"DD/MM/YYYY").toDate();a.$setViewValue(n)}a&&(a.$render=function(){if(a.$viewValue){var e=moment(a.$viewValue).format("DD/MM/YYYY");t.val(e||"")}},t.on("blur keyup change",function(){e.$evalAsync(r)}),r(),t.datepicker({dateFormat:"dd/mm/yy",changeMonth:!0,changeYear:!0,beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",1050)},0)},onSelect:function(t,n){e.$evalAsync(r)}}))}}}function P(e){return{restrict:"A",link:function(e,t,n,a){t.datetimepicker({dateFormat:"dd/mm/yy",timeFormat:"HH:mm:ss",changeMonth:!0,changeYear:!0,showTime:!1,beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",1050)},0)}})}}}function C(e){return{restrict:"A",require:"?ngModel",link:function(e,t,n,a){var r=t.find("#dpFrom"),o=t.find("#dpTo");console.log(r),r.datetimepicker({dateFormat:"dd/mm/yy",timeFormat:"HH:mm:ss",changeMonth:!0,changeYear:!0,beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",1050)},0)},onClose:function(e,t){},onSelect:function(e){o.datetimepicker("option","minDate",r.datetimepicker("getDate")),r.datepicker("hide")}}),o.datetimepicker({dateFormat:"dd/mm/yy",timeFormat:"HH:mm:ss",changeMonth:!0,changeYear:!0,beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",1050)},0)},onClose:function(e,t){},onSelect:function(e){r.datetimepicker("option","maxDate",o.datetimepicker("getDate")),o.datepicker("hide")}})}}}function S(e){return{restrict:"A",link:function(t,n,a){function r(){document.addEventListener("fullscreenchange",d,!1),document.addEventListener("webkitfullscreenchange",d,!1),document.addEventListener("mozfullscreenchange",d,!1),document.addEventListener("MSFullscreenChange",d,!1),p.addEventListener("webkitendfullscreen",d,!1),n.on("ended",function(e){l()})}function o(){p.play()}function i(){p.pause()}function s(){p.pause(),p.currentTime=0}function u(e){p.currentTime=e}function c(e){p.volume=e}function l(){t.$emit(e.media.ENDED)}function d(){var n=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;n?t.$emit(e.media.ENTER_FULLSCREEN):t.$emit(e.media.EXIT_FULLSCREEN)}var p=n[0];r(),t.$on(e.media.PLAY,function(){o()}),t.$on(e.media.PAUSE,function(){i()}),t.$on(e.media.STOP,function(){s()}),t.$on(e.media.SEEK,function(e,t){u(t)}),t.$on(e.media.VOLUME,function(e,t){c(t)}),t.$on(e.media.FULLSCREEN,function(e,t){console.log("request Fullscreen"),t?helperJs.enterFullScreen(p):helperJs.exitFullScreen()}),t.$on(e.media.ENTER_FULLSCREEN,function(e){console.log("enter Fullscreen")}),t.$on(e.media.EXIT_FULLSCREEN,function(e){console.log("exit Fullscreen")})}}}function w(){var e='<div class="loading-mask"><div id="bar-wave" class="bar-wave loading-style"><div class="bar"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div></div><div id="circle-spread" class="circle-spread loading-style"><div></div><div></div><div></div></div><div id="circle-line-spread" class="circle-line-spread loading-style"><div></div><div></div><div></div></div><div id="hoz-load-bar" class="hoz-load-bar loading-style"><div class="bar1"></div><div class="bar2"></div><div class="bar3"></div><div class="bar4"></div><div class="bar5"></div><div class="bar6"></div><div class="bar7"></div><div class="bar8"></div></div></div>';return{restrict:"E",templateUrl:e,replace:!0,link:function(e,t,n){t.find(n.loadingType).show()}}}function H(e){return{restrict:"A",link:function(t,n,a){function r(){$(o.selector).mCustomScrollbar(o)}var o={selector:n[0],theme:a.scrollbarTheme||"light",scrollbarPosition:a.scrollbarPosition||"inside",mouseWheel:{scrollAmount:20},scrollButtons:{enable:"true"===a.scrollbarArrow}};t.$on("bz:CustomScrollbarRender",function(){r()}),e(function(){r()},500)}}}function _(){return{restrict:"A",link:function(e,t,n){var a=n.bzRepeatCompleted.split(",");if(e.$last)for(var r=0;r<a.length;r++)e.$emit(a[r])}}}function D(e){return{restrict:"EA",replace:!0,scope:{pageParams:"=",pageState:"@"},template:'<div class="bz-pager"><a class="prev" ng-if="pageParams.page > 1" ui-sref="{{pageState}}({page: pageParams.page - 1 < 1 ? 1 : pageParams.page - 1})"><i class="fa fa-chevron-left"></i></a><a class="first" ng-if="pageParams.page > 3" ui-sref="{{pageState}}({page: 1})">1</a><a class="dot" ng-if="pageParams.page > 3">...</a><a class="num" ng-class="{active: page === pageParams.page}" ng-href="{{toHref(page)}}" ng-repeat="page in pageVisible">{{page}}</a><a class="dot" ng-if="pageParams.page < pageParams.pageCount - 2">...</a><a class="last" ng-if="pageParams.page < pageParams.pageCount - 2" ui-sref="{{pageState}}({page: pageParams.pageCount})">{{pageParams.pageCount}}</a><a class="next" ng-if="pageParams.page < pageParams.pageCount" ui-sref="{{pageState}}({page: (pageParams.page > pageParams.pageCount) ? pageParams.pageCount : (pageParams.page + 1)})"><i class="fa fa-chevron-right"></i></a></div>',link:function(t,n,a){function r(n){return e.href(t.pageState,{page:n})}function o(){t.pageVisible=[];for(var e=Math.ceil(Math.min(Math.max(1,t.pageParams.page-settingJs.pageVisibleCount/2),Math.max(1,t.pageParams.pageCount-settingJs.pageVisibleCount+1))),n=Math.ceil(Math.min(t.pageParams.pageCount,e+settingJs.pageVisibleCount-1)),a=e;a<=n;a++)t.pageVisible.push(a)}t.pageParams.page=parseInt(t.pageParams.page),t.toHref=r,o(),t.$on("bz:pageRefresh",function(e,n){t.pageParams.pageCount=n,o()})}}}function A(e){return{restrict:"A",link:function(t,n,a){is.desktop()&&(t.$on("$stateChangeSuccess",function(t,r,o,i,s){e(function(){n.find(a.bzParallax).parallax()},1e3)}),t.$on("$destroy",function(){n.find(a.bzParallax).parallax("disable")}))}}}function k(e){return{restrict:"A",link:function(t,n,a){function r(){n.find("a.fancybox").fancybox({beforeLoad:function(){e.$broadcast("bz:allowInputControls",!1)},beforeClose:function(){e.$broadcast("bz:allowInputControls",!0)}})}helperJs.isUndefinedNullEmpty(a.bzFancybox)?t.$on("bz:fancyBox",function(){r()}):"static"===a.bzFancybox&&r()}}}function z(){return{restrict:"A",scope:{bzInfinityScroll:"&",bzInfinityBottom:"@"},link:function(e,t,n){var a=$(window);e.$on("$stateChangeStart",function(e,t,n,r,o){r.name!==t.name&&a.off("scroll.infinity")}),a.on("scroll.infinity",helperJs.debounce(function(t){var n=isNaN(e.bzInfinityBottom)?$(e.bzInfinityBottom).position().top:parseInt(e.bzInfinityBottom);a.scrollTop()+a.height()>=$(document).height()-n&&e.bzInfinityScroll()},500))}}}function L(){return{restrict:"A",link:function(e,t,n){var a=jRespond([{label:"handheld",enter:0,exit:1023},{label:"desktop",enter:1024,exit:1e4}]);a.addFunc({breakpoint:"handheld",enter:function(){$("html").removeClass(n.bzFullframe)}}),a.addFunc({breakpoint:"desktop",enter:function(){$("html").addClass(n.bzFullframe)}})}}}function E(){return{require:"?ngModel",replace:!0,template:'<div class="bz-tag form-control"><ul><li ng-repeat="key in keys track by $index">{{key}}<i class="glyphicon glyphicon-remove" ng-click="remove($index)"></i></li></ul><input type="text" placeholder="Enter để thêm từ khoá" /><div class="clearfix"></div></div>',link:function(e,t,n,a){function r(t){e.keys.splice(t,1),a.$setViewValue(e.keys)}e.keys=[],e.remove=r,t.find("input").on("keypress",function(t){if(13===t.keyCode){var n=$.trim($(this).val());return e.keys.indexOf(n)===-1&&n.length>0&&(e.keys.push(n),console.log(e.keys),$(this).val(""),a.$setViewValue(e.keys)),e.$apply(),t.stopPropagation(),t.preventDefault(),!1}})}}}function F(){return{require:"ngModel",link:function(e,t,n,a){a.$parsers.push(function(e){return a.$setValidity("isdate",1==moment(e,["DD/MM/YYYY"],!0).isValid()||""==e),e})}}}function R(){return{restrict:"A",link:function(e,t,n){t.on("keypress",function(e){if("1"==n.allowDot){if(8!=e.which&&0!=e.which&&46!=e.which&&(e.which<48||e.which>57))return!1}else if(8!=e.which&&0!=e.which&&(e.which<48||e.which>57))return!1})}}}function M(e,t){return{replace:!0,templateUrl:"/assets/global/cropper/crop.html",link:function(e,n,a){function r(){console.log(123),n.find("#cropper-input-file").click()}function o(e){d.cropper("zoom",e)}function i(e){e?d.cropper("rotate",e):d.cropper("rotate",90)}function s(e){if(e)d.cropper("scale",e);else switch(p++,p){case 1:d.cropper("scale",-1,1);break;case 2:d.cropper("scale",1,-1);break;case 3:d.cropper("scale",-1,-1);break;case 4:d.cropper("scale",1,1),p=0}}function u(){d=g.cropper({aspectRatio:a.cropRatio,guides:!1}),e.loading=!1}function c(t){var n,a=window.URL||window.webkitURL;a&&(n=a.createObjectURL(t.files[0]),g.one("built.cropper",function(){a.revokeObjectURL(n)}).cropper("reset").cropper("replace",n),setTimeout(function(){e.$apply(function(){e.showButtonCrop=!0})}))}function l(){var t=d.cropper("getCroppedCanvas",{width:a.cropWidth,height:a.cropHeight}),n=t.toDataURL(a.cropMime);e.$root.$broadcast(a.cropEvent,{image:n})}var d=null,p=0,g=(n.find("#cropper-input-file"),n.find("#cropper-img"));e.showButtonCrop=!1,e.loading=!1,e.getImage=l,e.setImage=c,e.fileTrigger=r,e.zoom=o,e.rotate=i,e.scale=s,e.$on("$destroy",function(){d.cropper("destroy")}),a.cropImage?(e.loading=!0,g[0].crossOrigin="anonymous",g[0].src=a.cropImage,t(function(){e.showButtonCrop=!0,u()},1e3)):u()}}}function q(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,a){a.$parsers.push(function(e){if(void 0==e)return"";var t=e.replace(/[^0-9]/g,"");return t!==e&&(a.$setViewValue(t),a.$render()),t})}}}a.$inject=["$timeout"],r.$inject=["$timeout","$window"],o.$inject=["$timeout"],c.$inject=["$parse"],l.$inject=["$state","$timeout"],m.$inject=["$resource"],f.$inject=["$parse"],y.$inject=["$animate","bzValueSvc"],b.$inject=["$timeout"],P.$inject=["$timeout"],C.$inject=["$timeout"],S.$inject=["bzEvents"],H.$inject=["$timeout"],D.$inject=["$state"],A.$inject=["$timeout"],k.$inject=["$rootScope"],e.$inject=["$timeout","$parse"],n.$inject=["$timeout"],M.$inject=["$state","$timeout"],angular.module("bzApp").directive("bzColorPicker",a).directive("autogrow",r).directive("ckEditor",o).directive("bzInputMask",i).directive("bzLoadingProgress",s).directive("bzPlaceholder",u).directive("bzFileModel",c).directive("bzInputControls",l).directive("bzValidPasswordMatch",d).directive("bzValidPassword",h).directive("bzPasswordStrength",p).directive("bzWordCount",g).directive("bzValidExist",m).directive("bzValidFileInput",f).directive("bzSubmit",v).directive("bzPageTransition",y).directive("bzTimePicker",b).directive("bzDatePicker",T).directive("bzDateTimePicker",P).directive("bzDateRangePicker",C).directive("bzMedia",S).directive("bzLoading",w).directive("bzCustomScrollbar",H).directive("bzRepeatCompleted",_).directive("bzPager",D).directive("bzParallax",A).directive("bzFancybox",k).directive("bzInfinityScroll",z).directive("bzFullframe",L).directive("bzTag",E).directive("bzInputNumber",R).directive("bzCheckDate",F).directive("iCheck",e).directive("atrDateTimePicker",t).directive("singleDateTimePicker",n).directive("bzCropper",M).directive("bzInputOnlyDigits",q)}(),function(){angular.module("bzApp").constant("VIETNAM_MAP",[{1:{name:"Thành phố Cần Thơ",districts:{66:"Huyện Cờ Đỏ",67:"Huyện Phong Điền",68:"Huyện Thới Lai",69:"Huyện Vĩnh Thạnh",70:"Quận Bình Thủy",71:"Quận Cái Răng",72:"Quận Ninh Kiều",73:"Quận Ô Môn",74:"Quận Thốt Nốt"}},2:{name:"Thành phố Đà Nẵng",districts:{76:"Huyện Hòa Vang",77:"Huyện Hoàng Sa",78:"Quận Cẩm Lệ",79:"Quận Hải Châu",80:"Quận Liên Chiểu",81:"Quận Ngũ Hành Sơn",82:"Quận Sơn Trà",83:"Quận Thanh Khê"}},3:{name:"Thành phố Hà Nội",districts:{85:"Huyện Ba Vì",86:"Huyện Chương Mỹ",87:"Huyện Đan Phượng",88:"Huyện Đông Anh",89:"Huyện Gia Lâm",90:"Huyện Hoài Đức",91:"Huyện Mê Linh",92:"Huyện Mỹ Đức",93:"Huyện Phú Xuyên",94:"Huyện Phúc Thọ",95:"Huyện Quốc Oai",96:"Huyện Sóc Sơn",97:"Huyện Thạch Thất",98:"Huyện Thanh Oai",99:"Huyện Thanh Trì",100:"Huyện Thường Tín",101:"Huyện Từ Liêm",102:"Huyện ứng Hòa",103:"Quận Ba Đình",104:"Quận Cầu Giấy",105:"Quận Đống Đa",106:"Quận Hà Đông",107:"Quận Hai Bà Trưng",108:"Quận Hoàn Kiếm",109:"Quận Hoàng Mai",110:"Quận Long Biên",111:"Quận Tây Hồ",112:"Quận Thanh Xuân",113:"Thị xã Sơn Tây"}},4:{name:"Thành phố Hải Phòng",districts:{115:"Huyện An Dương",116:"Huyện An Lão",117:"Huyện Bạch Long Vĩ",118:"Huyện Cát Hải",119:"Huyện Kiến Thụy",120:"Huyện Thủy Nguyên",121:"Huyện Tiên Lãng",122:"Huyện Vĩnh Bảo",123:"Quận Đồ Sơn",124:"Quận Dương Kinh",125:"Quận Hải An",126:"Quận Hồng Bàng",127:"Quận Kiến An",128:"Quận Lê Chân",129:"Quận Ngô Quyền"}},5:{name:"Thành phố Hồ Chí Minh",districts:{131:"Huyện Bình Chánh",132:"Huyện Cần Giờ",133:"Huyện Củ Chi",134:"Huyện Hóc Môn",135:"Huyện Nhà Bè",136:"Quận 1",137:"Quận 10",138:"Quận 11",139:"Quận 12",140:"Quận 2",141:"Quận 3",142:"Quận 4",143:"Quận 5",144:"Quận 6",145:"Quận 7",146:"Quận 8",147:"Quận 9",148:"Quận Bình Tân",149:"Quận Bình Thạnh",150:"Quận Gò Vấp",151:"Quận Phú Nhuận",152:"Quận Tân Bình",153:"Quận Tân Phú",154:"Quận Thủ Đức"}},6:{name:"Tỉnh An Giang",districts:{155:"Huyện An Phú",156:"Huyện Châu Phú",157:"Huyện Châu Thành",158:"Huyện Chợ Mới",159:"Huyện Phú Tân",160:"Huyện Thoại Sơn",161:"Huyện Tịnh Biên",162:"Huyện Tri Tôn",163:"Thành phố Long Xuyên",164:"Thị xã Châu Đốc",165:"Thị xã Tân Châu"}},7:{name:"Tỉnh Bà Rịa-Vũng Tàu",districts:{166:"Huyện Châu Đức",167:"Huyện Côn Đảo",168:"Huyện Đất Đỏ",169:"Huyện Long Điền",170:"Huyện Tân Thành",171:"Huyện Xuyên Mộc",172:"Thành phố Vũng Tàu",173:"Thị xã Bà Rịa"}},8:{name:"Tỉnh Bắc Giang",districts:{174:"Huyện Hiệp Hòa",175:"Huyện Lạng Giang",176:"Huyện Lục Nam",177:"Huyện Lục Ngạn",178:"Huyện Sơn Động",179:"Huyện Tân Yên",180:"Huyện Việt Yên",181:"Huyện Yên Dũng",182:"Huyện Yên Thế",183:"Thành phố Bắc Giang"}},9:{name:"Tỉnh Bắc Kạn",districts:{184:"Huyện Ba Bể",185:"Huyện Bạch Thông",186:"Huyện Chợ Đồn",187:"Huyện Chợ Mới",188:"Huyện Na Rì",189:"Huyện Ngân Sơn",190:"Huyện Pác Nặm",191:"Thị xã Bắc Kạn"}},10:{name:"Tỉnh Bạc Liêu",districts:{192:"Huyện Đông Hải",193:"Huyện Giá Rai",194:"Huyện Hòa Bình",195:"Huyện Hồng Dân",196:"Huyện Phước Long",197:"Huyện Vĩnh Lợi",198:"Thành Phố Bạc Liêu"}},11:{name:"Tỉnh Bắc Ninh",districts:{199:"Huyện Gia Bình",200:"Huyện Lương Tài",201:"Huyện Quế Võ",202:"Huyện Thuận Thành",203:"Huyện Tiên Du",204:"Huyện Yên Phong",205:"Thành phố Bắc Ninh",206:"Thị xã Từ Sơn"}},12:{name:"Tỉnh Bến Tre",districts:{207:"Huyện Ba Tri",208:"Huyện Bình Đại",209:"Huyện Châu Thành",210:"Huyện Chợ Lách",211:"Huyện Giồng Trôm",212:"Huyện Mỏ Cày Bắc",213:"Huyện Mỏ Cày Nam",214:"Huyện Thạnh Phú",215:"Thành phố Bến Tre"}},13:{name:"Tỉnh Bình Định",districts:{216:"Huyện An Lão",217:"Huyện An Nhơn",218:"Huyện Hoài  Ân",219:"Huyện Hoài Nhơn",220:"Huyện Phù Mỹ",221:"Huyện Phù cát",222:"Huyện Tây Sơn",223:"Huyện Tuy Phước",224:"Huyện Vân Canh",225:"Huyện Vĩnh Thạnh",226:"Thành phố Quy Nhơn"}},14:{name:"Tỉnh Bình Dương",districts:{227:"Huyện Bến Cát",228:"Huyện Dầu Tiếng",229:"Huyện Dĩ An",230:"Huyện Phú Giáo",231:"Huyện Tân Uyên",232:"Huyện Thuận An",233:"Thị xã Thủ Dầu Một"}},15:{name:"Tỉnh Bình Phước",districts:{234:"Huyện Bù Đăng",235:"Huyện Bù Đốp",236:"Huyện Bù Gia Mập",237:"Huyện Chơn Thành",238:"Huyện Đồng Phú",239:"Huyện Hớn Quản",240:"Huyện Lộc Ninh",241:"Thị xã Bình Long",242:"Thị xã Đồng Xoài",243:"Thị xã Phước Long"}},16:{name:"Tỉnh Bình Thuận",districts:{244:"Huyện  Đức Linh",245:"Huyện Bắc Bình",246:"Huyện Hàm Tân",247:"Huyện Hàm Thuận Bắc",248:"Huyện Hàm Thuận Nam",249:"Huyện Phú Qúi",250:"Huyện Tánh Linh",251:"Huyện Tuy Phong",252:"Thành phố Phan Thiết",253:"Thị xã La Gi"}},17:{name:"Tỉnh Cà Mau",districts:{254:"Huyện Cái Nước",255:"Huyện Đầm Dơi",256:"Huyện Năm Căn",257:"Huyện Ngọc Hiển",258:"Huyện Phú Tân",259:"Huyện Thới Bình",260:"Huyện Trần Văn Thời",261:"Huyện U Minh",262:"Thành phố Cà Mau"}},18:{name:"Tỉnh Cao Bằng",districts:{263:"Huyện Bảo Lạc",264:"Huyện Bảo Lâm",265:"Huyện Hạ Lang",266:"Huyện Hà Quảng",267:"Huyện Hòa An",268:"Huyện Nguyên Bình",269:"Huyện Phục Hòa",270:"Huyện Quảng Uyên",271:"Huyện Thạch An",272:"Huyện Thông Nông",273:"Huyện Trà Lĩnh",274:"Huyện Trùng Khánh",275:"Thị xã Cao Bằng"}},19:{name:"Tỉnh Đắk Lắk",districts:{276:"Huyện Buôn Đôn",277:"Huyện Cư Kuin",278:"Huyện Cư MGar",279:"Huyện Ea Kar",280:"Huyện Ea Súp",281:"Huyện EaHLeo",282:"Huyện Krông Ana",283:"Huyện Krông Bông",284:"Huyện Krông Búk",285:"Huyện Krông Năng",286:"Huyện Krông Pắc",287:"Huyện Lắk",288:"Huyện MDrắk",289:"Thành phố Buôn Ma Thuột",290:"Thị xã Buôn Hồ"}},20:{name:"Tỉnh Đắk Nông",districts:{291:"Huyện Cư Jút",292:"Huyện Đắk GLong",293:"Huyện Đắk Mil",294:"Huyện Đắk RLấp",295:"Huyện Đắk Song",296:"Huyện KRông Nô",297:"Huyện Tuy Đức",298:"Thị xã Gia Nghĩa"}},21:{name:"Tỉnh Điện Biên",districts:{299:"Huyện Điện Biên",300:"Huyện Điện Biên Đông",301:"Huyện Mường Chà",302:"Huyện Mương Nhé",303:"Huyện Mường ảng",304:"Huyện Tủa Chùa",305:"Huyện Tuần Giáo",306:"Thành phố Điện Biên phủ",307:"Thị xã Mường Lay"}},22:{name:"Tỉnh Đồng Nai",districts:{308:"Huyện Cẩm Mỹ",309:"Huyện Định Quán",310:"Huyện Long Thành",311:"Huyện Nhơn Trạch",312:"Huyện Tân Phú",313:"Huyện Thống Nhất",314:"Huyện Trảng Bom",315:"Huyện Vĩnh Cửu",316:"Huyện Xuân Lộc",317:"Thành phố Biên Hòa",318:"Thị xã Long Khánh"}},23:{name:"Tỉnh Đồng Tháp",districts:{319:"Huyện Cao Lãnh",320:"Huyện Châu Thành",321:"Huyện Hồng Ngự",322:"Huyện Lai Vung",323:"Huyện Lấp Vò",324:"Huyện Tam Nông",325:"Huyện Tân Hồng",326:"Huyện Thanh Bình",327:"Huyện Tháp Mười",328:"Thành phố Cao Lãnh",329:"Thị xã Hồng Ngự",330:"Thị xã Sa Đéc"}},24:{name:"Tỉnh Gia Lai",districts:{331:"Huyện Chư Păh",332:"Huyện Chư Pưh",333:"Huyện Chư Sê",334:"Huyện ChưPRông",335:"Huyện Đăk Đoa",336:"Huyện Đăk Pơ",337:"Huyện Đức Cơ",338:"Huyện Ia Grai",339:"Huyện Ia Pa",340:"Huyện KBang",341:"Huyện KBang",342:"Huyện Kông Chro",343:"Huyện Krông Pa",344:"Huyện Mang Yang",345:"Huyện Phú Thiện",346:"Thành phố Plei Ku",347:"Thị xã AYun Pa",348:"Thị xã An Khê"}},25:{name:"Tỉnh Hà Giang",districts:{349:"Huyện Bắc Mê",350:"Huyện Bắc Quang",351:"Huyện Đồng Văn",352:"Huyện Hoàng Su Phì",353:"Huyện Mèo Vạc",354:"Huyện Quản Bạ",355:"Huyện Quang Bình",356:"Huyện Vị Xuyên",357:"Huyện Xín Mần",358:"Huyện Yên Minh",359:"Thành Phố Hà Giang"}},26:{name:"Tỉnh Hà Nam",districts:{360:"Huyện Bình Lục",361:"Huyện Duy Tiên",362:"Huyện Kim Bảng",363:"Huyện Lý Nhân",364:"Huyện Thanh Liêm",365:"Thành phố Phủ Lý"}},27:{name:"Tỉnh Hà Tĩnh",districts:{366:"Huyện Cẩm Xuyên",367:"Huyện Can Lộc",368:"Huyện Đức Thọ",369:"Huyện Hương Khê",370:"Huyện Hương Sơn",371:"Huyện Kỳ Anh",372:"Huyện Lộc Hà",373:"Huyện Nghi Xuân",374:"Huyện Thạch Hà",375:"Huyện Vũ Quang",376:"Thành phố Hà Tĩnh",377:"Thị xã Hồng Lĩnh"}},28:{name:"Tỉnh Hải Dương",districts:{378:"Huyện Bình Giang",379:"Huyện Cẩm Giàng",380:"Huyện Gia Lộc",381:"Huyện Kim Thành",382:"Huyện Kinh Môn",383:"Huyện Nam Sách",384:"Huyện Ninh Giang",385:"Huyện Thanh Hà",386:"Huyện Thanh Miện",387:"Huyện Tứ Kỳ",388:"Thành phố Hải Dương",389:"Thị xã Chí Linh"}},29:{name:"Tỉnh Hậu Giang",districts:{390:"Huyện Châu Thành",391:"Huyện Châu Thành A",392:"Huyện Long Mỹ",393:"Huyện Phụng Hiệp",394:"Huyện Vị Thủy",395:"Thành Phố Vị Thanh",396:"Thị xã Ngã Bảy"}},30:{name:"Tỉnh Hòa Bình",districts:{397:"Huyện Cao Phong",398:"Huyện Đà Bắc",399:"Huyện Kim Bôi",400:"Huyện Kỳ Sơn",401:"Huyện Lạc Sơn",402:"Huyện Lạc Thủy",403:"Huyện Lương Sơn",404:"Huyện Mai Châu",405:"Huyện Tân Lạc",406:"Huyện Yên Thủy",407:"Thành phố Hòa Bình"}},31:{name:"Tỉnh Hưng Yên",districts:{408:"Huyện Ân Thi",409:"Huyện Khoái Châu",410:"Huyện Kim Động",411:"Huyện Mỹ Hào",412:"Huyện Phù Cừ",413:"Huyện Tiên Lữ",414:"Huyện Văn Giang",415:"Huyện Văn Lâm",416:"Huyện Yên Mỹ",417:"Thành phố Hưng Yên"}},32:{name:"Tỉnh Khánh Hòa",districts:{418:"Huyện Cam Lâm",419:"Huyện Diên Khánh",420:"Huyện Khánh Sơn",421:"Huyện Khánh Vĩnh",422:"Huyện Ninh Hòa",423:"Huyện Trường Sa",424:"Huyện Vạn Ninh",425:"Thành phố Nha Trang",426:"Thị xã Cam Ranh"}},33:{name:"Tỉnh Kiên Giang",districts:{427:"Huyện An Biên",428:"Huyện An Minh",429:"Huyện Châu Thành",430:"Huyện Giang Thành",431:"Huyện Giồng Riềng",432:"Huyện Gò Quao",433:"Huyện Hòn Đất",434:"Huyện Kiên Hải",435:"Huyện Kiên Lương",436:"Huyện Phú Quốc",437:"Huyện Tân Hiệp",438:"Huyện U Minh Thượng",439:"Huyện Vĩnh Thuận",440:"Thành phố Rạch Giá",441:"Thị xã Hà Tiên"}},34:{name:"Tỉnh Kon Tum",districts:{442:"Huyện Đắk Glei",443:"Huyện Đắk Hà",444:"Huyện Đắk Tô",445:"Huyện Kon Plông",446:"Huyện Kon Rẫy",447:"Huyện Ngọc Hồi",448:"Huyện Sa Thầy",449:"Huyện Tu Mơ Rông",450:"Thành phố Kon Tum"}},35:{name:"Tỉnh Lai Châu",districts:{451:"Huyện Mường Tè",452:"Huyện Phong Thổ",453:"Huyện Sìn Hồ",454:"Huyện Tam Đường",455:"Huyện Tân Uyên",456:"Huyện Than Uyên",457:"Thị xã Lai Châu"}},36:{name:"Tỉnh Lâm Đồng",districts:{458:"Huyện Bảo Lâm",459:"Huyện Cát Tiên",460:"Huyện Đạ Huoai",461:"Huyện Đạ Tẻh",462:"Huyện Đam Rông",463:"Huyện Di Linh",464:"Huyện Đơn Dương",465:"Huyện Đức Trọng",466:"Huyện Lạc Dương",467:"Huyện Lâm Hà",468:"Thành phố Bảo Lộc",469:"Thành phố Đà Lạt"}},37:{name:"Tỉnh Lạng Sơn",districts:{470:"Huyện Bắc Sơn",471:"Huyện Bình Gia",472:"Huyện Cao Lộc",473:"Huyện Chi Lăng",474:"Huyện Đình Lập",475:"Huyện Hữu Lũng",476:"Huyện Lộc Bình",477:"Huyện Tràng Định",478:"Huyện Văn Lãng",479:"Huyện Văn Quan",480:"Thành phố Lạng Sơn"}},38:{name:"Tỉnh Lào Cai",districts:{481:"Huyện Bắc Hà",482:"Huyện Bảo Thắng",483:"Huyện Bảo Yên",484:"Huyện Bát Xát",485:"Huyện Mường Khương",486:"Huyện Sa Pa",487:"Huyện Si Ma Cai",488:"Huyện Văn Bàn",489:"Thành phố Lào Cai"}},39:{name:"Tỉnh Long An",districts:{490:"Huyện Bến Lức",491:"Huyện Cần Đước",492:"Huyện Cần Giuộc",493:"Huyện Châu Thành",494:"Huyện Đức Hòa",495:"Huyện Đức Huệ",496:"Huyện Mộc Hóa",497:"Huyện Tân Hưng",498:"Huyện Tân Thạnh",499:"Huyện Tân Trụ",500:"Huyện Thạnh Hóa",501:"Huyện Thủ Thừa",502:"Huyện Vĩnh Hưng",503:"Thành phố Tân An"}},40:{name:"Tỉnh Nam Định",districts:{504:"Huyện Giao Thủy",505:"Huyện Hải Hậu",506:"Huyện Mỹ Lộc",507:"Huyện Nam Trực",508:"Huyện Nghĩa Hưng",509:"Huyện Trực Ninh",510:"Huyện Vụ Bản",511:"Huyện Xuân Trường",512:"Huyện ý Yên",513:"Thành phố Nam Định"}},41:{name:"Tỉnh Nghệ An",districts:{514:"Huyện Anh Sơn",515:"Huyện Con Cuông",516:"Huyện Diễn Châu",517:"Huyện Đô Lương",518:"Huyện Hưng Nguyên",519:"Huyện Kỳ Sơn",520:"Huyện Nam Đàn",521:"Huyện Nghi Lộc",522:"Huyện Nghĩa Đàn",523:"Huyện Quế Phong",524:"Huyện Quỳ Châu",525:"Huyện Quỳ Hợp",526:"Huyện Quỳnh Lưu",527:"Huyện Tân Kỳ",528:"Huyện Thanh Chương",529:"Huyện Tương Dương",530:"Huyện Yên Thành",531:"Thành phố Vinh",532:"Thị xã Cửa Lò",533:"Thị xã Thái Hòa"}},42:{name:"Tỉnh Ninh Bình",districts:{534:"Huyện Gia Viễn",535:"Huyện Hoa Lư",536:"Huyện Kim Sơn",537:"Huyện Nho Quan",538:"Huyện Yên Khánh",539:"Huyện Yên Mô",540:"Thành phố Ninh Bình",541:"Thị xã Tam Điệp"}},43:{name:"Tỉnh Ninh Thuận",districts:{542:"Huyên Bác ái",543:"Huyện Ninh Hải",544:"Huyện Ninh Phước",545:"Huyện Ninh Sơn",546:"Huyện Thuận Bắc",547:"Huyện Thuận Nam",548:"Thành phố Phan Rang-Tháp Chàm"}},44:{name:"Tỉnh Phú Thọ",districts:{549:"Huyện Cẩm Khê",550:"Huyện Đoan Hùng",551:"Huyện Hạ Hòa",552:"Huyện Lâm Thao",553:"Huyện Phù Ninh",554:"Huyện Tam Nông",555:"Huyện Tân Sơn",556:"Huyện Thanh Ba",557:"Huyện Thanh Sơn",558:"Huyện Thanh Thủy",559:"Huyện Yên Lập",560:"Thành phố Việt Trì",561:"Thị xã Phú Thọ"}},45:{name:"Tỉnh Phú Yên",districts:{562:"Huyện Đông Hòa",563:"Huyện Đồng Xuân",564:"Huyện Phú Hòa",565:"Huyện Sơn Hòa",566:"Huyện Sông Hinh",567:"Huyện Tây Hòa",568:"Huyện Tuy An",569:"Thành phố Tuy Hòa",570:"Thị xã Sông Cầu"}},46:{name:"Tỉnh Quảng Bình",districts:{571:"Huyện Bố Trạch",572:"Huyện Lệ Thủy",573:"Huyện MinhHoá",574:"Huyện Quảng Ninh",575:"Huyện Quảng Trạch",576:"Huyện Tuyên Hoá",577:"Thành phố Đồng Hới"}},47:{name:"Tỉnh Quảng Nam",districts:{578:"Huyện Bắc Trà My",579:"Huyện Đại Lộc",580:"Huyện Điện Bàn",581:"Huyện Đông Giang",582:"Huyện Duy Xuyên",583:"Huyện Hiệp Đức",584:"Huyện Nam Giang",585:"Huyện Nam Trà My",586:"Huyện Nông Sơn",587:"Huyện Núi Thành",588:"Huyện Phú Ninh",589:"Huyện Phước Sơn",590:"Huyện Quế Sơn",591:"Huyện Tây Giang",592:"Huyện Thăng Bình",593:"Huyện Tiên Phước",594:"Thành phố Hội An",595:"Thành phố Tam Kỳ"}},48:{name:"Tỉnh Quảng Ngãi",districts:{596:"Huyện Ba Tơ",597:"Huyện Bình Sơn",598:"Huyện Đức Phổ",599:"Huyện Lý sơn",600:"Huyện Minh Long",601:"Huyện Mộ Đức",602:"Huyện Nghĩa Hành",603:"Huyện Sơn Hà",604:"Huyện Sơn Tây",605:"Huyện Sơn Tịnh",606:"Huyện Tây Trà",607:"Huyện Trà Bồng",608:"Huyện Tư Nghĩa",609:"Thành phố Quảng Ngãi"}},49:{name:"Tỉnh Quảng Ninh",districts:{610:"Huyện Ba Chẽ",611:"Huyện Bình Liêu",612:"Huyện Cô Tô",613:"Huyện Đầm Hà",614:"Huyện Đông Triều",615:"Huyện Hải Hà",616:"Huyện Hoành Bồ",617:"Huyện Tiên Yên",618:"Huyện Vân Đồn",619:"Huyện Yên Hưng",620:"Thành phố Hạ Long",621:"Thành phố Móng Cái",622:"Thị xã Cẩm Phả",623:"Thị xã Uông Bí"}},50:{name:"Tỉnh Quảng Trị",districts:{624:"Huyện Cam Lộ",625:"Huyện Cồn Cỏ",626:"Huyện Đa Krông",627:"Huyện Gio Linh",628:"Huyện Hải Lăng",629:"Huyện Hướng Hóa",630:"Huyện Triệu Phong",631:"Huyện Vính Linh",632:"Thành phố Đông Hà",633:"Thị xã Quảng Trị"}},51:{name:"Tỉnh Sóc Trăng",districts:{634:"Huyện Châu Thành",635:"Huyện Cù Lao Dung",636:"Huyện Kế Sách",637:"Huyện Long Phú",638:"Huyện Mỹ Tú",639:"Huyện Mỹ Xuyên",640:"Huyện Ngã Năm",641:"Huyện Thạnh Trị",642:"Huyện Trần Đề",643:"Huyện Vĩnh Châu",644:"Thành phố Sóc Trăng"}},52:{name:"Tỉnh Sơn La",districts:{645:"Huyện Bắc Yên",646:"Huyện Mai Sơn",647:"Huyện Mộc Châu",648:"Huyện Mường La",649:"Huyện Phù Yên",650:"Huyện Quỳnh Nhai",651:"Huyện Sông Mã",652:"Huyện Sốp Cộp",653:"Huyện Thuận Châu",654:"Huyện Yên Châu",655:"Thành phố Sơn La"}},53:{name:"Tỉnh Tây Ninh",districts:{656:"Huyện Bến Cầu",657:"Huyện Châu Thành",658:"Huyện Dương Minh Châu",659:"Huyện Gò Dầu",660:"Huyện Hòa Thành",661:"Huyện Tân Biên",662:"Huyện Tân Châu",663:"Huyện Trảng Bàng",664:"Thị xã Tây Ninh"}},54:{name:"Tỉnh Thái Bình",districts:{665:"Huyện Đông Hưng",666:"Huyện Hưng Hà",667:"Huyện Kiến Xương",668:"Huyện Quỳnh Phụ",669:"Huyện Thái Thụy",670:"Huyện Tiền Hải",671:"Huyện Vũ Thư",672:"Thành phố Thái Bình"}},55:{name:"Tỉnh Thái Nguyên",districts:{673:"Huyện Đại Từ",674:"Huyện Định Hóa",675:"Huyện Đồng Hỷ",676:"Huyện Phổ Yên",677:"Huyện Phú Bình",678:"Huyện Phú Lương",679:"Huyện Võ Nhai",680:"Thành phố Thái Nguyên",681:"Thị xã Sông Công"}},56:{name:"Tỉnh Thanh Hóa",districts:{682:"Huyện Bá Thước",683:"Huyện Cẩm Thủy",684:"Huyện Đông Sơn",685:"Huyện Hà Trung",686:"Huyện Hậu Lộc",687:"Huyện Hoằng Hóa",688:"Huyện Lang Chánh",689:"Huyện Mường Lát",690:"Huyện Nga Sơn",691:"Huyện Ngọc Lặc",692:"Huyện Như Thanh",693:"Huyện Như Xuân",694:"Huyện Nông Cống",695:"Huyện Quan Hóa",696:"Huyện Quan Sơn",697:"Huyện Quảng Xương",698:"Huyện Thạch Thành",699:"Huyện Thiệu Hóa",700:"Huyện Thọ Xuân",701:"Huyện Thường Xuân",702:"Huyện Tĩnh Gia",703:"Huyện Triệu Sơn",704:"Huyện Vĩnh Lộc",705:"Huyện Yên Định",706:"Thành phố Thanh Hóa",707:"Thị xã Bỉm Sơn",708:"Thị xã Sầm Sơn"}},57:{name:"Tỉnh Thừa Thiên Huế",districts:{709:"Huyện A Lưới",710:"Huyện Hương Trà",711:"Huyện Nam Dông",712:"Huyện Phong Điền",713:"Huyện Phú Lộc",714:"Huyện Phú Vang",715:"Huyện Quảng Điền",716:"Thành phố Huế",717:"thị xã Hương Thủy"}},58:{name:"Tỉnh Tiền Giang",districts:{718:"Huyện Cái Bè",719:"Huyện Cai Lậy",720:"Huyện Châu Thành",721:"Huyện Chợ Gạo",722:"Huyện Gò Công Đông",723:"Huyện Gò Công Tây",724:"Huyện Tân Phú Đông",725:"Huyện Tân Phước",726:"Thành phố Mỹ Tho",727:"Thị xã Gò Công"}},59:{name:"Tỉnh Trà Vinh",districts:{728:"Huyện Càng Long",729:"Huyện Cầu Kè",730:"Huyện Cầu Ngang",731:"Huyện Châu Thành",732:"Huyện Duyên Hải",733:"Huyện Tiểu Cần",734:"Huyện Trà Cú",735:"Thành phố Trà Vinh"}},60:{name:"Tỉnh Tuyên Quang",districts:{736:"Huyện Chiêm Hóa",737:"Huyện Hàm Yên",738:"Huyện Na hang",739:"Huyện Sơn Dương",740:"Huyện Yên Sơn",741:"Thành phố Tuyên Quang"}},61:{name:"Tỉnh Vĩnh Long",districts:{742:"Huyện Bình Minh",743:"Huyện Bình Tân",744:"Huyện Long Hồ",745:"Huyện Mang Thít",746:"Huyện Tam Bình",747:"Huyện Trà Ôn",748:"Huyện Vũng Liêm",749:"Thành phố Vĩnh Long"}},62:{name:"Tỉnh Vĩnh Phúc",districts:{750:"Huyện Bình Xuyên",751:"Huyện Lập Thạch",752:"Huyện Sông Lô",753:"Huyện Tam Đảo",754:"Huyện Tam Dương",755:"Huyện Vĩnh Tường",756:"Huyện Yên Lạc",757:"Thành phố Vĩnh Yên",758:"Thị xã Phúc Yên"}},63:{name:"Tỉnh Yên Bái",districts:{759:"Huyện Lục Yên",760:"Huyện Mù Cang Chải",761:"Huyện Trạm Tấu",762:"Huyện Trấn Yên",763:"Huyện Văn Chấn",764:"Huyện Văn Yên",765:"Huyện Yên Bình",766:"Thành phố Yên Bái",767:"Thị xã Nghĩa Lộ"}}}])}(),function(){function e(){}Application.registerModule("bzVocabulary"),angular.module("bzVocabulary",[]).run(e)}(),function(){function e(e,t){t.theme="bs3"}e.$inject=["authSvc","editableOptions"],Application.registerModule("bzUser"),angular.module("bzUser",["xeditable"]).run(e)}(),function(){function e(){}Application.registerModule("bzUnit"),angular.module("bzUnit",[]).run(e)}(),function(){function e(){}Application.registerModule("bzTest"),angular.module("bzTest",[]).run(e)}(),function(){function e(e){e.theme="bs3"}e.$inject=["editableOptions"],Application.registerModule("bzTag"),angular.module("bzTag",["xeditable"]).run(e)}(),function(){function e(){}Application.registerModule("bzSupplier"),angular.module("bzSupplier",[]).run(e)}(),function(){function e(){}Application.registerModule("bzShippingFee"),angular.module("bzShippingFee",[]).run(e)}(),function(){function e(){}Application.registerModule("bzSearch"),angular.module("bzSearch",[]).run(e)}(),function(){function e(){}Application.registerModule("bzPromotion"),angular.module("bzPromotion",[]).run(e)}(),function(){function e(){}Application.registerModule("bzProduct"),
angular.module("bzProduct",[]).run(e)}(),function(){function e(){}Application.registerModule("bzOrder"),angular.module("bzOrder",[]).run(e)}(),function(){function e(){}Application.registerModule("bzAuditLog"),angular.module("bzAuditLog",[]).run(e)}(),function(){function e(e){}e.$inject=["authSvc"],Application.registerModule("bzDashboard"),angular.module("bzDashboard",[]).run(e)}(),function(){function e(){}Application.registerModule("bzCoupon"),angular.module("bzCoupon",[]).run(e)}(),function(){function e(){}Application.registerModule("bzConfig"),angular.module("bzConfig",[]).run(e)}(),function(){function e(){}Application.registerModule("bzCertificate"),angular.module("bzCertificate",[]).run(e)}(),function(){function e(){}Application.registerModule("bzCategory"),angular.module("bzCategory",["angular-speakingurl"]).run(e)}(),function(){function e(){}Application.registerModule("bzBlog"),angular.module("bzBlog",[]).constant("CKEditorOptBlog",{imageUploadUrl:settings.services.uploadApi+"/upload/for-ckeditor/image-upload?type=blog_image&prefix=blog_image",filebrowserUploadUrl:settings.services.uploadApi+"/upload/for-ckeditor/file-browser-upload?type=blog_image&prefix=blog_image",removePlugins:"about,bidi,flash,horizontalrule,language,save,specialchar"}).run(e)}(),function(){function e(e){}e.$inject=["authSvc"],Application.registerModule("bzAuth"),angular.module("bzAuth",[]).run(e)}(),function(){function e(){}Application.registerModule("bzPermission"),angular.module("bzPermission",["angular-speakingurl"]).run(e)}(),function(){Application.registerModule("bzVocabulary"),angular.module("bzVocabulary",[]).constant("listTypesWord",[{name:"Danh từ",value:"noun"},{name:"Đông từ",value:"verb"},{name:"Tính từ",value:"adjective"},{name:"Trạng tư",value:"adverb"},{name:"Đại từ nhân xưng",value:"pronoun"}])}(),function(){angular.module("bzUser").constant("userRoles",[{name:"Super Admin",value:"super-admin"},{name:"Admin",value:"admin"},{name:"Học viên",value:"student"}])}(),function(){Application.registerModule("bzUnit"),angular.module("bzUnit",[]).constant("listClasses",[{name:"Lớp 1",value:"1"},{name:"Lớp 2",value:"2"},{name:"Lớp 3",value:"3"},{name:"Lớp 4",value:"4"},{name:"Lớp 5",value:"5"},{name:"Lớp 6",value:"6"},{name:"Lớp 7",value:"7"},{name:"Lớp 8",value:"8"},{name:"Lớp 9",value:"9"},{name:"Lớp 10",value:"10"},{name:"Lớp 11",value:"11"},{name:"Lớp 12",value:"12"},{name:"Khác",value:"khac"}])}(),function(){Application.registerModule("bzProduct"),angular.module("bzProduct",[]).constant("CKEditorOptPro",{imageUploadUrl:settings.services.uploadApi+"/upload/for-ckeditor/image-upload?type=product_image&prefix=product_image",filebrowserUploadUrl:settings.services.uploadApi+"/upload/for-ckeditor/file-browser-upload?type=product_image&prefix=product_image",removePlugins:"about,bidi,blockquote,div,flash,horizontalrule,language,pagebreak,save,smiley,sourcearea,specialchar"}).constant("statusProduct",[{value:"HH",name:"Hết hàng"},{value:"HSV",name:"Hàng sắp về"},{value:"CH",name:"Còn hàng"}])}(),function(){Application.registerModule("bzOrder"),angular.module("bzOrder",[]).constant("statusOrderList",[{value:"PROCCESS",name:"Đang xử lý",group:"",bgColor:"#6d90f5"},{value:"FINISH",name:"Hoàn thành",group:"",bgColor:"#0dd077"},{value:"CANCEL",name:"Đã hủy",group:"",bgColor:"#ed7a7c"}]).constant("shipperList",[{value:"SPT",name:"SPT",group:""},{value:"AHM",name:"Ahamove",group:""},{value:"GHN",name:"GHN",group:""},{value:"MHV",name:"Mua Hàng Việt",group:""}]).constant("listVocative",[{name:"Anh",value:"Anh"},{name:"Chị",value:"Chị"},{name:"Cô",value:"Cô"},{name:"Chú",value:"Chú"},{name:"Bác",value:"Bác"},{name:"Ông",value:"Ông"},{name:"Bà",value:"Bà"}])}(),function(){Application.registerModule("bzPermisstion"),angular.module("bzPermisstion",[]).constant("listResource",["dashboard","blog","product","user","promotion","order","unit","supplier","category","shipping","tag","coupon","config","certificate","import_product","search","acl","log"]).constant("listAction",[{name:"Xem",value:"view"},{name:"Thêm",value:"add"},{name:"Sửa",value:"edit"},{name:"Xoá",value:"delete"},{name:"Trích xuất",value:"export"}])}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e,t){var n=new a(e);return n.$save({method:"vocabulary"})}function o(e,t){var n=new a(e);return n.$update({method:"vocabulary",id:t})}function i(e){var t=new a(e);return t.$get({method:"vocabulary"})}function s(e){var t=new a;return t.$get({method:"vocabulary",id:e})}function u(e){var t=new a;return t.$get({method:"unit-by-class",id:e})}return{create:r,update:o,getAll:i,get:s,getUnits:u}}t.$inject=["$q","$window","bzResourceSvc","vocabularyFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzVocabulary").service("vocabularySvc",t).factory("vocabularyFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e,t){var n=new a(e);return n.$save({method:"user"})}function o(e,t){var n=new a(e);return n.$update({method:"user",id:t})}function i(){var e=new a;return e.$get({method:"roles"})}return{create:r,update:o,getRoles:i}}t.$inject=["$q","$window","bzResourceSvc","userFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzUser").service("userSvc",t).factory("userFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e,t){var n=new a(e);return n.$save({method:"unit"})}function o(e,t){var n=new a(e);return n.$update({method:"unit",id:t})}function i(e){var t=new a(e);return t.$get({method:"unit"})}function s(e){var t=new a;return t.$get({method:"unit",id:e})}return{create:r,update:o,getAll:i,get:s}}t.$inject=["$q","$window","bzResourceSvc","unitFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzUnit").service("unitSvc",t).factory("unitFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){return t.api(e.settings.services.apiUrl+"/:method/:id",{method:"@method",id:"@id"})}function n(e,t,n,a,r){function o(e){var t=new a(e);return t.$save({method:"resize-img"})}function i(e){var t=new r(e);return t.$save({method:"upload",id:"base64"})}return{resize:o,uploadBase64:i}}n.$inject=["$q","$window","bzResourceSvc","testFac","testApiFac"],e.$inject=["$window","bzResourceSvc"],t.$inject=["$window","bzResourceSvc"],angular.module("bzTest").service("testSvc",n).factory("testFac",e).factory("testApiFac",t)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id/:type",{method:"@method",id:"@id",type:"@type"})}function t(e,t){function n(){var e=new t;return e.$get({method:"tag"})}function a(e){var n=new t;return n.$get({method:"tag",id:e,type:""})}function r(e){var n=new t(e);return console.log("gnsdkn sdnsd g"),n.$save({method:"tag",type:""})}function o(e,n){var a=new t(e);return a.$update({method:"tag",id:n,type:""})}function i(e){var n=new t;return n.$get({method:"product",id:e})}function s(e,n){var a=new t;return a.$get({method:"listProduct",id:e,type:n})}function u(e,n){var a=new t;return a.$get({method:"tagProduct",id:e,type:n})}return{getAll:n,get:a,create:r,update:o,getProductById:i,getListProduct:s,getProductByTag:u}}e.$inject=["bzResourceSvc"],t.$inject=["$q","tagFac"],angular.module("bzTag").factory("tagFac",e).service("tagSvc",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e,t){var n=new a(e);return n.$save({method:"supplier"})}function o(e,t){var n=new a(e);return n.$update({method:"supplier",id:t})}function i(e){var t=new a(e);return t.$get({method:"supplier"})}function s(e){var t=new a;return t.$get({method:"supplier",id:e})}return{create:r,update:o,getAll:i,get:s}}t.$inject=["$q","$window","bzResourceSvc","supplierFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzSupplier").service("supplierSvc",t).factory("supplierFac",e)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){function n(){var e=new t;return e.$get({method:"shippingfee"})}function a(){var e=new t;return e.$get({method:"all-shippingfee"})}function r(){var e=new t;return e.$get({method:"all-shippingfee-config"})}function a(){var e=new t;return e.$get({method:"all-shippingfee"})}function o(e){var n=new t;return n.$get({method:"shippingfee",id:e})}function i(e){var n=new t(e);return n.$save({method:"shippingfee"})}function s(e,n){var a=new t(e);return a.$update({method:"shippingfee",id:n})}return{getAll:n,getShippingFeeDefault:r,getAllNoPaging:a,get:o,create:i,update:s}}e.$inject=["bzResourceSvc"],t.$inject=["$q","shippingfeeFac"],angular.module("bzShippingFee").factory("shippingfeeFac",e).service("shippingfeeSvc",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e){e.method="search";var t=new a;return t.$get(e)}function o(e){var t=new a(e);return t.$save({method:"search"})}function i(e){var t=new a;return t.$get({method:"search",id:e})}function s(e,t){var n=new a(e);return n.$save({method:"search",id:t})}function u(e){var t=new a;return t.$delete({method:"search",id:e})}function c(e){var t=new a;return t.$get({method:"search-active",id:e})}return{getAll:r,create:o,active:c,edit:i,update:s,del:u}}t.$inject=["$q","$window","bzResourceSvc","searchFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzSearch").service("searchSvc",t).service("searchFac",e)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){function n(e){e.method="promotion";var n=new t;return n.$get(e)}function a(e){var n=new t(e);return n.$get({method:"promotion-add"})}function r(e){var n=new t(e);return n.$save({method:"promotion"})}function o(e){var n=new t;return n.$get({method:"promotion",id:e})}function i(e,n){var a=new t(e);return a.$save({method:"promotion",id:n})}function s(e){var n=new t;return n.$delete({method:"promotion",id:e})}return{getAll:n,add:a,create:r,edit:o,update:i,"delete":s}}e.$inject=["bzResourceSvc"],t.$inject=["$q","promotionFac"],angular.module("bzPromotion").factory("promotionFac",e).service("promotionSvc",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){return t.api(e.settings.services.apiUrl+"/:method/:id",{method:"@method",id:"@id"})}function n(e,t,n,a,r){function o(e){e.method="product";var t=new a;return t.$get(e)}function i(e){var t=new a;return t.$get({method:"product",id:e})}function s(e){var t=new a(e);return t.$get({method:"product-add"})}function u(e){var t=new a(e);return t.$save({method:"product"})}function c(e,t){var n=new a(e);return n.$save({method:"product",id:t})}function l(e){var t=new a;return t.$delete({method:"product",id:e})}function d(e){var t=new a;return t.$save({method:"product-active",id:e})}function p(e){var t=new a;return t.$get({method:"product-edit",id:e})}function g(e){var t=new a;return t.$get({method:"product-edit",id:e})}function m(e){var t=new a(e);return t.$save({method:"product-tag"})}function h(e){var t=new r(e);return t.$save({method:"upload",id:"base64"})}function f(e){return e.indexOf("watch?v=")!=-1&&(e=e.replace("watch?v=","embed/")),e.indexOf("&")!=-1&&(e=e.split("&")[0]),e}function v(e){var t=e.split("."),n=t[0].split("_");n.pop();var a=n.join("_")+"."+t[1];return a}function y(e){var t=e.split(".");return t[0]+"_248x248."+t[1]}function b(e){var t=new a(e);return t.$save({method:"test-resize"})}function T(e){if(e){var t=e.toLowerCase();return t=t.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a"),t=t.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),t=t.replace(/i|í|ì|ỉ|ĩ|ị/gi,"i"),t=t.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),t=t.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),t=t.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),t=t.replace(/đ/gi,"d"),t=t.replace(/\`|\~|\!|\@|\#|\||\$|\%|\^|\&|\*|\(|\)|\+|\=|\,|\.|\/|\?|\>|\<|\'|\"|\:|\;|_/gi,""),t=t.replace(/ /gi,"-"),t=t.replace(/\-\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-/gi,"-"),t=t.replace(/\-\-/gi,"-"),t="@"+t+"@",t=t.replace(/\@\-|\-\@|\@/gi,"")}return e}function P(e,t){if(t){var n=t.split("/");if(n.length>1){var a=settingJs.configs.uploadDirectory.media_old_product.slice(0,-1);return a+t}}return e+t}function $(e){var t=new RegExp('{{media url="',"g"),n=new RegExp('"}}',"g"),a=new RegExp("//mhv-live.bizzon.com.vn","g");return e.replace(t,settings.services.webUrl+settingJs.configs.uploadDirectory.media_old).replace(n,"").replace(a,settings.services.webUrl)}return{getAll:o,get:i,add:s,create:u,updateProduct:c,deleteProduct:l,activeProduct:d,getProductBySlug:p,updateTag:m,getProductByID:g,formatYoutube:f,uploadBase64:h,thumbToImage:v,imageToThumb:y,testResize:b,changeToSlug:T,checkImgOld:P,fixImgProductDetail:$}}n.$inject=["$q","$window","bzResourceSvc","productFac","apiFac"],e.$inject=["$window","bzResourceSvc"],t.$inject=["$window","bzResourceSvc"],angular.module("bzProduct").service("productSvc",n).service("productFac",e).service("apiFac",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e){e.method="order";var t=new a;return t.$get(e)}function o(){var e=new a;return e.$get({method:"order-add"})}function i(e){var e=new a(e);return e.$save({method:"order"})}function s(e){var t=new a;return t.$get({method:"order",id:e})}function u(e,t){var n=new a(e);return n.$save({method:"order",id:t})}function c(e){var t=new a;return t.$delete({method:"order",id:e})}function l(e){return e.toFixed().replace(/./g,function(e,t,n){return t>0&&"."!==e&&(n.length-t)%3===0?"."+e:e})}function d(e,t){var n=new a(e);return n.$save({method:"check-coupon",id:t})}function p(e){var t=new a;return t.$get({method:"is-first-order",id:e})}return{getAll:r,add:o,create:i,edit:s,update:u,"delete":c,checkCoupon:d,formatCurrency:l,isFirstOrder:p}}t.$inject=["$q","$window","bzResourceSvc","orderFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzOrder").service("orderSvc",t).service("orderFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e){e.method="log";var t=new a;return t.$get(e)}return{getLog:r}}t.$inject=["$q","$window","bzResourceSvc","auditLogFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzAuditLog").service("auditLogSvc",t).factory("auditLogFac",e)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){function n(){var e=new t;return e.$get({method:"coupon"})}function a(e){var n=new t;return n.$get({method:"coupon",id:e})}function r(e){var n=new t(e);return n.$save({method:"coupon"})}function o(e,n){var a=new t(e);return a.$update({method:"coupon",id:n})}function i(e){var n=new t;return n.$get({method:"coupon-code",id:e})}return{getAll:n,get:a,create:r,update:o,getByCode:i}}e.$inject=["bzResourceSvc"],t.$inject=["$q","couponFac"],angular.module("bzCoupon").factory("couponFac",e).service("couponSvc",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e,t){var n=new a(e);return n.$save({method:"config"})}function o(e,t){var n=new a(e);return n.$update({method:"config",id:t})}function i(e){var t=new a(e);return t.$get({method:"config"})}function s(e){var t=new a;return t.$get({method:"config",id:e})}return{create:r,update:o,getAll:i,get:s}}t.$inject=["$q","$window","bzResourceSvc","configFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzSupplier").service("configSvc",t).factory("configFac",e)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){function n(){var e=new t;return e.$get({method:"certificate"})}function a(e){var n=new t;return n.$get({method:"certificate",id:e})}function r(e){var n=new t(e);return n.$save({method:"certificate"})}function o(e,n){var a=new t(e);return a.$update({method:"certificate",id:n})}function i(e,n){var a=new t(e);return a.$get({method:"certificate-product",id:n})}return{getAll:n,get:a,create:r,update:o,getProductsByCerID:i}}e.$inject=["bzResourceSvc"],t.$inject=["$q","certificateFac"],angular.module("bzCertificate").factory("certificateFac",e).service("certificateSvc",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e,t){var n=new a(e);return n.$save({method:"category"})}function o(e,t){var n=new a(e);return n.$update({method:"category",id:t})}function i(e){var t=new a(e);return t.$get({method:"category"})}function s(e){var t=new a;return t.$get({method:"category",id:e})}function u(e){var t=new a;return t.$get({method:"category_id",id:e})}function c(e,t){var n=new a(e);return n.$get({method:"category_child",id:t})}return{create:r,update:o,getAll:i,get:s,getChild:c,getById:u}}t.$inject=["$q","$window","bzResourceSvc","categoryFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzCategory").service("categorySvc",t).factory("categoryFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,a){function r(e){var t=new a(e);return t.$save({method:"blog"})}function o(e,t){var n=new a(e);return n.$update({method:"blog",id:t})}function i(e){var t=new a(e);return t.$get({method:"blog"})}function s(e){var t=new a;return t.$get({method:"blog",id:e})}function u(){var e=new a;return e.$get({method:"blog-tag"})}return{create:r,update:o,getAll:i,get:s,getTagsBlog:u}}t.$inject=["$q","$window","bzResourceSvc","blogFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzBlog").service("blogSvc",t).factory("blogFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:param1/:param2",{method:"@method",param1:"@param1",param2:"@param2"})}function t(e,t,n,a){function r(e,t){var n=new a(e);return n.$save({method:"permission"})}function o(){var e=new a;return e.$get({method:"permission"})}function i(e){var t=new a;return t.$remove({method:"delete-role",param1:e})}function s(e,t){var n=new a;return n.$remove({method:"delete-resource",param1:e,param2:t})}function u(e,t,n){var r=new a(e);return r.$update({method:"permission",param1:t,param2:n})}function c(e){var t=new a;return t.$get({method:"resources",param1:e})}function l(e,t){var n=new a(e);return n.$update({method:"add-resource",param1:t})}return{create:r,get:o,update:u,getResoureRole:c,addResource:l,removeRole:i,removeResource:s}}t.$inject=["$q","$window","bzResourceSvc","permissionFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzPermisstion").service("permissionSvc",t).service("permissionFac",e)}(),function(){function e(e,t,n,a,r,o){function i(){u.submitted=!1,u.lockForm=!1,u.formData={currentPassword:"",newPassword:"",confirmNewPassword:""}}function s(e){u.submitted=!0,!u.lockForm&&e&&(u.lockForm=!0,o.postChangePass(u.formData).then(function(e){a.toastr({type:"success",data:{title:"Thành công",message:"Đổi mật khẩu thành công"}}),n.reload(),r.close(),u.lockForm=!1,o.siteLogout()})["catch"](function(e){a.toastr({type:"error",data:{title:"Lỗi",message:e.data.message}}),n.reload(),r.close(),u.lockForm=!1}))}var u=this;u.queryParams={},u.userCurent=o.getProfile(),u.submit=s,i()}e.$inject=["$scope","$rootScope","$state","$bzPopup","$uibModalInstance","authSvc"],angular.module("bzUser").controller("popChangePassCtrl",e)}();var popupOrderCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g,m,h,f,v,y,b){function T(n){e.orderDetail.total_pay=e.orderDetail.total+e.orderDetail.payment_info.info.shipping_fee-e.orderDetail.coupon.value-("CHIEU"==e.orderDetail.delivery_time?"PC"==t.promotionForOrderDeleveryOnAffternoon.type?t.promotionForOrderDeleveryOnAffternoon.value/100*e.orderDetail.total:t.promotionForOrderDeleveryOnAffternoon.value:0)-(e.isFirstOder?"MN"==t.promotionForFirstOrder.type?t.promotionForFirstOrder.value:t.promotionForFirstOrder.value/100*e.orderDetail.total:0),g.update({order:e.orderDetail},e.orderDetail._id).then(function(t){o.toastr({type:"success",data:{title:"Thành công!",message:"Cập nhật đơn hàng thành công!"}}),s.close(e.orderDetail)})["catch"](function(e){n.$submitted=!1,o.toastr({type:"error",data:{title:"Lỗi!",message:resp.err.message}})})}function P(){"CT"==e.orderDetail.delivery_type?e.orderDetail.payment_info.info.shipping_fee=0:e.orderDetail.payment_info.info.shipping_fee=m.shipping_fee.fee}function $(){e.orderDetail.payment_info.info.user_id&&(p.api(n.settings.services.admin+"/order/"+e.orderDetail.payment_info.info.user_id._id+"-"+e.orderDetail._id).get({},function(t){!e.orderDetail.old_id&&t.success&&(e.isFirstOder=t.success)}),function(e){console.log("checkFirstOrder",e)})}c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("order",["add","edit"])||a.go("error403"),e.updateOrderDetail=T,e.checkImgOld=y.checkImgOld,e.onChangeDeliveryType=P,e.statusOrder=h,e.shipperList=f,e.urlImg=settingJs.configs.uploadDirectory.thumb_product,e.orderDetail=m,e.isFirstOder=!1,$(),e.editUserShipping=function(){a.go("user-shipping",{id:e.orderDetail.payment_info.info.user_id._id}),s.close(e.orderDetail.payment_info.info.id_shipping_address)}}e.$inject=["$scope","$rootScope","$window","$state","$stateParams","$bzPopup","$uibModal","$uibModalInstance","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","orderSvc","order","statusOrderList","shipperList","permission","productSvc","shippingfeeSvc"],angular.module("bzOrder").controller("popupOrderCtrl",e)}(),popupLogCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){e.log=p,e.log.object=JSON.parse(e.log.object)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","$uibModalInstance","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","detailLog"],angular.module("bzAuditLog").controller("popupLogCtrl",e)}(),popupGenaratorCodeCtrl=function(){function e(e,t,n,a,r){function o(t){if(e.submitted=!0,t.$valid&&e.data.code.split("*").length-1>=3&&e.data.code.indexOf("*")!=-1){var n=e.data.code.split("*"),r="",o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=function s(){if(r.split(",").length>e.data.qty)return r=r.substring(0,r.length-1);var t="",a=0;for(a=0;a<=n.length-1;a++)t=t+n[a]+o[Math.round(Math.random()*(o.length-1))];t=t.substring(0,t.length-1),r.indexOf(t)==-1&&(r+=t,r+=","),s()};i(),a.close(r)}}function i(){var t=e.data.code.split("*");t.forEach(function(e,n){t[n]=s(e).toUpperCase()}),e.data.code=t.join("*")}function s(e){if(e){var t=e.toLowerCase();return t=t.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a"),t=t.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),t=t.replace(/i|í|ì|ỉ|ĩ|ị/gi,"i"),t=t.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),t=t.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),t=t.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),t=t.replace(/đ/gi,"d"),t=t.replace(/\`|\~|\!|\@|\#|\||\$|\%|\^|\&|\*|\(|\)|\+|\=|\,|\.|\/|\?|\>|\<|\'|\"|\:|\;/gi,""),t=t.replace(/ /gi,"-"),t=t.replace(/\-\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-/gi,"-"),t=t.replace(/\-\-/gi,"-")}return e}r.isSuperAdmin()||r.isAdmin()&&r.hasPermission("coupon",["add","edit"])||t.go("error403"),e.genaratorCode=o,e.onTypeCode=i,e.data={code:"",qty:2},e.submitted=!1}e.$inject=["$scope","$state","$uibModal","$uibModalInstance","authSvc"],angular.module("bzCoupon").controller("popupGenaratorCodeCtrl",e)}(),vocabularysCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){d.getAll().then(function(e){console.log(111,e),v.queryParams.pageCount=e.totalPage,v.listVocabulary=e.items,v.table=new u({count:20},{counts:[],getData:function(t){return t.total(e.totalItems),v.listVocabulary}}),v.table.page(v.queryParams.page),v.loading=!1})["catch"](function(e){console.log("Can not get data: ",e)})}function m(e){n.go(".",{"class":""!=v.queryParams["class"]?v.queryParams["class"]:null,keyword:e,page:1}).then(function(){n.reload()})}function h(){n.go(".",{keyword:null,"class":null},{notify:!1}).then(function(){n.reload()})}function f(e){var a={ids:[e]};o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/vocabulary/:id",{id:"@id"})["delete"]({id:a.ids},function(e){r.toastr({type:"success",data:{title:"Xóa",message:"Xóa từ vựng thành công!"}}),n.reload(),o.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("vocabulary",["view"])||n.go("error403"),v.loading=!0,v.selectedItems=[],v.queryParams=a,v.listClasses=p,v.userRoles=i,v.vocabularys=[],v.imagesDirectory=settingJs.configs.uploadDirectory.vocabulary,v.filter=m,v.filterReset=h,v.remove=f,g(),c.onPagesChanged(function(){e.vmVocabularys.queryParams.page=v.table.page(),n.go(".",e.vmVocabularys.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","vocabularySvc","listClasses"],angular.module("bzVocabulary").controller("vocabularysCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),vocabularyEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g,m,h){function f(){p.get(a.id).then(function(e){$.formData=e})["catch"](function(e){r.toastr({type:"error",data:{title:"từ vựng",message:"Xảy ra lỗi. Thử lại sau"}})})}function v(){p.getUnits($.classes).then(function(e){e.success&&($.listUnit=e.data),0==$.listUnit.length&&r.toastr({type:"error",data:{title:"Danh sách bài học",message:"Chưa có bài học. Hãy thêm bài học cho lớp"}})})["catch"](function(e){$.listUnit=[],r.toastr({type:"error",data:{title:"Danh sách bài học",message:"Xảy ra lỗi. Hãy thêm bài học trước"}})})}function y(e){$.formData.images.splice(e,1)}function b(n){if($.formData.images.length>=3)return alert("Không thể thêm! Số ảnh tối đa là 5!"),!1;if(n.length>0&&$.formData.images.length<3){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");l.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"vocabulary_image",prefix:"vocabulary_image"}}).then(function(t){$.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}}),$.cropImage($.formData.images.length-1,vmBlogAdd.formData.images[vmBlogAdd.formData.images.length-1].url)},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}function T(e){$.submitted=!0,$.lockForm=!0,e?p.update($.formData,a.id).then(function(e){r.toastr({type:"success",data:{title:"Từ vựng",message:"Cập nhật thành công"}}),n.go("vocabularys")})["catch"](function(e){r.toastr({type:"error",data:{title:"Cập nhật từ vựng",message:e.data.message}})}):$.submitted=!0}function P(e,t){o.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,a){n.popupScope={image:$.imagesDirectory+t,event:"crop:image",ratio:1,width:100,height:100},n.$on("crop:image",function(n,o){h.uploadBase64({directory:"vocabulary_image",image:o.image}).then(function(n){$.listImgDelete.push({url:$.imagesDirectory,fileName:t}),$.formData.images[e].url=n.name,r.toastr({type:"success",data:{title:"Thành công!",message:"Crop ảnh thành công"}}),a.close()})["catch"](function(e){console.log("er",e)})})}]})}var $=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("vocabulary",["add"])||n.go("error403"),$.classes="4",$.lockFOrm=!1,$.save=T,$.submitted=!1,$.listClasses=g,$.listTypesWord=m,$.imagesDirectory=settingJs.configs.uploadDirectory.vocabulary,$.listImgDelete=[],$.getUnits=v,$.uploadImage=b,$.removeImage=y,$.cropImage=P,f()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","Upload","bzResourceSvc","vocabularySvc","listClasses","listTypesWord","bzUpload"],angular.module("bzVocabulary").controller("vocabularyEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),vocabularyAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g,m,h){function f(){p.getUnits(P.classes).then(function(e){e.success&&(P.listUnit=e.data),0==P.listUnit.length&&r.toastr({type:"error",data:{title:"Danh sách bài học",message:"Chưa có bài học. Hãy thêm bài học cho lớp"}})})["catch"](function(e){P.listUnit=[],r.toastr({type:"error",data:{title:"Danh sách bài học",message:"Xảy ra lỗi. Hãy thêm bài học trước"}})})}function v(e){P.formData.images.splice(e,1)}function y(n){if(P.formData.images.length>=3)return alert("Không thể thêm! Số ảnh tối đa là 5!"),!1;if(n.length>0&&P.formData.images.length<3){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");l.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"vocabulary_image",prefix:"vocabulary_image"}}).then(function(t){P.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}}),P.cropImage(P.formData.images.length-1,vmBlogAdd.formData.images[vmBlogAdd.formData.images.length-1].url)},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}function b(e){P.submitted=!0,P.lockForm=!0,e?p.create(P.formData).then(function(e){r.toastr({type:"success",data:{title:"Từ vựng",message:"Thêm thành công"}}),n.go("vocabularys")})["catch"](function(e){r.toastr({type:"error",data:{title:"Thêm từ vựng",message:e.data.message}})}):P.submitted=!0}function T(e,t){o.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,a){n.popupScope={image:P.imagesDirectory+t,event:"crop:image",ratio:1,width:100,height:100},n.$on("crop:image",function(n,o){h.uploadBase64({directory:"vocabulary_image",image:o.image}).then(function(n){P.listImgDelete.push({url:P.imagesDirectory,fileName:t}),P.formData.images[e].url=n.name,r.toastr({type:"success",data:{title:"Thành công!",message:"Crop ảnh thành công"}}),a.close()})["catch"](function(e){console.log("er",e)})})}]})}var P=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("vocabulary",["add"])||n.go("error403"),P.classes="4",P.formData={status:!0,lang:"en",classes:"noun",images:[]},P.lockFOrm=!1,P.save=b,P.submitted=!1,P.listClasses=g,P.listTypesWord=m,P.imagesDirectory=settingJs.configs.uploadDirectory.vocabulary,P.listImgDelete=[],P.getUnits=f,P.uploadImage=y,P.removeImage=v,P.cropImage=T,f()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","Upload","bzResourceSvc","vocabularySvc","listClasses","listTypesWord","bzUpload"],angular.module("bzVocabulary").controller("vocabularyAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),userShippingCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){l.api(t.settings.services.admin+"/all-shippingfee").get(function(e){T.districts=e.items})}function m(){l.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:T.userId},function(e){T.user=e})}function h(e){delete T.user.__v,delete T.user.password_token,delete T.user.created,delete T.user.provider,
delete T.user.activeToken,T.user.cfpassword=T.user.password,T.user.dob||(T.user.dob=""),d.update(T.user,T.userId).then(function(e){r.toastr({type:"success",data:{title:"Địa chỉ giao hàng",message:"Cập nhật thành công"}}),n.reload()})["catch"](function(e){r.toastr({type:"error",data:{title:"Địa chỉ giao hàng",message:e.data.message}}),userEdit.lockForm=!1})}function f(e){if(""==e||null==e)return"Dữ liệu không được để trống"}function v(e){if(T.user.dob||(T.user.dob=""),T.submitted=!0,T.lockForm=!0,e){var a={name:T.formData.txtName,phone:T.formData.phone,address_detail:T.formData.address,id_shipping_fee:T.formData.district};l.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:T.userId},function(e){delete e.__v,delete e.password_token,delete e.created,delete e.provider,delete e.activeToken;var t=e;t.dob||(t.dob=""),t.cfpassword=t.password,t.customer.shipping_address.push(a),d.update(t,T.userId).then(function(e){r.toastr({type:"success",data:{title:"Địa chỉ",message:"Thêm thành công"}}),n.reload()})["catch"](function(e){r.toastr({type:"error",data:{title:"Địa chỉ",message:e.data.message}}),userEdit.lockForm=!1})})}}function y(e){T.user.dob||(T.user.dob="");o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(t,a){t.popTitle="Xóa",t.message="Bạn chắc chắn sẽ xóa dữ liệu này?",t.ok=function(){var t=T.user;delete t.__v,delete t.password_token,delete t.created,delete t.provider,delete t.activeToken,t.cfpassword=t.password;var o=t.customer.shipping_address.find(function(t){return t._id==e}),i=t.customer.shipping_address.indexOf(o);t.customer.shipping_address.splice(i,1),d.update(t,T.userId).then(function(e){r.toastr({type:"success",data:{title:"Địa chỉ",message:"Xóa thành công"}}),a.close(),n.reload()})["catch"](function(e){r.toastr({type:"error",data:{title:"Địa chỉ",message:e.data.message}}),userEdit.lockForm=!1,a.close()})}}]})}function b(){T.showForm=!T.showForm}var T=this;s.isSuperAdmin()||n.go("error403"),T.lockFOrm=!1,T.submitted=!1,T.userId=a.id,T.showForm=!1,T.addUserShipping=v,T.deleteUserShipping=y,T.show=b,T.updateAddressShipping=h,T.checkEmpty=f,g(),m()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","userSvc","editableOptions"],angular.module("bzUser").controller("userShippingCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),usersCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l){function d(){l.api(t.settings.services.apiUrl+"/user").get(v.queryParams,function(e){v.queryParams.pageCount=e.totalPage,v.users=e.items,v.table=new u({count:parseInt(v.queryParams.limit)||10},{counts:[],getData:function(t){return t.total(e.totalItems),v.users}}),v.table.page(v.queryParams.page),v.loading=!1},function(e){console.log(e),r.toastr({type:"error",data:{title:"User",message:e.data.message}})})}function p(e){n.go(".",{role:""!=v.role?v.role:null,keyword:e,status:""!=v.status?v.status:null,page:1}).then(function(){n.reload()})}function g(){n.go(".",{role:null,keyword:null,page:v.queryParams.page,status:null},{notify:!1}).then(function(){n.reload()})}function m(e,a){l.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).update({_id:e},{status:a},function(e){r.toastr({type:"success",data:{title:"User",message:1===a?"Kích hoạt tài khoản thành công!":"Vô hiệu hóa tài khoản thành công!"}}),n.reload()})}function h(e,t){r.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự bài viết thành công!"}})}function f(e){var a={ids:[e]};o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"})["delete"]({id:a.ids},function(e){r.toastr({type:"success",data:{title:"Xóa",message:"Xóa tài khoản thành công!"}}),n.reload(),o.close()})}}]})}var v=this;s.isSuperAdmin()||n.go("error403"),v.loading=!0,v.selectedItems=[],v.queryParams=a,v.keyword=a.keyword,v.role=a.role,v.status=a.status,v.userRoles=i,v.users=[],v.filter=p,v.filterReset=g,v.active=m,v.sort=h,v.remove=f,d(),c.onPagesChanged(function(){e.vmUsers.queryParams.page=v.table.page(),n.go(".",e.vmUsers.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc"],angular.module("bzUser").controller("usersCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),userEditProfileCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c){function l(e){p.lockForm=!1,p.submitted=!1,p.formData={name:p.isEditMode?e.name:"",email:p.isEditMode?e.email:"",password:"",cfpassword:"",roles:p.isEditMode?e.roles:["user"],status:!!p.isEditMode&&e.status,saleman:{active:!!p.isEditMode&&e.saleman.active,manager:!!p.isEditMode&&e.saleman.manager,types:p.isEditMode?e.saleman.types:[]}},"sale"==p.queryParams.module&&(p.formData.roles=["admin","user","sale"],p.formData.status=!p.isEditMode||e.status)}function d(){p.isEditMode?u.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:p.queryParams.id},function(e){delete e.__v,delete e.password_token,delete e.created,delete e.provider,delete e.activeToken,l(e)}):l()}var p=this;i.isSuperAdmin()||i.isSaleManager()||n.go("error403"),p.queryParams=a,p.userRoles=o,p.salemanScopes=c,p.isEditMode=void 0!==p.queryParams.id,p.save=save,d()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","userRoles","authSvc","userSvc","bzResourceSvc","salemanScopes"],angular.module("bzUser").controller("userEditProfileCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),userEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c){function l(){h.isEditMode=void 0!==h.queryParams.id}function d(){s.getRoles().then(function(e){e.success&&(h.userRoles=e.data)})}function p(e){h.lockForm=!1,h.submitted=!1;h.isEditMode?e.name:"";h.tmppassword="",h.formData={name:1==h.isEditMode?e.name:"",phone:h.isEditMode?e.phone:"",email:h.isEditMode?e.email:"",password:h.isEditMode?e.password:"",roles:h.isEditMode?e.roles:["user"],vocative:h.isEditMode?e.vocative:"Anh",dob:h.isEditMode?e.dob:"",status:!h.isEditMode||e.status},h.loading=!1}function g(){h.isEditMode?u.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:h.queryParams.id},function(e){delete e.__v,delete e.password_token,delete e.created,delete e.provider,delete e.activeToken,p(e)}):p()}function m(e){h.submitted=!0,h.formData.dob||(h.formData.dob=""),!h.lockForm&&e&&(h.lockForm=!0,1==h.formData.status?h.formData.status=!0:0==h.formData.status&&(h.formData.status=!1),h.isEditMode?h.isEditMode&&(1==h.formData.status?h.formData.status=!0:0==h.formData.status&&(h.formData.status=!1),delete h.formData.password,delete h.formData.cfpassword,s.update(h.formData,h.queryParams.id).then(function(e){r.toastr({type:"success",data:{title:"Thành viên",message:"Sửa thành công"}}),n.go("users",{id:null})},function(e){r.toastr({type:"error",data:{title:"Thành viên",message:e.data.message}}),h.lockForm=!1})):(h.formData.cfpassword=h.formData.password,s.create(h.formData).then(function(e){r.toastr({type:"success",data:{title:"Thành viên",message:e.message}}),n.go("users",{id:null})},function(e){r.toastr({type:"error",data:{title:"Thành viên",message:e.data.message}}),h.lockForm=!1})))}var h=this;i.isSuperAdmin()||n.go("error403"),h.formData={},h.queryParams=a,h.userRoles=[],h.loading=!0,h.listClasses=c,h.isEdit=l,h.save=m,h.initFormData=p,h.getData=g,h.listVocative=[{name:"Anh",value:"Anh"},{name:"Chị",value:"Chị"},{name:"Cô",value:"Cô"},{name:"Chú",value:"Chú"},{name:"Bác",value:"Bác"},{name:"Ông",value:"Ông"},{name:"Bà",value:"Bà"}],l(),d()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","userRoles","authSvc","userSvc","bzResourceSvc","listClasses"],angular.module("bzUser").controller("userEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){l.api(t.settings.services.admin+"/unit").get(v.queryParams,function(e){v.queryParams.pageCount=e.totalPage,v.listUnit=e.items,v.table=new u({count:20},{counts:[],getData:function(t){return t.total(e.totalItems),v.listUnit}}),v.table.page(v.queryParams.page),v.loading=!1})}function m(e){n.go(".",{"class":""!=v.queryParams["class"]?v.queryParams["class"]:null,keyword:e,page:1}).then(function(){n.reload()})}function h(){n.go(".",{keyword:null,"class":null},{notify:!1}).then(function(){n.reload()})}function f(e){var a={ids:[e]};o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/unit/:id",{id:"@id"})["delete"]({id:a.ids},function(e){r.toastr({type:"success",data:{title:"Xóa",message:"Xóa bài học thành công!"}}),n.reload(),o.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("unit",["view"])||n.go("error403"),v.loading=!0,v.selectedItems=[],v.queryParams=a,v.listClasses=p,v.userRoles=i,v.units=[],v.filter=m,v.filterReset=h,v.remove=f,g(),c.onPagesChanged(function(){e.vmUnits.queryParams.page=v.table.page(),n.go(".",e.vmUnits.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","unitSvc","listClasses"],angular.module("bzUnit").controller("unitsCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){var e=a.id;d.get(e).then(function(e){h.formData=e})["catch"](function(e){r.toastr({type:"error",data:{title:"Getting",message:e.data}})})}function m(e){h.submitted=!0,h.lockForm=!0,e?d.update(h.formData,h.formData._id).then(function(e){r.toastr({type:"success",data:{title:"Bài học",message:e.message}}),n.go("units")})["catch"](function(e){r.toastr({type:"error",data:{title:"Cập nhật bài học",message:e.data.message}})}):h.submitted=!0}var h=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("unit",["edit"])||n.go("error403"),h.lockFOrm=!1,h.save=m,h.vmEditUnits=g,h.submitted=!1,h.listClasses=p,g()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","unitSvc","listClasses"],angular.module("bzUnit").controller("unitEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(e){m.submitted=!0,m.lockForm=!0,e?d.create(m.formData).then(function(e){r.toastr({type:"success",data:{title:"Bài học",message:"Thêm thành công"}}),n.go("units")})["catch"](function(e){r.toastr({type:"error",data:{title:"Thêm bài học",message:e.data}})}):m.submitted=!0}var m=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("unit",["add"])||n.go("error403"),m.formData={index_unit:1,classes:"4",status:!0},m.lockFOrm=!1,m.save=g,m.submitted=!1,m.listClasses=p}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","unitSvc","listClasses"],angular.module("bzUnit").controller("unitAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),testResizeCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){r.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(e,t){e.popupScope={event:"crop:image",ratio:.75,width:300,height:400},e.$on("crop:image",function(e,t){console.log("image",t),p.uploadBase64({directory:"avatar",image:t.image}).then(function(e){console.log("success uplaod",e)})["catch"](function(e){console.log("Error upload: ",e)})})}]})}function m(){p.resize(f.formData).then(function(e){f.image["new"]=e})["catch"](function(e){console.log("err",e)})}function h(t){if(t.length>0){if("image/png"!=t[0].type&&"image/jpeg"!=t[0].type&&"image/gif"!=t[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");d.upload({url:o.settings.services.uploadApi+"/upload/file",data:{file:t[0],type:"tmp",prefix:"test_img"}}).then(function(e){console.log(e),f.image.old=e.data,f.formData.name=f.image.old.filename},function(e){a.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}var f=this;f.thumbImgPath=settingJs.configs.uploadDirectory.thumb,f.tempImgPath=settingJs.configs.uploadDirectory.tmp,f.image={old:null,"new":null},f.formData={height:300,width:300,name:null},f.uploadImage=h,f.resize=m,f.crop=g}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","$filter","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","Upload","testSvc"],angular.module("bzTest").controller("testResizeCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),tagProductCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){l.api(t.settings.services.admin+"/tag").get($.queryParams,function(e){$.tagProduct=e.items})}function m(e){$.tags=[],e?d.get(e).then(function(e){$.tags.push(e),$.tags.forEach(function(e,t){var n=e._id,a=e.type;d.getListProduct(n,a).then(function(t){e.products=t.data}),d.getProductByTag(n,a).then(function(t){t.data&&(t.data.forEach(function(e){var t={};e.tag_product.forEach(function(e){n==e.id_tag&&(t=e)}),e.tag_product=t}),e.table=t.data)})})}):l.api(t.settings.services.admin+"/tag").get($.queryParams,function(e){$.tags=e.items,$.tags.forEach(function(e,t){var n=e._id,a=e.type;d.getListProduct(n,a).then(function(t){e.products=t.data}),d.getProductByTag(n,a).then(function(t){t.data&&(t.data.forEach(function(e){var t={};e.tag_product.forEach(function(e){n==e.id_tag&&(t=e)}),e.tag_product=t}),e.table=t.data)})})})}function h(e){n.go(".",{tag:e}).then(function(){n.reload()})}function f(){n.go(".",{tag:null},{notify:!1}).then(function(){n.reload()})}function v(e,t){var n=0,a=!0;return!(e.category_list.length>0)||(e.category_list.forEach(function(e){n=0,t.table.forEach(function(t){t.category_list.forEach(function(t){var a=e.parent_category||e,r=t.parent_category||t;a._id==r._id&&(n+=1)})}),n>=12&&(a=!1)}),a)}function y(e,t){if($.submitted=!0,$.lockForm=!0,e)for(var a={id_tag:t._id,expire_date:t.formData.expire_date},o=t.formData.idProducts,i=0;i<o.length;i++){var s=o[i];d.getProductById(s).then(function(e){var o=e;v(o,t)?(o.tag_product.push(a),p.updateTag({data:o}).then(function(e){r.toastr({type:"success",data:{title:"Thành công",message:"Thêm sản phẩm "+o.name+" thành công"}}),n.reload()})["catch"](function(e){r.toastr({type:"error",data:{title:"Thất bại",message:e.data.message}})})):r.toastr({type:"error",data:{title:"Thất bại",message:"Danh mục của sản phẩm "+o.name+" quá số lượng"}})})}else $.submitted=!0,$.lockForm=!1}function b(e,t,a,r){d.getProductById(t._id).then(function(e){var t=0;e.tag_product.find(function(e,n){return t=n,e.id_tag==a});e.tag_product[t].order=r,p.updateTag({data:e}).then(function(e){n.reload()})})}function T(e,t){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(a,o){a.popTitle="Xóa",a.message="Bạn chắc chắn sẽ xóa dữ liệu này?",a.ok=function(){d.getProductById(e._id).then(function(e){var a=0;e.tag_product.find(function(e,n){return a=n,e.id_tag==t});e.tag_product.splice(a,1),p.updateTag({data:e}).then(function(e){r.toastr({type:"success",data:{title:"Thành công",message:"Xóa nhãn thành công."}}),n.reload(),o.close()})["catch"](function(e){r.toastr({type:"error",data:{title:"aaa",message:e.data.message}}),o.close()})})}}]})}function P(e){"undefined"==typeof e.showForm?e.showForm=!0:e.showForm=!e.showForm}var $=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("tag","view")||n.go("error403"),$.loading=!0,$.selectedItems=[],$.queryParams=a,$.keyword=a.tag||"",$.userRoles=i,$.formData={},$.lockFOrm=!1,$.submitted=!1,$.optionTimePicker={timePicker:!0,timePickerIncrement:30,singleDatePicker:!1,locale:{format:"h:mm DD/MM/YYYY"}},$.filter=h,$.filterReset=f,$.saveProduct=y,$.deleteProduct=T,$.showForm=P,$.getListTag=m,$.updateOrder=b,g(),m($.keyword)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc","productSvc"],angular.module("bzTag").controller("tagProductCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),tagProcesssingCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){y.productByTag=[],l.api(t.settings.services.admin+"/tag").get(y.queryParams,function(e){y.tags=e.items,y.tags.forEach(function(e,t){var n=e._id,a=e.type;d.getListProduct(n,a).then(function(t){e.products=t.data}),d.getProductByTag(n,a).then(function(t){e.table=t.data})})})}function m(e,t){if(y.submitted=!0,y.lockForm=!0,e)for(var a={id_tag:t._id},o=t.formData.idProducts,i=0;i<o.length;i++){var s=o[i];d.getProductById(s).then(function(e){var t=e;t.tag_processing.push(a),p.updateTag({data:t}).then(function(e){r.toastr({type:"success",data:{title:"Thành công",message:"Thêm nhãn thành công"}}),n.reload()})["catch"](function(e){console.log("error",e),r.toastr({type:"error",data:{title:"aaa",message:e.data.message}})})})}else y.submitted=!0}function h(e,t){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(a,o){a.popTitle="Xóa",a.message="Bạn chắc chắn sẽ xóa dữ liệu này?",a.ok=function(){var a=0;e.tag_processing.find(function(e,n){return a=n,e.id_tag==t});e.tag_processing.splice(a,1),p.updateTag({data:e}).then(function(e){r.toastr({type:"success",data:{title:"Thành công",message:"Thêm nhãn thành công"}}),n.reload(),o.close()})["catch"](function(e){console.log("error",e),r.toastr({type:"error",data:{title:"aaa",message:e.data.message}}),o.close()})}}]})}function f(e){"undefined"==typeof e.showForm?e.showForm=!0:e.showForm=!e.showForm}function v(e,t){return t.tag_processing.find(function(t){return t.id_tag==e})}var y=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("tag","view")||n.go("error403"),y.loading=!0,y.selectedItems=[],y.queryParams=a,y.userRoles=i,y.tags=[],y.formData={},y.lockFOrm=!1,y.submitted=!1,y.optionTimePicker={timePicker:!0,timePickerIncrement:30,singleDatePicker:!1,locale:{format:"h:mm DD/MM/YYYY"}},y.saveProduct=m,y.deleteProduct=h,y.showForm=f,y.findTag=v,g()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc","productSvc"],angular.module("bzTag").controller("tagProcesssingCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),tagCtrl=function(){function e(e,n,a,r,o,i,s,u,c,l,d,p){function g(){d.api(n.settings.services.admin+"/tag").get(y.queryParams,function(e){y.queryParams.pageCount=e.totalPage,y.tags=e.items,console.log("test",y.tags),y.table=new c({count:10},{counts:[],getData:function(t){return t.total(e.totalItems),y.tags}}),y.table.page(y.queryParams.page),y.loading=!1})}function m(e){a.go(".",{keyword:e,page:y.queryParams.page}).then(function(){a.reload()})}function h(){a.go(".",{keyword:null,page:y.queryParams.page},{notify:!1}).then(function(){a.reload()})}function f(e,t){o.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự nhãn thành công!"}})}function v(e){var t={ids:[e]};console.log("asd",e);i.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,r){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){d.api(n.settings.services.admin+"/tag/:id",{id:"@id"})["delete"]({id:t.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa nhãn thành công!"}}),a.reload(),r.close()})}}]})}var y=this;u.isSuperAdmin()||u.isAdmin()&&u.hasPermission("tag","view")||a.go("error403"),y.showBtnAdd=u.hasPermission("tag","add"),y.showBtnEdit=u.hasPermission("tag",["add","edit"]),y.showBtnDelete=u.hasPermission("tag","delete"),y.loading=!0,y.selectedItems=[],y.queryParams=r,y.keyword=r.keyword,y.userRoles=s,y.tags=[],y.filter=m,y.filterReset=h,y.sort=f,y.remove=v,y.checkType=t,g(),l.onPagesChanged(function(){e.vmTags.queryParams.page=y.table.page(),a.go(".",e.vmTags.queryParams)},e,y.table)}function t(e){return"SP"===e?"Sản phẩm":"CN"===e?"Cách nấu":"BL"===e?"Bài viết":void 0}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc"],angular.module("bzTag").controller("tagCtrl",e);var n={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:n}}(),tagEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){var e=a.id;d.get(e).then(function(e){m.formData=e})["catch"](function(e){r.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function g(e){m.submitted=!0,m.lockForm=!0,e?d.update(m.formData,m.formData._id).then(function(e){r.toastr({type:"success",data:{title:"Phí vận chuyển",message:e.message}}),n.go("tag-list")})["catch"](function(e){r.toastr({type:"error",data:{title:"Cập nhật phí vận chuyển",message:e.data.message}})}):m.submitted=!0}var m=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("tag",["add","edit"])||n.go("error403"),m.lockFOrm=!1,m.save=g,m.vmEditTags=p,m.submitted=!1,p()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc"],angular.module("bzTag").controller("tagEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),tagAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(e){g.submitted=!0,g.lockForm=!0,console.log(g.formData),e?d.create(g.formData).then(function(e){console.log("1success",e),r.toastr({type:"success",data:{title:"Nhãn sản phẩm",message:"Thêm thành công"}}),n.go("tag-list")})["catch"](function(e){console.log("1error",e),r.toastr({type:"error",data:{title:"Thêm nhãn sản phẩm ",message:e.data.message}})}):g.submitted=!0}var g=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("tag","add")||n.go("error403"),g.formData={},g.lockFOrm=!1,g.save=p,g.submitted=!1,g.formData.type="SP"}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc"],angular.module("bzTag").controller("tagAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),supplierListCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/supplier").get(f.queryParams,function(e){f.queryParams.pageCount=e.totalPage,f.listSupplier=e.items,f.table=new u({count:parseInt(f.queryParams.limit)||10},{counts:[],getData:function(t){return t.total(e.totalItems),f.listSupplier}}),f.table.page(f.queryParams.page),f.loading=!1})}function g(e){n.go(".",{keyword:e,page:f.queryParams.page},{notify:!1}).then(function(){n.reload()})}function m(){n.go(".",{keyword:null,page:f.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e){var a={ids:[e]};o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/supplier/:id",{id:"@id"})["delete"]({id:a.ids},function(e){r.toastr({type:"success",data:{title:"Xóa",message:"Xóa nhà cung cấp thành công!"}}),n.reload(),o.close()})}}]})}var f=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("supplier",["view"])||n.go("error403"),f.loading=!0,f.selectedItems=[],f.keyword=a.keyword,f.queryParams=a,f.userRoles=i,f.listSupplier=[],f.filter=g,f.filterReset=m,f.remove=h,p(),c.onPagesChanged(function(){e.vmListSupplier.queryParams.page=f.table.page(),n.go(".",e.vmListSupplier.queryParams)},e,f.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","supplierSvc"],angular.module("bzSupplier").controller("supplierListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),supplierImportProductHistoryCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l){function d(){var e=n.id;l.get(e).then(function(e){g.supplier=e})["catch"](function(e){a.toastr({type:"error",data:{title:"Nhà cung cấp",message:e.data.message}})})}function p(){c.api(o.settings.services.admin+"/supplier/import-product/"+n.id).get(g.queryParams,function(e){g.filter={},g.queryParams.pageCount=e.totalPage,g.list=e.items,g.params=e.params,g.table=new i({count:g.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),g.list}}),g.table.page(g.queryParams.page),g.loading=!1})}var g=this;u.isSuperAdmin()||u.isAdmin()&&u.hasPermission("supplier",["edit","export"])||t.go("error403"),g.loading=!0,g.queryParams=n,g.supplier={},d(),p(),s.onPagesChanged(function(){e.vmSupplierImportProductHistory.queryParams.page=g.table.page(),t.go(".",e.vmSupplierImportProductHistory.queryParams)},e,g.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","supplierSvc"],angular.module("bzSupplier").controller("supplierImportProductHistoryCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){var e=a.id;d.get(e).then(function(e){m.formData=e})["catch"](function(e){r.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function g(e){m.submitted=!0,m.lockForm=!0,e?d.update(m.formData,m.formData._id).then(function(e){r.toastr({type:"success",data:{title:"Nhà cung cấp",message:e.message}}),n.go("suppliers")})["catch"](function(e){r.toastr({type:"error",data:{title:"Nhà cung cấp",message:e.data.message}})}):m.submitted=!0}var m=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("supplier",["edit"])||n.go("error403"),m.formData={name:"",phone:"",fax:"",email:"",website:"",status:!0,address:"",deputy:{name:"",phone:"",email:""}},m.lockFOrm=!1,m.save=g,m.submitted=!1,p()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","supplierSvc"],angular.module("bzSupplier").controller("supplierEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(e){g.submitted=!0,g.lockForm=!0,e?d.create(g.formData).then(function(e){r.toastr({type:"success",data:{title:"Nhà cung cấp",message:e.message}}),n.go("suppliers")})["catch"](function(e){r.toastr({type:"error",data:{title:"Nhà cung cấp",message:e.data.message}}),g.submitted=!0,g.lockForm=!1}):(g.submitted=!0,g.lockForm=!1)}var g=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("supplier",["add"])||n.go("error403"),g.formData={name:"",phone:"",tax_code:"",bank_info:{name:"",account_number:"",bank_name:""},email:"",website:"",status:!0,address:"",deputy:{name:"",phone:"",email:""}},g.lockFOrm=!1,g.save=p,g.submitted=!1}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","supplierSvc"],angular.module("bzSupplier").controller("supplierAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),shippingfeeCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/shippingfee").get(v.queryParams,function(e){v.queryParams.pageCount=e.totalPage,v.shippingfees=e.items,v.table=new u({count:10},{counts:[],getData:function(t){return t.total(e.totalItems),v.shippingfees}}),v.table.page(v.queryParams.page),v.loading=!1})}function g(e){n.go(".",{keyword:e,page:v.queryParams.page}).then(function(){n.reload()})}function m(){n.go(".",{keyword:null,page:v.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e,t){r.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự bài viết thành công!"}})}function f(e){var a={ids:[e]};o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/shippingfee/:id",{id:"@id"})["delete"]({id:a.ids},function(e){r.toastr({type:"success",data:{title:"Xóa",message:"Xóa phí vận chuyển thành công!"}}),n.reload(),o.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("shipping","view")||n.go("error403"),v.showBtnAdd=s.hasPermission("shipping","add"),v.showBtnEdit=s.hasPermission("shipping",["add","edit"]),v.showBtnDelete=s.hasPermission("shipping","delete"),v.loading=!0,v.selectedItems=[],v.queryParams=a,v.keyword=a.keyword,v.userRoles=i,v.shippingfees=[],v.filter=g,v.filterReset=m,v.sort=h,v.remove=f,p(),c.onPagesChanged(function(){e.vmShippingFees.queryParams.page=v.table.page(),n.go(".",e.vmShippingFees.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","shippingfeeSvc"],angular.module("bzShippingFee").controller("shippingfeeCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),shippingfeeEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){var e=a.id;d.get(e).then(function(e){m.formData=e})["catch"](function(e){r.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function g(e){m.submitted=!0,m.lockForm=!0,e?d.update(m.formData,m.formData._id).then(function(e){r.toastr({type:"success",data:{title:"Phí vận chuyển",message:e.message}}),n.go("shippingfee-list")})["catch"](function(e){r.toastr({type:"error",data:{title:"Cập nhật phí vận chuyển",message:e.data.message}})}):m.submitted=!0}var m=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("shipping",["add","edit"])||n.go("error403"),m.lockFOrm=!1,m.save=g,m.getShippingFee=p,m.submitted=!1,p()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","shippingfeeSvc"],angular.module("bzShippingFee").controller("shippingfeeEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),shippingfeeAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){h.formData.district&&h.listShippingFeeNoExitsInMongoDB.forEach(function(e){e.district==h.formData.district&&(h.formData.fee=e.fee,h.formData.type=e.type+"")})}function g(e){"mongodb"==e?d.getAllNoPaging().then(function(e){h.listShippingFeeInMongoDB=e.items,g("default")})["catch"](function(t){console.log(e,t)}):d.getShippingFeeDefault().then(function(e){h.listShippingFeeDefault=e.items,h.listShippingFeeDefault.map(function(e){var t=!1;h.listShippingFeeInMongoDB.forEach(function(n){n.district==e.district&&(t=!0)}),t||h.listShippingFeeNoExitsInMongoDB.push(e)})})["catch"](function(e){console.log("get default shipping fee",e)})}function m(e){h.submitted=!0,h.lockForm=!0,e?d.create(h.formData).then(function(e){r.toastr({type:"success",data:{title:"Giá vận chuyển",message:"Thêm thành công"}}),n.go("shippingfee-list")})["catch"](function(e){
r.toastr({type:"error",data:{title:"Thêm giá vận chuyển",message:e.data.message}})}):h.submitted=!0}var h=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("shipping","add")||n.go("error403"),h.formData={},h.lockFOrm=!1,h.save=m,h.submitted=!1,h.formData.type="1",h.listShippingFeeInMongoDB=[],h.listShippingFeeDefault=[],h.listShippingFeeNoExitsInMongoDB=[],h.onChangeDistrict=p,g("mongodb")}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","shippingfeeSvc"],angular.module("bzShippingFee").controller("shippingfeeAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),searchListCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l){function d(){e.vmSeL.queryParams.page=h.table.page(),t.go(".",e.vmSeL.queryParams)}function p(){l.getAll(h.queryParams).then(function(e){h.queryParams.pageCount=e.totalPage,h.list=e.items,h.table=new s({count:h.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),h.list}}),h.table.page(h.queryParams.page),h.loading=!1})}function g(e){e.status=!e.status;var t=e.status?"bỏ công khai":"công khai";r.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,a){n.popTitle="",n.message="Bạn muốn "+t+" từ khóa này?",n.ok=function(){l.active(e._id).then(function(t){e.status=!e.status,a.close()})}}]})}function m(e){r.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popTitle="Xóa ",n.message="Bạn muốn xóa từ khóa này?",n.ok=function(){l.del(e).then(function(e){e.success&&(h.queryParams.page=1,t.go(".",h.queryParams).then(function(){t.reload(),r.close(),a.toastr({type:"success",data:{title:"Thành công!",message:"Xóa từ khóa thành công!"}})}))},function(e){a.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa từ khóa thất bại!"}})})}}]})}var h=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("search","view")||t.go("error403"),h.showBtnAdd=c.hasPermission("search","add"),h.showBtnEdit=c.hasPermission("search",["add","edit"]),h.showBtnDelete=c.hasPermission("search","delete"),h.loading=!0,h.queryParams=n,h.urlImg=settingJs.configs.uploadDirectory.product,h.activeSearch=g,h.deleteSearch=m,p(),u.onPagesChanged(d,e,h.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","searchSvc"],angular.module("bzSearch").controller("searchListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),searchEditCtrl=function(){function e(e,t,n,a,r,o,i){function s(){i.edit(l.queryParams.id).then(function(e){l.search=e.data,l.loading=!0})}function u(e){return e.$valid?void i.update({data:l.search},l.queryParams.id).then(function(e){t.go("search-list"),a.toastr({type:"success",data:{title:"Thành công!",message:"Sửa từ khóa thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,a.toastr({type:"error",data:{title:"Lỗi!",message:"Sửa từ khóa thất bại!"}})}):void a.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin"}})}function c(e){e&&(e.$submitted=!1)}var l=this;o.isSuperAdmin()||o.isAdmin()&&o.hasPermission("search",["add","edit"])||t.go("error403"),l.queryParams=n,l.removeDisabledSubmit=c,l.update=u,l.getData=s}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","authSvc","searchSvc"],angular.module("bzSearch").controller("searchEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),searchAddCtrl=function(){function e(e,t,n,a,r,o,i){function s(){l.search={status:!0}}function u(e){return e.$valid?void i.create({data:l.search}).then(function(e){t.go("search-list"),a.toastr({type:"success",data:{title:"Thành công!",message:"Thêm từ khóa thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,a.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm từ khóa thất bại!"}})}):void a.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}})}function c(e){e&&(e.$submitted=!1)}var l=this;o.isSuperAdmin()||o.isAdmin()&&o.hasPermission("search","add")||t.go("error403"),l.loading=!0,l.queryParams=n,l.removeDisabledSubmit=c,l.add=u,l.getData=s}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","authSvc","searchSvc"],angular.module("bzSearch").controller("searchAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),promotionListCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l){function d(){e.vmPoL.queryParams.page=m.table.page(),t.go(".",e.vmPoL.queryParams)}function p(){l.getAll(m.queryParams).then(function(e){m.queryParams.pageCount=e.totalPage,m.list=e.items,m.table=new s({count:m.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),m.list}}),m.table.page(m.queryParams.page),m.loading=!1})}function g(e){r.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popTitle="Xóa ",n.message="Bạn muốn xóa promotion này?",n.ok=function(){l["delete"](e).then(function(e){e.success&&(m.queryParams.page=1,t.go(".",m.queryParams).then(function(){t.reload(),r.close(),a.toastr({type:"success",data:{title:"Thành công!",message:"Xóa promotion thành công!"}})}))},function(e){a.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa promotion thất bại!"}})})}}]})}var m=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("promotion","view")||t.go("error403"),m.showBtnAdd=c.hasPermission("promotion","add"),m.showBtnEdit=c.hasPermission("promotion",["add","edit"]),m.showBtnDelete=c.hasPermission("promotion","delete"),m.loading=!0,m.queryParams=n,m.urlImg=settingJs.configs.uploadDirectory.product,m.remove=g,p(),u.onPagesChanged(d,e,m.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","promotionSvc"],angular.module("bzProduct").controller("promotionListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),promotionEditCtrl=function(){function e(e,t,n,a,r,o,i,s){function u(){s.edit(d.queryParams.id).then(function(e){d.prom=e.prom,d.listProm=e.listProm,d.listProduct=e.products,d.product_apply=d.prom.product.map(function(e){return e._id}),d.loading=!1})["catch"](function(e){a.toastr({type:"error",data:{title:"Lỗi!",message:"Có vấn đề! Hãy thử tải lại trang."}})})}function c(e){return e.$valid?(d.promExist=d.listProm.find(function(e){return e.name==d.prom.name}),void(d.promExist||s.update({data:d.prom,product_apply:d.product_apply},d.queryParams.id).then(function(e){t.go("promotion-list"),a.toastr({type:"success",data:{title:"Thành công!",message:"Sửa giảm giá sản phẩm thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,a.toastr({type:"error",data:{title:"Lỗi!",message:"Sửa giảm giá sản phẩm thất bại!"}})}))):void a.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}})}function l(e){e.$submitted=!1}var d=this;i.isSuperAdmin()||i.isAdmin()&&i.hasPermission("promotion",["add","edit"])||t.go("error403"),d.loading=!0,d.queryParams=n,d.submit=c,d.removeDisabled=l,u()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","$timeout","authSvc","promotionSvc"],angular.module("bzPromotion").controller("promotionEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),promotionAddCtrl=function(){function e(e,t,n,a,r,o,i,s){function u(){s.add().then(function(e){d.prom={type:"PC",status:!0},d.loading=!1,d.listProm=e.list,d.listProduct=e.products})["catch"](function(e){a.toastr({type:"error",data:{title:"Lỗi!",message:"Có vấn đề! Hãy thử tải lại trang."}})})}function c(e){return e.$valid?(d.promExist=d.listProm.find(function(e){return e.name==d.prom.name}),void(d.promExist||s.create({data:d.prom,product_apply:d.product_apply}).then(function(e){t.go("promotion-list"),a.toastr({type:"success",data:{title:"Thành công!",message:"Thêm giảm giá sản phẩm thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,a.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm giảm giá sản phẩm thất bại!"}})}))):void a.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}})}function l(e){e.$submitted=!1}var d=this;i.isSuperAdmin()||i.isAdmin()&&i.hasPermission("promotion","add")||t.go("error403"),d.loading=!0,d.queryParams=n,d.addPromotion=c,d.removeDisabled=l,u()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","$timeout","authSvc","promotionSvc"],angular.module("bzPromotion").controller("promotionAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),productListCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){e.vmPrL.queryParams.page=$.table.page(),t.go(".",e.vmPrL.queryParams)}function g(){l.getAll($.queryParams).then(function(e){$.queryParams.pageCount=e.totalPage,$.totalItems=e.totalItems,$.list=e.items,$.categoryList=e.categoryList,$.optionsCate=T(e.categoryWithSub),$.tagList=e.tagList,$.filterTmp={status:$.queryParams.status},$.table=new s({count:$.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),$.list}}),$.table.page($.queryParams.page),$.loading=!1})}function m(e){e.active=!e.active;var t=e.active?"bỏ công khai":"công khai";r.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,a){n.popTitle="",n.message="Bạn muốn "+t+" sản phẩm này?",n.ok=function(){l.activeProduct(e._id).then(function(t){e.active=!e.active,a.close()})}}]})}function h(e,n){r.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popTitle="Xóa ",n.message="Bạn muốn xóa sản phẩm này?",n.ok=function(){l.deleteProduct(e).then(function(e){e.success&&($.queryParams.page=1,t.go(".",$.queryParams).then(function(){t.reload(),r.close(),a.toastr({type:"success",data:{title:"Thành công!",message:"Xóa sản phẩm thành công!"}})}))},function(e){a.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa sản phẩm thất bại!"}})})}}]})}function f(e){$.queryParams.page=1,$.queryParams.status=$.filterTmp.status,t.go(".",$.queryParams).then(function(){t.reload()})}function v(){$.queryParams.name=null,$.queryParams.active=null,$.queryParams.category=null,$.queryParams.status=null,$.queryParams.tag=null,$.queryParams.dueDate=null,t.go(".",$.queryParams).then(function(){t.reload()})}function y(e){if(e){var t=moment();return e=moment(e),moment(t).isBefore(e)}}function b(e){return e.tag_processing.concat(e.tag_product)}function T(e){var t=[],n=function a(e,t){return t.push(e),e.sub_category&&e.sub_category.length>0&&e.sub_category.forEach(function(e){return a(e,t)}),t};return e.forEach(function(e){var a=n(e,[]);e.sub_cate=a.splice(1),t.push(e)}),t}function P(e){$.btnExport=!0;var t=[["STT","Tên sản phẩm","Đơn giá","Giá khuyến mãi","Danh mục","Đơn vị","Đơn vị hiển thị","Publish"]],n={type:"xlsx",sheetName:"SheetJS1",fileName:"Product"},r=JSON.parse(JSON.stringify($.queryParams));r.limit=$.totalItems,l.getAll(r).then(function(e){e.items.forEach(function(e,n){var a="";e.category_list.forEach(function(e,t){0!=t&&(a+=", "),a+=e.name});var r="";if(e.promotion)switch(e.promotion.type){case"PC":r=e.price*(100-e.promotion.value)/100;break;case"MN":r=e.price-e.promotion.value}t.push([n+1,e.name,e.price,r,a,e.unit.name,e.view_unit,e.active?"Có":"Không"])}),ExcelJs.exportExcel(t,n),$.btnExport=!1})["catch"](function(e){console.log(e),$.btnExport=!1,a.toastr({type:"error",data:{title:"Lỗi!",message:"Xuất Excel thất bại!"}})})}var $=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("product","view")||t.go("error403"),$.showBtnAdd=c.hasPermission("product","add"),$.showBtnEdit=c.hasPermission("product",["add","edit"]),$.showBtnDelete=c.hasPermission("product","delete"),$.loading=!0,$.queryParams=n,$.setting=settingJs,$.urlImg=settingJs.configs.uploadDirectory.thumb_product,$.statusProduct=d,$.btnExport=!1,$.activeProduct=m,$.deleteProduct=h,$.filterForm=f,$.clearFilter=v,$.dueDate=y,$.formatTag=b,$.checkImgOld=l.checkImgOld,$.exportExcel=P,g(),u.onPagesChanged(p,e,$.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","productSvc","statusProduct"],angular.module("bzProduct").controller("productListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),productEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){u.getProductByID(_.queryParams.id).then(function(e){_.productTmp={},_.optionsCate=g(e.categoryWithSub),_.unitList=e.unit,_.product=e.product,_.product.videos=e.product.videos?e.product.videos:[],_.product.video=e.product.videos.length>0?e.product.videos[0].url:"",_.product.thumb&&(_.productTmp.thumb=u.thumbToImage(_.product.thumb)),_.categoryList=e.categoryList,_.promotionList=e.promotionList,_.certificateList=e.certificateList,_.tags_proccess=e.tags_proccess,_.tmp_tag_proccessing=_.product.tag_processing.map(function(e){return e.id_tag});var t={singleDatePicker:!1},n="";if(_.product.due_date){var a=moment(_.product.due_date.start_date).format("DD/MM/YYYY"),r=moment(_.product.due_date.end_date).format("DD/MM/YYYY");angular.extend(t,{startDate:a,endDate:r}),n=a+" - "+r}_.dateTimePickerOpt=t,_.showDateTime=!0,o(function(){angular.element("#datetime-picker").val(n)},10),_.active_tmp=_.product.active?"1":"0",_.vat_tmp=_.product.vat?"1":"0",_.productList=e.productList,_.productBalance=e.productBalance?e.productBalance.value:3,_.imgDelete=[],_.product.detail_infor=u.fixImgProductDetail(_.product.detail_infor),h(),_.loading=!1})["catch"](function(e){console.log(e),a.toastr({type:"error",data:{title:"Lỗi!",message:"Có vấn đề! Hãy thử tải lại trang."}})})}function g(e){var t=[],n=function a(e,t){return t.push(e),e.sub_category&&e.sub_category.length>0&&e.sub_category.forEach(function(e){return a(e,t)}),t};return e.forEach(function(e){var a=n(e,[]);e.sub_cate=a.splice(1),t.push(e)}),t}function m(){return _.product.qty_in_stock<_.productBalance?void(_.product.status="SHH"):_.product.qty_in_stock>=_.productBalance?void(_.product.status="CH"):void 0}function h(){_.units_name=_.unitList.find(function(e){return _.product.id_unit===e._id})}function f(e){var t=_.product.relative_product.indexOf(e._id);t>-1&&(_.product.relative_product.splice(t,1),o(function(){var t=$('#mod-product-edit .content .select2-search-choice:contains("'+e.name+'")');t.find(".select2-search-choice-close").trigger("click")},10))}function v(t){if(t.length>0){if("image/png"!=t[0].type&&"image/jpeg"!=t[0].type)return void a.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có định dạng png hoặc jpg!"}});c.imageDimensions(t[0]).then(function(n){n.width>448&&n.height>448?c.upload({url:r.settings.services.uploadApi+"/upload/file",data:{file:t[0],type:"product_image",prefix:"product_image"}}).then(function(t){_.product.images.push({url:t.data.filename}),e.progressPercentage=!1,a.toastr({type:"success",data:{title:"Thành công!",message:"Upload ảnh thành công!"}})},function(e){a.toastr({type:"error",data:{title:"Lỗi!",message:"Upload ảnh lỗi!"}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)}):a.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có kích thước lớn hơn 448px x 448px!"}})})}}function y(e){_.product.slug=u.changeToSlug(e)}function b(e){return e.$valid?(_.product.active="1"==_.active_tmp,_.product.vat="1"==_.vat_tmp,_.productTmp.due_date&&(_.product.due_date={start_date:_.productTmp.due_date.startDate,end_date:_.productTmp.due_date.endDate}),_.product.video&&(_.product.video=u.formatYoutube(_.product.video),_.product.videos=[{url:_.product.video}],delete _.product.video),_.productTmp.thumb&&u.imageToThumb(_.productTmp.thumb)!=_.product.thumb&&(_.product.thumb=_.productTmp.thumb),void u.updateProduct({data:_.product,imgDelete:_.imgDelete},_.product._id).then(function(e){1==e.success&&(t.go("product"),a.toastr({type:"success",data:{title:"Thành công!",message:"Sửa sản phẩm thành công!"}}))})["catch"](function(t){e.$submitted=!1,console.log(t),a.toastr({type:"error",data:{title:"Lỗi!",message:"Sửa sản phẩm thất bại. Hãy thử lại"}})})):void a.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng nhập đầy đủ thông tin."}})}function T(e,t,n){_.imgDelete.push({url:t,fileName:n}),_.product.images.splice(e,1)}function P(e){e&&(e.$submitted=!1)}function C(e){e&&(_.product.tag_processing=e.map(function(e){return{id_tag:e}}))}function S(e,t){i.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,a){n.popupScope={image:_.urlImg+t.url,event:"crop:image",ratio:1,width:500,height:500},n.$on("crop:image",function(n,r){u.uploadBase64({directory:"product_image",image:r.image}).then(function(n){var r=t.url;_.imgDelete.push({url:_.urlImg,fileName:t.url}),_.product.images[e].url=n.name,_.productTmp.thumb==r&&w(e),a.close()})})}]})}function w(e){_.productTmp.thumb=_.product.images[e].url}function H(e){var t=e.name;return e.status||(t+=" (Unactive)"),t}var _=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("product",["add","edit"])||t.go("error403"),_.queryParams=n,_.loading=!0,_.urlImg=settingJs.configs.uploadDirectory.product,_.ckeOpt=l,_.statusProduct=d,_.submitForm=b,_.getNameTag=h,_.uploadImage=v,_.removeRelated=f,_.changeStatus=m,_.removeDisabled=P,_.removeImage=T,_.addTagProccess=C,_.checkSlug=y,_.cropImage=S,_.selectThumb=w,_.checkImgOld=u.checkImgOld,_.checkActiveOnsale=H,_.fixImgProductDetail=u.fixImgProductDetail,p()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","$timeout","$uibModal","authSvc","productSvc","Upload","CKEditorOptPro","statusProduct"],angular.module("bzProduct").controller("productEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),productAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){u.add().then(function(e){_.optionsCate=m(e.categoryWithSub),_.relatedProduct=[],_.unitList=e.unit,_.productList=e.productList,_.categoryList=e.categoryList,_.promotionList=e.promotionList,_.certificateList=e.certificateList,_.tags_proccess=e.tags_proccess,_.active_tmp="1",_.vat_tmp="1",_.productTmp={},angular.element("#datetime-picker").val(""),_.productBalance=e.productBalance?e.productBalance.value:3,_.product={active:!0,slug:"",videos:[],status:"HSV",images:[],relative_product:[],other_is:!1,id_unit:null,qty_in_stock:0},_.loading=!1,_.imgDelete=[],o(function(){var e=$("#mod-product-add .content .select2-search-choice");e.find(".select2-search-choice-close").trigger("click")},10),f()})["catch"](function(e){console.log(e),a.toastr({type:"error",data:{title:"Lỗi!",message:"Có vấn đề! Hãy thử tải lại trang."}})})}function g(e){_.product.slug=u.changeToSlug(e)}function m(e){var t=[],n=function a(e,t){return t.push(e),e.sub_category&&e.sub_category.length>0&&e.sub_category.forEach(function(e){return a(e,t)}),t};return e.forEach(function(e){var a=n(e,[]);e.sub_cate=a.splice(1),t.push(e)}),t}function h(){return _.product.qty_in_stock<_.productBalance?void(_.product.status="SHH"):_.product.qty_in_stock>=_.productBalance?void(_.product.status="CH"):void 0}function f(){_.units_name=_.unitList.find(function(e){return _.product.id_unit===e._id})}function v(e){var t=_.product.relative_product.indexOf(e._id);t>-1&&(_.product.relative_product.splice(t,1),o(function(){var t=$('#mod-product-add .content .select2-search-choice:contains("'+e.name+'")');t.find(".select2-search-choice-close").trigger("click")},10))}function y(t){if(t.length>0){if("image/png"!=t[0].type&&"image/jpeg"!=t[0].type)return void a.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có định dạng png hoặc jpg!"}});c.imageDimensions(t[0]).then(function(n){n.width>448&&n.height>448?c.upload({url:r.settings.services.uploadApi+"/upload/file",data:{file:t[0],type:"product_image",prefix:"product_image"}}).then(function(t){_.product.images.push({url:t.data.filename}),e.progressPercentage=!1,a.toastr({type:"success",data:{title:"Thành công!",message:"Upload ảnh thành công!"}})},function(t){e.progressPercentage=!1,a.toastr({type:"error",data:{title:"Lỗi!",message:"Upload ảnh Lỗi!"}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)}):a.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có kích thước lớn hơn 448px x 448px!"}})})}}function b(e){return e.$valid?(_.product.active="1"==_.active_tmp,_.productTmp.due_date&&(_.product.due_date={start_date:_.productTmp.due_date.startDate,end_date:_.productTmp.due_date.endDate}),_.product.video&&(_.product.video=u.formatYoutube(_.product.video),_.product.videos.push({url:_.product.video}),delete _.product.video),_.productTmp.thumb&&(_.product.thumb=_.productTmp.thumb),void u.create({data:_.product,imageDelete:_.imgDelete}).then(function(e){t.go("product"),a.toastr({type:"success",data:{title:"Thành công!",message:"Thêm sản phẩm thành công!"}})})["catch"](function(t){e.$submitted=!1,console.log(t),a.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm sản phẩm thất bại. Hãy thử lại!"}})})):void a.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin."}})}function T(e,t,n){_.product.images.splice(e,1),_.imgDelete.push({url:t,fileName:fileName})}function P(e){e&&(e.$submitted=!1)}function C(e){e&&(_.product.tag_processing=e.map(function(e){return{id_tag:e}}))}function S(e,t){i.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,a){n.popupScope={image:_.urlUploadImg+t.url,event:"crop:image",ratio:1,width:500,height:500},n.$on("crop:image",function(n,r){u.uploadBase64({directory:"product_image",image:r.image}).then(function(n){var r=t.url;_.imgDelete.push({url:_.urlUploadImg,fileName:t.url}),_.product.images[e].url=n.name,_.productTmp.thumb==r&&w(e),a.close()})})}]})}function w(e){_.productTmp.thumb=_.product.images[e].url}function H(e){var t=e.name;return e.status||(t+=" (Unactive)"),t}var _=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("product","add")||t.go("error403"),_.loading=!0,_.queryParams=n,_.urlUploadImg=settingJs.configs.uploadDirectory.product,_.ckeOpt=l,_.statusProduct=d,_.dateTimePickerOpt={singleDatePicker:!1},_.addProduct=b,_.getNameTag=f,_.uploadImage=y,_.removeProductRelated=v,_.changeStatusProduct=h,_.removeDisabledSubmit=P,_.removeImage=T,_.addTagProccess=C,_.checkSlug=g,_.cropImage=S,_.selectThumb=w,_.checkImgOld=u.checkImgOld,_.checkActiveOnsale=H,p()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","$timeout","$uibModal","authSvc","productSvc","Upload","CKEditorOptPro","statusProduct"],angular.module("bzProduct").controller("productAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),orderReportCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){var e={singleDatePicker:!1};if(y.queryParams.date){var t=y.queryParams.date.split(" - ");angular.extend(e,{startDate:t[0],endDate:t[1]}),angular.element("#datetime-picker").val(y.queryParams.date)}y.dateTimePickerOpt=e,c.api(o.settings.services.admin+"/order").get(y.queryParams,function(e){y.queryParams.pageCount=e.totalPage,y.list=e.items,y.params=e.params,y.statusOrderList=l,y.listCoupon=e.listCoupon,y.filter={},y.queryParams.min_order&&(y.filter.min_order=y.queryParams.min_order?parseInt(y.queryParams.min_order):void 0),y.queryParams.max_order&&(y.filter.max_order=y.queryParams.max_order?parseInt(y.queryParams.max_order):void 0),y.table=new i({count:y.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),y.list}}),y.table.page(y.queryParams.page),y.loading=!1})}function g(e){return y.statusOrderList.find(function(t){return e.status==t.value})}function m(e){y.queryParams.page=1,y.filter.date&&(y.queryParams.date=f(y.filter.date.startDate)+" - "+f(y.filter.date.endDate)),y.queryParams.min_order=y.filter.min_order,y.queryParams.max_order=y.filter.max_order,t.go(".",y.queryParams).then(function(){t.reload()})}function h(){y.queryParams.customer_name=null,y.queryParams.coupon=null,y.queryParams.date=null,y.queryParams.status=null,y.queryParams.type=null,y.queryParams.min_order=null,y.queryParams.max_order=null,t.go(".",y.queryParams).then(function(){t.reload()})}function f(e){return e.format("DD/MM/YYYY")}function v(e){var t=[["Mã đơn hàng","Ngày đặt hàng","Tên khách hàng","SĐT","Quận","Địa chỉ","Sản phẩm","Số lượng","Số lượng thực giao","Đơn giá","Giảm giá","Tổng tiền khách đặt","Phí ship","Ngày Giao Hàng","Đợt giao hàng","Đơn vị giao hàng","Ghi chú đơn hàng","Trạng thái đơn hàng"]],n={type:"xlsx",sheetName:"SheetJS1",fileName:"Order"};e.forEach(function(e){e.order_detail.forEach(function(n){var a="";if(n.id_promote.id)switch(n.id_promote.type){case"MN":a+=n.id_promote.value+" Đ";break;case"PC":a+=n.id_promote.value+" %";break;default:a+=n.id_promote.value+" %"}t.push([e.id_order,moment(e.createdAt).format("D/M/YYYY"),e.payment_info.info.full_name,e.payment_info.info.phone,e.payment_info.info.district,e.payment_info.info.address,n.product.name,n.order_quantity,"",d.formatCurrency(n.price),a,d.formatCurrency(n.total),d.formatCurrency(e.shipping_fee.fee),moment(e.ship_date).format("D/M/YYYY"),"Đợt 1",e.shiper,e.note,g(e).name])})}),ExcelJs.exportExcel(t,n)}var y=this;u.isSuperAdmin()||u.isAdmin()&&u.hasPermission("order","export")||t.go("error403"),y.loading=!0,y.queryParams=n,y.statusOrderList=l,y.getStatusOrder=g,y.filterForm=m,y.clearFilter=h,y.exportExcel=v,p(),s.onPagesChanged(function(){e.vmOrR.queryParams.page=y.table.page(),t.go(".",e.vmOrR.queryParams)},e,y.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","statusOrderList","orderSvc"],angular.module("bzOrder").controller("orderReportCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),orderListCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){S.list.forEach(function(e){e.value_checkbox=S.checkbox.selectAll})}function m(){var e=new Image,t=angular.element("#image")[0],n=t.getContext("2d");e.src="/assets/admin/images/mhv.jpg",e.onload=function(){t.width=e.width,t.height=e.height,n.drawImage(e,0,0,e.width,e.height),S.dataURLImage=t.toDataURL()};var a={singleDatePicker:!1};if(S.queryParams.date){var r=S.queryParams.date.split(" - ");angular.extend(a,{startDate:r[0],endDate:r[1]}),angular.element("#datetime-picker").val(S.queryParams.date)}S.dateTimePickerOpt=a,p.getAll(S.queryParams).then(function(e){S.queryParams.pageCount=e.totalPage,S.list=e.items,S.params=e.params,S.statusOrderList=d,S.listCoupon=e.listCoupon,S.filter={},S.checkbox={selectAll:!1},S.list.forEach(function(e){e.value_checkbox=!1}),S.queryParams.min_order&&(S.filter.min_order=S.queryParams.min_order?parseInt(S.queryParams.min_order):void 0),S.queryParams.max_order&&(S.filter.max_order=S.queryParams.max_order?parseInt(S.queryParams.max_order):void 0),S.queryParams.coupon&&(S.couponDetail=S.listCoupon.find(function(e){return e._id==S.queryParams.coupon})),S.table=new s({count:S.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),S.list}}),S.table.page(S.queryParams.page),S.loading=!1})}function h(e){var t=o.open({animation:!0,templateUrl:"modules/admin-order/view/client/popup-order/detail-order/view.html",controller:"popupOrderCtrl",resolve:{order:function(){return angular.copy(e)},permission:function(){return angular.copy(S.showBtnEdit)}}});t.result.then(function(t){angular.extend(e,t)},function(){})}function f(e){return S.statusOrderList.find(function(t){return e.status==t.value})}function v(e){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(t,a){t.popTitle="Xóa ",t.message="Bạn muốn xóa đơn hàng này?",t.ok=function(){p["delete"](e).then(function(e){e.success&&(S.queryParams.page=1,n.go(".",S.queryParams).then(function(){n.reload()}),a.close(),r.toastr({type:"success",data:{title:"Thành công!",message:"Xóa đơn hàng thành công!"}}))},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa đơn hàng thất bại!"}})})}}]})}function y(e){S.queryParams.page=1,S.filter.date&&(S.queryParams.date=T(S.filter.date.startDate)+" - "+T(S.filter.date.endDate)),S.queryParams.min_order=S.filter.min_order,S.queryParams.max_order=S.filter.max_order,n.go(".",S.queryParams).then(function(){n.reload()})}function b(){S.queryParams.customer_name=null,S.queryParams.coupon=null,S.queryParams.date=null,S.queryParams.status=null,S.queryParams.type=null,S.queryParams.type=null,S.queryParams.min_order=null,S.queryParams.max_order=null,n.go(".",S.queryParams).then(function(){n.reload()})}function T(e){return e.format("DD/MM/YYYY")}function P(e){var t=[["Mã đơn hàng","Ngày đặt hàng","Tên khách hàng","SĐT","Quận","Địa chỉ","Sản phẩm","Số lượng","Số lượng thực giao","Đơn giá","Giảm giá","Tổng tiền khách đặt","Phí ship","Ngày Giao Hàng","Đợt giao hàng","Đơn vị giao hàng","Ghi chú đơn hàng","Trạng thái đơn hàng"]],n={type:"xlsx",sheetName:"SheetJS1",fileName:"Order"};e.forEach(function(e){e.order_detail.forEach(function(n){var a="";if(n.promotion)switch(n.promotion.type){case"MN":a+=n.promotion.value+" Đ";break;case"PC":a+=n.promotion.value+" %";break;default:a+=n.promotion.value+" %"}t.push([e.id_order,moment(e.createdAt).format("D/M/YYYY"),e.payment_info.info.full_name,e.payment_info.info.phone,e.payment_info.info.district,e.payment_info.info.address,n.product.name,n.order_quantity,"",n.price,a,n.total,e.shipping_fee?e.shipping_fee.fee:"",moment(e.ship_date).format("D/M/YYYY"),"Đợt 1",e.shiper,e.note,f(e).name])})}),ExcelJs.exportExcel(t,n)}function $(){l.api(i.settings.services.admin+"/configs").get({},function(e){t.promotionForOrderDeleveryOnAffternoon=e.OrderDeleveryOnAffernoon,t.promotionForFirstOrder=e.FirstOrder,t.freeShipUrban=e.FreeShipConfig.Urban,t.freeShipSuburb=e.FreeShipConfig.Suburb}),function(e){}}function P(e){S.btnExportExcel=!0;var t=[["Mã coupon","Tên coupon"],[S.couponDetail.code,S.couponDetail.name],["STT","Order id","Name","SĐT","Email","Địa chỉ giao hàng","Thời gian order","Phí vận chuyển","Tổng tiền order","Giá trị coupon","Trạng thái order"]],n={type:"xlsx",sheetName:"SheetJS1",fileName:"Order"},a=JSON.parse(JSON.stringify(S.queryParams));a.limit=S.totalItems,p.getAll(a).then(function(e){e.items.forEach(function(e,n){t.push([n+1,e.id_order,e.payment_info.info.full_name,e.payment_info.info.phone,e.payment_info.info.email,e.payment_info.info.address+"- "+e.payment_info.info.district,e.createdAt,e.payment_info.info.shipping_fee+" đ",e.total,e.coupon.value,f(e).name])}),ExcelJs.exportExcel(t,n),S.btnExportExcel=!1})["catch"](function(e){console.log(e),S.btnExportExcel=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:"Xuất Excel thất bại!"}})})}function C(){S.btnExportPDF=!0;var e=[],n={textGreen:{color:"#00a65a",bold:!0},textRed:{color:"#dd4b39"}},a={},o=0,i=[];try{S.list.forEach(function(n,a){if(n.value_checkbox){i.push(n);var r=[],s={table:{widths:["*","auto"],body:[[{text:"Mã hóa đơn: #"+n.id_order+"\nMã đơn hàng: #"+n.id_order+"\nNgày giao hàng: "+moment(n.createdAt).format("DD-MM-YYYY"),fillColor:"#737373",color:"white",margin:[5,5]},{image:S.dataURLImage,width:200,height:45,fillColor:"#737373",margin:[5,5]}]]},layout:"noBorders"};0!=o&&(s.pageBreak="before"),r.push(s),o++;var u="";n.payment_info.info.user_id&&(u+=n.payment_info.info.user_id.name,u+="\nSố điện thoại: ",u+=n.payment_info.info.user_id.phone?n.payment_info.info.user_id.phone:"",
u+="\nEmail: ",u+=n.payment_info.info.user_id.email?n.payment_info.info.user_id.email:"");var c=n.payment_info.info.vocative||"undefined"!=n.payment_info.info.vocative?n.payment_info.info.vocative+" ":"";r.push({table:{widths:[248,248],headerRows:1,body:[[{text:"Thông tin mua hàng",fillColor:"#edebeb"},{text:"Thông tin nhận hàng",fillColor:"#edebeb"}],[{text:u,border:[!0,!1,!1,!0]},{text:c+n.payment_info.info.full_name+"\nSố điện thoại: "+n.payment_info.info.phone+"\nĐịa chỉ: "+n.payment_info.info.address+", "+n.payment_info.info.district,border:[!1,!0,!0,!0]}]]}}),r.push({text:"",margin:[0,0,0,20]}),r.push({table:{widths:[248,248],headerRows:1,body:[[{text:"Phương thức thanh toán",fillColor:"#edebeb"},{text:"Phương thức vận chuyển",fillColor:"#edebeb"}],[{text:"COD"==n.payment_method?"Thanh toán khi giao hàng (COD)":"Chuyển khoản",border:[!0,!1,!1,!0]},{text:[{text:0==n.payment_info.info.shipping_fee?"Miễn phí\n":""},{text:"(Phí vận chuyển "+p.formatCurrency(n.payment_info.info.shipping_fee)+" ₫)"}],border:[!1,!0,!0,!0]}]]}}),r.push({text:"",margin:[0,0,0,20]});var l=[[{text:"Sản phẩm",fillColor:"#edebeb",border:[!0,!0,!1,!0]},{text:"TL/ĐVT",fillColor:"#edebeb",border:[!1,!0,!1,!0],alignment:"right"},{text:"Số lượng",fillColor:"#edebeb",border:[!1,!0,!1,!0],alignment:"right"},{text:"Giá",fillColor:"#edebeb",border:[!1,!0,!1,!0],alignment:"right"},{text:"Tổng tiền",fillColor:"#edebeb",border:[!1,!0,!0,!0],alignment:"right"}]];n.order_detail.forEach(function(e){if(e.product){var t=e.price;e.id_promote&&("PC"==e.id_promote.type&&(t=t*(100-e.id_promote.value)/100),"MN"==e.id_promote.type&&(t-=e.id_promote.value)),l.push([{text:e.product.name,border:[!1,!1,!1,!1],margin:[0,0,0,5]},{text:e.product.view_unit?e.product.view_unit:"",border:[!1,!1,!1,!1],alignment:"right",margin:[0,0,0,5]},{text:e.order_quantity+"",border:[!1,!1,!1,!1],alignment:"right",margin:[0,0,0,5]},{text:p.formatCurrency(t)+" ₫",border:[!1,!1,!1,!1],alignment:"right",margin:[0,0,0,5]},{text:p.formatCurrency(e.total)+" ₫",border:[!1,!1,!1,!1],alignment:"right",margin:[0,0,0,5]}])}}),r.push({table:{widths:[206,80,60,60,63],headerRows:1,body:l}}),r.push({text:"",margin:[0,0,0,40]});var d=0==n.payment_info.info.shipping_fee?"(Miễn phí)":"",g=[["","Tổng cộng: ",p.formatCurrency(n.total)+" ₫"],["",{text:["Khuyến mãi: ",{text:n.id_coupon?"("+n.coupon.name+"): ":"",style:"textGreen"}]},{text:[{text:n.coupon.value>0?"-"+p.formatCurrency(n.coupon.value):0}," ₫"]}],["",{text:["Phí vận chuyển ",{text:d,style:"textRed"},":"]},p.formatCurrency(n.payment_info.info.shipping_fee)+" ₫"]];if("CHIEU"==n.delivery_time&&t.promotionForOrderDeleveryOnAffternoon.status){var m="PC"==t.promotionForOrderDeleveryOnAffternoon.type?t.promotionForOrderDeleveryOnAffternoon.value/100*n.total:t.promotionForOrderDeleveryOnAffternoon.value;g.push(["",{text:[{text:t.promotionForOrderDeleveryOnAffternoon.description,style:"textGreen"},": "]},"-"+p.formatCurrency(m)+" ₫"])}if(n.is_first_order){var m="MN"==t.promotionForFirstOrder.type?t.promotionForFirstOrder.value:t.promotionForFirstOrder.value/100*n.total;g.push(["",{text:[{text:t.promotionForFirstOrder.description,style:"textGreen"},": "]},"-"+p.formatCurrency(m)+" ₫"])}n.shipping_fee&&("1"==n.shipping_fee.type&&n.total>t.freeShipUrban.value&&g.push([{text:[{text:t.freeShipUrban.description,style:"textGreen"}],colSpan:3}]),"2"==n.shipping_fee.type&&n.total>t.freeShipSuburb.value&&g.push([{text:[{text:t.freeShipSuburb.description,style:"textGreen"}],colSpan:3}])),g.push(["","Tổng tiền: ",p.formatCurrency(n.total_pay)+" ₫"]),r.push({table:{widths:[56,340,100],headerRows:1,body:g},alignment:"right",layout:"noBorders"}),r.push({text:n.note?"Ghi chú: "+n.note:""}),e.push(r)}});var s={content:e,styles:n,defaultStyle:a};0==o?r.toastr({type:"error",data:{title:"Chưa chọn hóa dơn!",message:"Vui lòng chọn hóa đơn bạn muốn xuất!"}}):1==o?pdfMake.createPdf(s).download(i[0].id_order+".pdf"):pdfMake.createPdf(s).download(moment(i[0].createdAt).format("DDMMYY")+".pdf"),S.btnExportPDF=!1}catch(u){S.btnExportPDF=!1,console.log(u),r.toastr({type:"error",data:{title:"Lỗi!",message:"Xuất PDF thất bại!"}})}}var S=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("order","view")||n.go("error403"),S.showBtnAdd=c.hasPermission("order","add"),S.showBtnEdit=c.hasPermission("order",["add","edit"]),S.showBtnDelete=c.hasPermission("order","delete"),S.loading=!0,S.queryParams=a,S.statusOrderList=d,S.checkbox=[],S.detailOrderPop=h,S.getStatusOrder=f,S.deleteOrder=v,S.filterForm=y,S.clearFilter=b,S.exportExcel=P,S.selectAll=g,S.exportPDF=C,m(),$(),u.onPagesChanged(function(){e.vmOrL.queryParams.page=S.table.page(),n.go(".",e.vmOrL.queryParams)},e,S.table)}e.$inject=["$scope","$rootScope","$state","$stateParams","$bzPopup","$uibModal","$window","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","statusOrderList","orderSvc"],angular.module("bzOrder").controller("orderListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),orderEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g,m,h,f,v){function y(){p.edit(F.queryParams.id).then(function(e){F.listCoupon=e.listCoupon,F.listProduct=e.listProduct,F.listShippingFee=e.listShippingFee,F.listUser=e.listUser,F.order=e.order,F.order||n.go("error404"),F.loading=!1,b(),F.shippingTmp={fee:F.order.payment_info.info.shipping_fee?F.order.payment_info.info.shipping_fee:0},F.orderDetailTmp=F.listProduct.map(function(e){var t=F.order.order_detail.find(function(t){return t.product?t.product._id==e._id:null}),n=null;n=t?t.id_promote:e.promotion?{id:e.promotion._id,name:e.promotion.name,value:e.promotion.value,type:e.promotion.type}:null;var a=t?t.order_quantity:0;return{product_obj:e,product:e._id,order_quantity:t?t.order_quantity:0,price:t?t.price:e.price,total:t?t.total:0,id_promote:n,max_product:a+e.qty_in_stock}}),F.orderTmp={user:F.order.payment_info.info.user_id,shippingAddress:F.order.payment_info.info.id_shipping_address,coupon:F.listCoupon.find(function(e){return F.order.id_coupon==e._id}),orderDetailProduct:F.order.order_detail.map(function(e){return e.product?e.product._id:null})},F.dateTimePickerOpt={defaultDate:moment(F.order.ship_date).format("DD/MM/YYYY")},T(),F.order.payment_info.info.user_id&&F.userTmp&&(F.customerSignIn="true")})["catch"](function(e){console.log("error",e)})}function b(){F.order.payment_info.info.user_id&&(d.api(i.settings.services.admin+"/order/"+F.order.payment_info.info.user_id+"-"+F.order._id).get({},function(e){null==F.order.old_id&&(F.isFirstOder=e.success)}),function(e){console.log("checkFirstOrder",e)})}function T(e){var t=F.orderTmp.user;F.userTmp=F.listUser.find(function(e){return e._id==t}),F.userTmp&&(F.order.payment_info.info.user_id=F.userTmp._id,F.order.payment_info.info.email=F.userTmp.email,""!=F.order.payment_info.info.vocative&&F.order.payment_info.info.vocative||(F.order.payment_info.info.vocative=F.userTmp.vocative)),e&&(F.order.payment_info.info.district=null,F.orderTmp.shippingAddress=null),S()}function P(e){if(void 0==e&&(e=!1),F.order.id_coupon){var t={};F.listCoupon.forEach(function(e){F.order.id_coupon==e._id&&(t=e)}),p.checkCoupon(F.order,t.code).then(function(t){t.success?(F.order.id_coupon=t.coupon._id,F.order.coupon.value=t.money_coupon,F.order.coupon.code=t.coupon.code,F.order.coupon.name=t.coupon.name,e&&r.toastr({type:"success",data:{title:"Thành công",message:"Đơn hàng đang được giảm "+F.order.coupon.value+" đ"}})):(F.order.id_coupon=null,F.order.coupon.value=0,F.order.coupon.code="",F.order.coupon.name="",r.toastr({type:"error",data:{title:"Mã giảm giá",message:t.err.message}}))})["catch"](function(e){})}}function C(){if(F.userTmp){var e=F.order.payment_info.info.id_shipping_address,t=F.userTmp.customer.shipping_address.find(function(t){return e==t._id});t&&(F.order.shipping_fee=t.id_shipping_fee||null,angular.extend(F.order.payment_info.info,{id_shipping_address:t._id,full_name:t.name,phone:t.phone,address:t.address_detail,district:t.id_shipping_fee.district,shipping_fee:t.id_shipping_fee.fee}),F.order.id_shipping_fee=t.id_shipping_fee._id)}$(".fix-select-2-district").each(function(){var e=$(this);angular.element(document).injector().invoke(function(t){var n=angular.element(e).scope();t(e)(n)})}),S()}function S(){F.shippingTmp=F.listShippingFee.find(function(e){return e._id==F.order.id_shipping_fee}),"undefined"==typeof F.shippingTmp&&(F.shippingTmp={fee:F.order.payment_info.info.shipping_fee?F.order.payment_info.info.shipping_fee:0}),F.order.payment_info.info.shipping_fee=F.shippingTmp.fee,F.order.payment_info.info.district=F.shippingTmp.district,F.order.id_shipping_fee!=F.shippingTmp._id&&(F.order.payment_info.info.shipping_fee=F.shippingTmp.fee),F.order.id_shipping_fee=F.shippingTmp?F.shippingTmp._id:null;var e=F.order.total-F.order.coupon.value-("CHIEU"==F.order.delivery_time&&null==F.order.old_id?"PC"==t.promotionForOrderDeleveryOnAffternoon.type?t.promotionForOrderDeleveryOnAffternoon.value/100*F.order.total:t.promotionForOrderDeleveryOnAffternoon.value:0)-(F.isFirstOder?"MN"==t.promotionForFirstOrder.type?t.promotionForFirstOrder.value:t.promotionForFirstOrder.value/100*F.order.total:0);F.freeShip="NOT","CN"==F.order.delivery_type&&null==F.order.old_id&&("1"==F.shippingTmp.type&&e>t.freeShipUrban.value&&(F.freeShip="Urban",F.order.payment_info.info.shipping_fee=0),"2"==F.shippingTmp.type&&e>t.freeShipSuburb.value&&(F.order.payment_info.info.shipping_fee=0,F.freeShip="Suburb"))}function w(){F.order.order_detail=[],F.orderTmp.orderDetailProduct&&(F.order.order_detail=F.orderTmp.orderDetailProduct.map(function(e){var t=F.orderDetailTmp.find(function(t){return t.product===e});return t}))}function H(e){F.order.total=F.order.order_detail.reduce(function(e,t){t.id_promote?t.total=_(t.price,t.id_promote,t.order_quantity):t.total=_(t.price,0,t.order_quantity);var n=isNaN(t.total)?0:t.total;return e+n},0),P()}function _(e,t,n){return t?"PC"==t.type?e*(100-t.value)/100*n:"MN"==t.type?(e-t.value)*n:void 0:e*n}function D(e){if(F.submitted=!0,!e.$valid)return void r.toastr({type:"error",data:{title:"Cập nhật đơn hàng",message:"Dữ liệu chưa hợp lệ"}});if(F.order.total_pay=F.order.total+F.order.payment_info.info.shipping_fee-F.order.coupon.value-("CHIEU"==F.order.delivery_time?"PC"==t.promotionForOrderDeleveryOnAffternoon.type?t.promotionForOrderDeleveryOnAffternoon.value/100*F.order.total:t.promotionForOrderDeleveryOnAffternoon.value:0)-(F.isFirstOder?"MN"==t.promotionForFirstOrder.type?t.promotionForFirstOrder.value:t.promotionForFirstOrder.value/100*F.order.total:0),""!=F.order.id_coupon&&F.order.id_coupon){var n={};F.listCoupon.forEach(function(e){F.order.id_coupon==e._id&&(n=e)}),p.checkCoupon(F.order,n.code).then(function(e){e.success?A():(F.order.id_coupon=null,F.order.coupon.value=0,F.order.coupon.code="",F.order.coupon.name="",r.toastr({type:"error",data:{title:"Mã giảm giá",message:e.err.message}}))})["catch"](function(e){console.log(111,e)})}else A()}function A(){p.update({order:F.order,coupon:F.orderTmp.coupon},F.order._id).then(function(e){e.success?(r.toastr({type:"success",data:{title:"Thành công!",message:"Cập nhật đơn hàng thành công!"}}),n.go("order-list")):(F.submitted=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:e.err.message}}))},function(e){console.log(e),r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}}),F.submitted=!1})}function k(e){e&&(F.submitted=!1)}function z(){"CT"==F.order.delivery_type?F.order.payment_info.info.shipping_fee=0:S()}function L(e){if(F.order.payment_info.info.user_id&&e.$valid){var t=F.order.payment_info.info,n={id_shipping_fee:F.order.id_shipping_fee,name:t.full_name,phone:t.phone,vocative:t.vocative,address_detail:t.address};d.api(i.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:F.order.payment_info.info.user_id},function(e){var a=e;delete a.__v,delete a.password_token,delete a.created,delete a.provider,delete a.activeToken,a.cfpassword=a.password,a.dob||(a.dob=""),a.customer.shipping_address.forEach(function(o,i){if(o._id==F.order.payment_info.info.id_shipping_address){var s=a.customer.shipping_address[i];angular.extend(a.customer.shipping_address[i],n),angular.equals(a.customer.shipping_address[i],s)&&g.update(a,a._id).then(function(e){F.userTmp.customer.shipping_address.forEach(function(e,a){t.id_shipping_address==e._id&&angular.extend(F.userTmp.customer.shipping_address[a],n)})})["catch"](function(t){r.toastr({type:"error",data:{title:"Cập nhật địa chỉ giao hàng!",message:e.data.message}})})}})},function(e){r.toastr({type:"error",data:{title:"Cập nhật địa chỉ giao hàng!",message:"Không thể thấy tài khoản"}})})}}function E(){d.api(i.settings.services.admin+"/configs").get({},function(e){t.promotionForOrderDeleveryOnAffternoon=e.OrderDeleveryOnAffernoon,t.promotionForFirstOrder=e.FirstOrder,t.freeShipUrban=e.FreeShipConfig.Urban,t.freeShipSuburb=e.FreeShipConfig.Suburb}),function(e){}}var F=this;l.isSuperAdmin()||l.isAdmin()&&l.hasPermission("order",["add","edit"])||n.go("error403"),F.loading=!0,F.queryParams=a,F.statusOrderList=m,F.urlImg=settingJs.configs.uploadDirectory.thumb_product,F.shipperList=h,F.freeShip="NOT",F.listVocative=v,F.getDataShippingFee=S,F.getOrderDetail=w,F.checkCoupon=P,F.setPaymentInfo=C,F.getDataUser=T,F.editOrder=D,F.setTotalProduct=H,F.enableForm=k,F.isFirstOder=!1,F.customerSignIn="false",F.checkImgOld=f.checkImgOld,F.onChangeDeleveryType=z,F.updateUserShippingAdress=L,E(),y()}e.$inject=["$scope","$rootScope","$state","$stateParams","$bzPopup","$uibModal","$window","$timeout","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","orderSvc","userSvc","statusOrderList","shipperList","productSvc","listVocative"],angular.module("bzOrder").controller("orderEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),orderAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g,m,h){function f(){d.add().then(function(e){H.listCoupon=e.listCoupon,H.listProduct=e.listProduct,H.listShippingFee=e.listShippingFee,H.listUser=e.listUser,H.configNT=e.configNT,H.configNGT=e.configNGT,H.configBC=e.configBC,H.configDT=e.configDT,H.orderAddTmp={},H.shippingTmp={fee:0},H.isFirstOder=!1,H.orderDetailTmp=H.listProduct.map(function(e){return{product_obj:e,product:e._id,order_quantity:0,price:e.price,total:0,id_promote:e.promotion?{id:e.promotion._id,name:e.promotion.name,value:e.promotion.value,type:e.promotion.type}:null}}),H.orderAdd={delivery_type:"CN",delivery_time:"SANG",payment_method:"COD",type:"BT",payment_info:{info:{shipping_fee:0}},order_detail:[],total:0,status:H.statusOrderList[0].value,id_coupon:null,shiper:H.shipperList[0].value,coupon:{value:0,code:"",name:""}},H.loading=!1})}function v(e){if(void 0==e&&(e=!1),H.orderAdd&&""!=H.orderAdd.id_coupon){var t={};H.listCoupon.forEach(function(e){H.orderAdd.id_coupon==e._id&&(t=e)}),d.checkCoupon(H.orderAdd,t.code).then(function(t){t.success?(H.orderAdd.id_coupon=t.coupon._id,H.orderAdd.coupon.value=t.money_coupon,H.orderAdd.coupon.code=t.coupon.code,H.orderAdd.coupon.name=t.coupon.name,e&&a.toastr({type:"success",data:{title:"Thành công",message:"Đơn hàng đang được giảm "+H.orderAdd.coupon.value+" đ"}})):(H.orderAdd.id_coupon=null,H.orderAdd.coupon.value=0,H.orderAdd.coupon.code="",H.orderAdd.coupon.name="",a.toastr({type:"error",data:{title:"Mã giảm giá",message:t.err.message}}))})["catch"](function(e){console.log(111,e)})}H.orderAdd&&(H.orderAddTmp.coupon=H.listCoupon.find(function(e){return H.orderAdd.id_coupon==e._id}),H.orderAdd.coupon=null,H.orderAddTmp.coupon&&(H.orderAdd.coupon={code:H.orderAddTmp.coupon.code,name:H.orderAddTmp.coupon.name,value:H.orderAddTmp.coupon.sale.is_money?H.orderAddTmp.coupon.sale.money_value:H.orderAddTmp.coupon.sale.percent_value,type:H.orderAddTmp.coupon.sale.is_money?"MN":"PC"}))}function y(){H.orderAdd.order_detail=[],H.orderAddTmp.orderDetailProduct&&(H.orderAdd.order_detail=H.orderAddTmp.orderDetailProduct.map(function(e){var t=H.orderDetailTmp.find(function(t){return t.product===e});return t}))}function b(){var e=H.orderAddTmp.shippingAddress,t=H.orderAddTmp.user.customer.shipping_address.find(function(t){return e==t._id});angular.extend(H.orderAdd.payment_info.info,{id_shipping_address:t._id,full_name:t.name,phone:t.phone,address:t.address_detail,district:t.id_shipping_fee.district,shipping_fee:t.id_shipping_fee.fee}),T()}function T(){var e=H.orderAdd.payment_info.info.district;H.shippingTmp=H.listShippingFee.find(function(t){return t.district==e}),H.orderAdd.id_shipping_fee=H.shippingTmp?H.shippingTmp._id:null}function P(e){var t=H.orderAddTmp.user;d.isFirstOrder(t._id).then(function(e){H.isFirstOder=e.isFirstOrder}),H.orderAdd.payment_info.info={user_id:t._id,email:t.email,vocative:t.vocative,shipping_fee:0},e&&(H.orderAdd.payment_info.info.district=null,H.orderAddTmp.shippingAddress=null,T())}function $(){H.orderAdd.total=H.orderAdd.order_detail.reduce(function(e,t){t.total=C(t.price,t.id_promote)*t.order_quantity;var n=isNaN(t.total)?0:t.total;return e+n},0),H.orderAdd.total_pay=H.orderAdd.total+H.orderAdd.payment_info.info.shipping_fee-H.orderAdd.coupon.value-("CHIEU"==H.orderAdd.delivery_time?"PC"==H.configBC.type?H.configBC.value/100*H.orderAdd.total:H.configBC.value:0)-(H.isFirstOder?"MN"==H.configDT.type?H.configDT.value:H.configDT.value/100*H.orderAdd.total:0)}function C(e,t){if(t){if("PC"==t.type)return e*(100-t.value)/100;if("MN"==t.type)return e-t.value}return e}function S(e){return e.$valid?H.orderAddTmp.shippingAddress?(e.$submitted=!1,console.log(H.orderAdd),void d.create({data:H.orderAdd,coupon:H.orderAddTmp.coupon}).then(function(n){n.success?(a.toastr({type:"success",data:{title:"Thành công!",message:"Order thành công!"}}),t.go("order-list")):(e.$submitted=!1,console.log(n),a.toastr({type:"error",data:{title:"Lỗi!",message:"Order thất bại!"}}))},function(t){console.log(t),a.toastr({type:"error",data:{title:"Lỗi!",message:"Order thất bại!"}}),e.$submitted=!1})):void a.toastr({type:"error",data:{title:"Thông tin địa chỉ giao hàng chưa hợp lệ",message:"Hãy thử lại"}}):void a.toastr({type:"error",data:{title:"Thông tin đơn hàng chưa hợp lệ",message:"Hãy thử lại"}})}function w(e){e&&(e.$submitted=!1)}var H=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("order","add")||t.go("error403"),H.loading=!0,H.queryParams=n,H.statusOrderList=p,H.shipperList=g,H.urlImg=settingJs.configs.uploadDirectory.thumb_product,H.dateTimePickerOpt={},H.customerSignIn="true",H.listVocative=h,H.getDataShippingFee=T,H.getOrderDetail=y,H.getCoupon=v,H.setPaymentInfo=b,H.setDataUser=P,H.addOrder=S,H.setTotalProduct=$,H.enableForm=w,H.checkImgOld=m.checkImgOld,f(),v()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","$timeout","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","orderSvc","statusOrderList","shipperList","productSvc","listVocative"],angular.module("bzOrder").controller("orderAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),auditLogCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(e){y.detail=e;r.open({animation:!0,templateUrl:"modules/admin-log/view/client/popup/detail-log/view.html",controller:"popupLogCtrl",resolve:{detailLog:function(){return angular.copy(e)}}})}function m(){var e={singleDatePicker:!1};if(y.queryParams.date){var t=y.queryParams.date.split(" - ");angular.extend(e,{startDate:t[0],endDate:t[1]}),angular.element("#datetime-picker").val(y.queryParams.date)}y.dateTimePickerOpt=e,p.getLog(y.queryParams).then(function(e){y.queryParams.pageCount=e.totalPage,y.list=e.items,y.table=new s({count:y.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),y.list}}),y.table.page(y.queryParams.page),y.loading=!1})}function h(e){y.queryParams.page=1,y.filter.date&&(y.queryParams.date=v(y.filter.date.startDate)+" - "+v(y.filter.date.endDate)),void 0!=y.filter.action&&(y.queryParams.action=y.filter.action),y.filter.label&&(y.queryParams.label=y.filter.label),t.go(".",y.queryParams).then(function(){t.reload()})}function f(){y.queryParams.action="",y.queryParams.label="",y.queryParams.date=null,t.go(".",y.queryParams).then(function(){t.reload()})}function v(e){return e.format("DD/MM/YYYY")}var y=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("log",["view"])||t.go("error403"),y.loading=!0,y.queryParams=n,y.showPopupDetailLog=g,y.filter={action:y.queryParams.action?y.queryParams.action:null,label:y.queryParams.label?y.queryParams.label:null},y.listResource=d,y.filterForm=h,y.clearFilter=f,m(),u.onPagesChanged(function(){e.vmLog.queryParams.page=y.table.page(),t.go(".",e.vmLog.queryParams)},e,y.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","$filter","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","listResource","auditLogSvc"],angular.module("bzAuditLog").controller("auditLogCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),dashboardCtrl=function(){function e(e,t,n,a,r){var o=this;a.isSuperAdmin()||a.isAdmin()&&a.hasPermission("dashboard","view")||n.go("error403"),r.api(t.settings.services.admin+"/dashboard").get({},function(e){o.info=e})}e.$inject=["$scope","$window","$state","authSvc","bzResourceSvc"],angular.module("bzDashboard").controller("dashboardCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),couponCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/coupon").get(v.queryParams,function(e){v.queryParams.pageCount=e.totalPage,v.coupons=e.items,v.table=new u({count:20},{counts:[],getData:function(t){return t.total(e.totalItems),v.coupons}}),v.table.page(v.queryParams.page),v.loading=!1})}function g(e){n.go(".",{keyword:e,page:v.queryParams.page}).then(function(){n.reload()})}function m(){n.go(".",{keyword:null,page:v.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e,t){r.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự phiếu mua hàng thành công!"}})}function f(e){var a={ids:[e]};console.log("asd",e);o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/coupon/:id",{id:"@id"})["delete"]({id:a.ids},function(e){r.toastr({type:"success",data:{title:"Xóa",message:"Xóa phiếu mua hàng thành công!"}}),n.reload(),o.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("coupon","view")||n.go("error403"),v.showBtnAdd=s.hasPermission("coupon","add"),v.showBtnEdit=s.hasPermission("coupon",["add","edit"]),v.showBtnDelete=s.hasPermission("coupon","delete"),v.loading=!0,v.selectedItems=[],v.queryParams=a,v.keyword=a.keyword,v.userRoles=i,v.coupons=[],v.filter=g,v.filterReset=m,v.sort=h,v.remove=f,p(),c.onPagesChanged(function(){e.vmCoupons.queryParams.page=v.table.page(),n.go(".",e.vmCoupons.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","couponSvc"],angular.module("bzCoupon").controller("couponCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),couponEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){var e=a.id;d.get(e).then(function(e){T.formData=e,T.tmp_count=e.count===!0?"1":"0",T.tmp_sale=e.sale.is_money===!0?"money":"percent"})["catch"](function(e){r.toastr({type:"error",data:{title:"Sửa phiếu mua hàng",message:"Lỗi server"}})})}function m(){p.getAllNoPaging().then(function(e){T.district=e.items})["catch"](function(e){r.toastr({type:"error",data:{title:"Sửa phiếu mua hàng",message:"Lỗi server"}})})}function h(){l.api(t.settings.services.admin+"/category").get({limit:100,page:1,parrent_id:"*"},function(e){T.listCategory=e.items})}function f(){T.formData.code=T.formData.code.toUpperCase()}function v(e){T.submitted=!0,T.lockForm=!0,T.formData.count="1"==T.tmp_count,e?d.update(T.formData,T.formData._id).then(function(e){r.toastr({type:"success",data:{title:"Sửa phiếu mua hàng",message:"Thành công"}}),n.go("coupon-list")})["catch"](function(e){T.lockForm=!1,r.toastr({type:"error",data:{title:"Sửa phiếu mua hàng",message:e.data.message}})}):(T.submitted=!0,T.lockForm=!1)}function y(){for(var e=5,t="123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n="",a=e;a>0;--a)n+=t[Math.round(Math.random()*(t.length-1))];T.formData.code=n}function b(){"money"===T.tmp_sale?(T.formData.sale.is_money=!0,T.formData.sale.is_percent=!1,T.formData.sale.percent_value=""):(T.formData.sale.is_money=!1,T.formData.sale.is_percent=!0,T.formData.sale.money_value="")}var T=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("coupon",["add","edit"])||n.go("error403"),T.lockFOrm=!1,T.submitted=!1,T.optionTimePicker={timePicker:!0,timePickerIncrement:30,locale:{format:"h:mm DD/MM/YYYY"}},T.upCase=f,T.save=v,T.vmEditCoupons=g,T.randomString=y,T.checkSale=b,g(),m(),h()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","couponSvc","shippingfeeSvc"],angular.module("bzCoupon").controller("couponEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),couponAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g){function m(){p.getAllNoPaging().then(function(e){P.district=e.items})["catch"](function(e){r.toastr({type:"error",data:{title:"Thêm phiếu mua hàng",message:"Lỗi server"}})})}function h(){l.api(t.settings.services.admin+"/category").get({limit:100,page:1,parrent_id:"*"},function(e){P.listCategory=e.items})}function f(){P.formData.code=P.formData.code.toUpperCase()}function v(e){if(P.submitted=!0,P.lockForm=!0,P.formData.count="1"==P.tmp_count,e){var t=P.formData.code.split(","),a=-1,o=function i(e,n){if(e>=t.length)n();else{var r=t[e];""!=r?d.getByCode(r).then(function(t){t.success?(a=e,n()):i(++e,n)})["catch"](function(t){console.log(t),i(++e,n)}):i(++e,n)}};o(0,function(){a!=-1?(r.toastr({type:"error",data:{title:"Thêm phiếu mua hàng",message:"Đã tồn tại mã "+t[a]}}),P.lockForm=!1):d.create(P.formData).then(function(e){r.toastr({type:"success",data:{title:"Thành công",message:e.message}}),n.go("coupon-list")})["catch"](function(e){console.log(1,e),P.lockForm=!1,r.toastr({type:"error",data:{title:"Thêm phiếu mua hàng",message:e.data.message}})})})}else P.submitted=!0,P.lockForm=!1}function y(){for(var e=5,t="123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n="",a=e;a>0;--a)n+=t[Math.round(Math.random()*(t.length-1))];P.formData.code=n}function b(){"money"===P.tmp_sale?(P.formData.sale.is_money=!0,P.formData.sale.is_percent=!1,P.formData.sale.percent_value=""):(P.formData.sale.is_money=!1,P.formData.sale.is_percent=!0,P.formData.sale.money_value="")}function T(){var e=o.open({animation:!0,templateUrl:"modules/admin-coupon/view/client/popup/add-many-coupon/add-many-coupon.html",controller:"popupGenaratorCodeCtrl",resolve:{data:function(){return angular.copy({})}}});e.result.then(function(e){P.formData.code=e},function(){})}var P=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("coupon","add")||n.go("error403"),P.formData={},P.lockForm=!1,P.submitted=!1,P.formData.status="active",P.tmp_count="0",P.tmp_sale="money",P.formData.sale={},P.formData.sale.is_money=!0,P.formData.sale.is_percent=!1,P.formData.sale.percent_value="",P.formData.sale.money_value="",P.optionTimePicker={timePicker:!0,timePickerIncrement:30,locale:{format:"h:mm DD/MM/YYYY"}},P.upCase=f,P.save=v,P.randomString=y,P.checkSale=b,P.addManyCoupon=T,m(),h()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","couponSvc","shippingfeeSvc","categorySvc"],angular.module("bzCoupon").controller("couponAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),configListCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/config").get(f.queryParams,function(e){f.queryParams.pageCount=e.totalPage,f.listSupplier=e.items,f.table=new u({count:parseInt(f.queryParams.limit)||10},{counts:[],getData:function(t){return t.total(e.totalItems),f.listSupplier}}),f.table.page(f.queryParams.page),f.loading=!1})}function g(e){n.go(".",{keyword:e,page:f.queryParams.page},{notify:!1}).then(function(){n.reload()})}function m(){n.go(".",{keyword:null,page:f.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e){var a={ids:[e]};o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/config/:id",{id:"@id"})["delete"]({id:a.ids},function(e){r.toastr({type:"success",data:{title:"Config",message:"Deleted!"}}),n.reload(),o.close()})}}]})}var f=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("config",["view"])||n.go("error403"),f.loading=!0,f.selectedItems=[],f.keyword=a.keyword,f.queryParams=a,f.userRoles=i,f.listSupplier=[],f.filter=g,f.filterReset=m,f.remove=h,p(),c.onPagesChanged(function(){e.vmListConfig.queryParams.page=f.table.page(),n.go(".",e.vmListConfig.queryParams)},e,f.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","configSvc"],angular.module("bzConfig").controller("configListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),configEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){var e=a.id;d.get(e).then(function(e){h.formData=e,h.formData.type||(h.formData.type="")})["catch"](function(e){r.toastr({type:"error",data:{title:"Getting",message:e.data}})})}function m(e){h.submitted=!0,h.lockForm=!0,e?d.update(h.formData,h.formData._id).then(function(e){r.toastr({type:"success",data:{title:"Config",message:"Cập nhật thành công"}}),n.go("configs")})["catch"](function(e){r.toastr({type:"error",data:{title:"Cập nhật config",message:e.data.message}})}):h.submitted=!0}var h=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("config",["edit"])||n.go("error403"),h.lockFOrm=!1,h.save=m,h.vmEditConfig=g,h.submitted=!1,g()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","configSvc","bzUtilsSvc"],angular.module("bzConfig").controller("configEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),configAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(e){m.submitted=!0,m.lockForm=!0,e?d.create(m.formData).then(function(e){r.toastr({type:"success",data:{title:"Đơn vị",message:"Thêm thành công"}}),n.go("configs")})["catch"](function(e){r.toastr({type:"error",data:{title:"Config",message:e.data}})}):m.submitted=!0}var m=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("config",["add"])||n.go("error403"),m.formData={name:"",value:0,description:"",status:!0,type:""},m.lockFOrm=!1,m.save=g,m.submitted=!1}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","configSvc","bzUtilsSvc"],angular.module("bzConfig").controller("configAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),certificateCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/certificate").get(v.queryParams,function(e){v.queryParams.pageCount=e.totalPage,v.certificates=e.items,v.table=new u({count:20},{counts:[],getData:function(t){return t.total(e.totalItems),v.certificates}}),v.table.page(v.queryParams.page),v.loading=!1;
})}function g(e){n.go(".",{keyword:e,page:v.queryParams.page}).then(function(){n.reload()})}function m(){n.go(".",{keyword:null,page:v.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e,t){r.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự chứng chỉ thành công!"}})}function f(e){var a={ids:[e]};console.log("asd",e);o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/certificate/:id",{id:"@id"})["delete"]({id:a.ids},function(e){r.toastr({type:"success",data:{title:"Xóa",message:"Xóa chứng chỉ thành công!"}}),n.reload(),o.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("certificate","view")||n.go("error403"),v.showBtnAdd=s.hasPermission("certificate","add"),v.showBtnEdit=s.hasPermission("certificate",["add","edit"]),v.showBtnDelete=s.hasPermission("certificate","delete"),v.loading=!0,v.selectedItems=[],v.queryParams=a,v.keyword=a.keyword,v.userRoles=i,v.certificates=[],v.imagesDerectory=settingJs.configs.uploadDirectory.certificate,v.filter=g,v.filterReset=m,v.sort=h,v.remove=f,p(),c.onPagesChanged(function(){e.vmCertificates.queryParams.page=v.table.page(),n.go(".",e.vmCertificates.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","certificateSvc"],angular.module("bzCertificate").controller("certificateCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),certificateEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(){var e=a.id;d.get(e).then(function(e){v.formData=e})["catch"](function(e){r.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function m(e){v.submitted=!0,v.lockForm=!0,e?d.update(v.formData,v.formData._id).then(function(e){r.toastr({type:"success",data:{title:"Chứng chỉ",message:"Sửa thành công"}}),n.go("certificate-list")})["catch"](function(e){r.toastr({type:"error",data:{title:"Cập nhật chứng chỉ",message:e.data.message}})}):v.submitted=!0}function h(e){v.formData.images.splice(e,1)}function f(n){if(n.length>0){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"certificate_image",prefix:"certificate_image"}}).then(function(t){v.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("certificate",["add","edit"])||n.go("error403"),v.lockFOrm=!1,v.save=m,v.vmEditCertificates=g,v.submitted=!1,v.uploadImage=f,v.removeImage=h,v.imagesDirectory=settingJs.configs.uploadDirectory.certificate,g()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","certificateSvc","Upload"],angular.module("bzCertificate").controller("certificateEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),certificateAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p){function g(e){f.submitted=!0,f.lockForm=!0,console.log(f.formData),e?d.create(f.formData).then(function(e){r.toastr({type:"success",data:{title:"Chứng chỉ ",message:"Thêm thành công"}}),n.go("certificate-list")})["catch"](function(e){r.toastr({type:"error",data:{title:"Thêm chứng chỉ ",message:e.data.message}})}):f.submitted=!0}function m(e){f.formData.images.splice(e,1)}function h(n){if(n.length>0){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"certificate_image",prefix:"certificate_image"}}).then(function(t){f.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}var f=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("certificate","add")||n.go("error403"),f.formData={},f.lockFOrm=!1,f.save=g,f.submitted=!1,f.imagesDirectory=settingJs.configs.uploadDirectory.certificate,f.formData={name:"",description:"",images:[]},f.removeImage=m,f.uploadImage=h}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","certificateSvc","Upload"],angular.module("bzCertificate").controller("certificateAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),certificateProductCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g){function m(){var e=a.id;l.api(t.settings.services.admin+"/certificate-product/:id").get(P.queryParams,{id:e},function(e){P.queryParams.pageCount=e.totalPage,P.listProductOfCer=e["in"],P.listProduct=e.nin,P.table=new u({count:P.queryParams.limit||10},{counts:[],getData:function(t){return t.total(e.totalItems),P.listProductOfCer}}),P.table.page(P.queryParams.page),P.loading=!1})}function h(){var e=a.id;d.get(e).then(function(e){P.certificate=e})["catch"](function(e){r.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function f(e){n.go(".",angular.extend(e,saleContact.queryParams),{notify:!1}).then(function(){n.reload()})}function v(){n.go(".",{publish:null,cateid:null,keyword:null,limit:settingJs.admin.itemPerPage},{notify:!1}).then(function(){n.reload()})}function y(e,t){r.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự chứng chỉ thành công!"}})}function b(e){if(P.submitted=!0,P.lockForm=!0,e)for(var t=function(){var e=P.productID[a];p.getProductById(e).then(function(t){var a=t;a.certificates.push(P.cerID),g.updateProduct({data:a},e).then(function(e){r.toastr({type:"success",data:{title:"Sản phẩm",message:"thêm vào nhãn thành công"}}),n.reload()})["catch"](function(e){r.toastr({type:"error",data:{title:"aaa",message:e.data.message}})})})},a=0;a<P.productID.length;a++)t();else P.submitted=!0,P.lockForm=!1}function T(e){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(t,a){t.popTitle="Xóa",t.message="Bạn chắc chắn sẽ xóa dữ liệu này?",t.ok=function(){p.getProductById(e).then(function(t){var o=t,i=0;o.certificates.find(function(e,t){return i=t,e==P.cerID});o.certificates.splice(i,1),g.updateProduct({data:o},e).then(function(e){r.toastr({type:"success",data:{title:"Sản phẩm",message:"Xóa sản phẩm thành công"}}),n.reload(),a.close()})["catch"](function(e){r.toastr({type:"error",data:{title:"Xóa sản phẩm thất bại",message:e.data.message}})})})}}]})}var P=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("certificate","view")||n.go("error403"),P.loading=!0,P.submitted=!1,P.lockForm=!1,P.queryParams=a,P.cerID=a.id,P.userRoles=i,P.certificates=[],P.imagesDerectory=settingJs.configs.uploadDirectory.product,P.filter=f,P.filterReset=v,P.sort=y,P.addCertificateProduct=b,P.delCertificateProduct=T,h(),m(),c.onPagesChanged(function(){e.vmCertificateProduct.queryParams.page=P.table.page(),n.go(".",e.vmCertificateProduct.queryParams)},e,P.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","certificateSvc","tagSvc","productSvc"],angular.module("bzCertificate").controller("certificateProductCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),categoryListCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(e){null!=e.parrent_id?d.getById(e.parrent_id).then(function(e){b.listCategoriesParrent.push(e),p(e)})["catch"](function(e){r.toastr({type:"error",data:{title:"Danh mục sản phẩm cha",message:e.data.message}})}):(b.listCategoriesParrent.reverse(),m(b.query.parrentId))}function g(e){d.get(e).then(function(e){b.query.parrentId=e._id,b.categoriesParrent=e,p(e)})["catch"](function(e){r.toastr({type:"error",data:{title:"Danh mục sản phẩm cha",message:e.data.message}})})}function m(e){b.viewChild?l.api(t.settings.services.admin+"/category_child/"+e).get(b.queryParams,function(e){b.queryParams.pageCount=e.totalPage,b.listCategory=e.items,b.table=new u({count:10},{counts:[],getData:function(t){return t.total(e.totalItems),b.listCategory}}),b.table.page(b.queryParams.page),b.loading=!1}):l.api(t.settings.services.admin+"/category").get(b.queryParams,function(e){b.queryParams.pageCount=e.totalPage,b.listCategory=e.items,b.table=new u({count:10},{counts:[],getData:function(t){return t.total(e.totalItems),b.listCategory}}),b.table.page(b.queryParams.page),b.loading=!1})}function h(e){var t=d.getChild(b.queryParams,e);return t}function f(e){h(e).then(function(a){if(a.totalItems>0){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(t,a){t.popTitle="Không thể xóa",t.message="Bạn không thể xóa danh mục cha. Vui lòng xóa các danh mục con trước",t.ok=function(){n.go("categories",{parrentId:e}),a.close()},t.cancel=function(){n.go("categories",{parrentId:null}),a.close()}}]})}else{var i={ids:[e]};o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/category/:id",{id:"@id"})["delete"]({id:i.ids},function(e){r.toastr({type:"success",data:{title:"Xóa",message:"Xóa danh mục thành công!"}}),n.reload(),a.close()})}}]})}})["catch"](function(e){r.toastr({type:"error",data:{title:"Có lỗi xảy ra trong khi xóa",message:e.data.message}})})}function v(e){n.go(".",{keyword:e,page:b.queryParams.page},{notify:!1}).then(function(){n.reload()})}function y(){n.go(".",{keyword:null,page:b.queryParams.page},{notify:!1}).then(function(){n.reload()})}var b=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("category",["view"])||n.go("error403"),b.query={parrentId:null},b.viewChild=!1,b.loading=!0,b.selectedItems=[],b.queryParams=a,b.userRoles=i,b.listCategory=[],b.keyword=a.keyword,b.imagesDerectory=settingJs.configs.uploadDirectory.category,b.listCategoriesParrent=[],b.categoriesParrent=null,b.search=v,b.filterReset=y,b.remove=f,""!==a.parrentSlug?(b.viewChild=!0,g(a.parrentSlug)):m(),c.onPagesChanged(function(){e.vmListCategory.queryParams.page=b.table.page(),n.go(".",e.vmListCategory.queryParams)},e,b.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","categorySvc"],angular.module("bzCategory").controller("categoryListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),categoryEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g){function m(e){S.formData.slug=g.textToSlug(e)}function h(e){var t=d.getChild({},e);t.then(function(e){S.listChildCategory=e.items})["catch"](function(e){})}function f(){d.getById(S.formData.parrent_id).then(function(e){S.parrentCate=e})["catch"](function(e){console.log(e)})}function v(){l.api(t.settings.services.admin+"/category").get({limit:100,page:1,parrent_id:"*"},function(e){S.listCategory=e.items},function(e){r.toastr({type:"error",data:{title:"Lấy danh mục hiện có",message:e}})})}function y(e){S.formData.images.splice(e,1)}function b(n){if(S.formData.images.length>=5)return alert("Không thể thêm! Số ảnh tối đa là 5!"),!1;if(n.length>0&&S.formData.images.length<5){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"category_image",prefix:"category_image"}}).then(function(t){S.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}function T(){d.get(a.slug).then(function(e){S.formData=e,S.id=e._id,h(S.id),f()})["catch"](function(e){r.toastr({type:"error",data:{title:"Danh mục",message:e.data.message}})})}function P(e){return d.get(e)}function $(){""==S.formData.parrent_id&&(S.formData.parrent_id=null),d.update(S.formData,S.id).then(function(e){r.toastr({type:"success",data:{title:"Danh mục",message:"Cập nhật danh mục thành công"}}),n.go("categories",{parrentSlug:S.parrentCate.slug})})["catch"](function(e){r.toastr({type:"error",data:{title:"Danh mục",message:e.data.message}})})}function C(e){S.submitted=!0,S.lockForm=!0,e?S.formData.slug!=a.slug?P(S.formData.slug).then(function(e){e.status?r.toastr({type:"error",data:{title:"Không thể cập nhật",message:"Bạn đã nhập slug đang được sử dụng bởi danh mục khác!"}}):$()})["catch"](function(e){r.toastr({type:"error",data:{title:"Không thể cập nhật",message:e.data.message}})}):$():S.submitted=!0}var S=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("category",["edit"])||n.go("error403"),S.lockFOrm=!1,S.save=C,S.submitted=!1,S.id=null,S.slug=a.slug,S.uploadImage=b,S.removeImage=y,S.generatorSlug=m,S.imagesDirectory=settingJs.configs.uploadDirectory.category,S.listChildCategory=[],S.parrentCate={},T(),v()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","categorySvc","Upload","bzUtilsSvc"],angular.module("bzCategory").controller("categoryEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),categoryAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g){function m(e){$.formData.slug=g.textToSlug(e)}function h(e){return d.get(e)}function f(){l.api(t.settings.services.admin+"/category").get({limit:100,page:1,parrent_id:"*"},function(e){$.listCategory=e.items},function(e){r.toastr({type:"error",data:{title:"Lấy danh mục hiện có",message:e}})})}function v(){""==$.formData.parrent_id&&($.formData.parrent_id=null),d.create($.formData).then(function(e){r.toastr({type:"success",data:{title:"Danh mục",message:"Thêm danh mục thành công"}}),n.go("categories",{parrentSlug:$.parrentCate.slug})})["catch"](function(e){r.toastr({type:"error",data:{title:"Danh mục",message:"Tên danh mục đã tồn tại"}})})}function y(){d.getById($.formData.parrent_id).then(function(e){$.parrentCate=e})["catch"](function(e){console.log(e)})}function b(e){$.submitted=!0,$.lockForm=!0,e?h($.formData.slug).then(function(e){e.status?r.toastr({type:"error",data:{title:"Không thể thêm",message:"Bạn dã nhập slug đang được sử dụng bởi danh mục khác!"}}):v()})["catch"](function(e){r.toastr({type:"error",data:{title:"Không thể thêm",message:e.data.message}})}):$.submitted=!0}function T(e){$.formData.images.splice(e,1)}function P(n){if($.formData.images.length>=5)return alert("Không thể thêm! Số ảnh tối đa là 5!"),!1;if(n.length>0&&$.formData.images.length<5){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"category_image",prefix:"category_image"}}).then(function(t){$.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}var $=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("category",["add"])||n.go("error403"),$.lockFOrm=!1,$.save=b,$.submitted=!1,$.uploadImage=P,$.removeImage=T,$.generatorSlug=m,$.parrentCate={},$.imagesDirectory=settingJs.configs.uploadDirectory.category,$.listChildCategory=[[],[],[],[]],$.showChildCategory=[!1,!1,!1,!1],f(),$.formData={name:"",slug:"",description:"",images:[],parrent_id:a.parrentId,top:[],status:!0},y()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","categorySvc","Upload","bzUtilsSvc"],angular.module("bzCategory").controller("categoryAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),blogListCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/blog").get(v.queryParams,function(e){v.queryParams.pageCount=e.totalPage,v.listBlog=e.items,v.table=new u({count:parseInt(v.queryParams.limit)||10},{counts:[],getData:function(t){return t.total(e.totalItems),v.listBlog}}),v.table.page(v.queryParams.page),v.loading=!1})}function g(){d.getTagsBlog().then(function(e){e.success&&(v.listTag=e.data)})}function m(e){n.go(".",{keyword:v.queryParams.keyword,page:v.queryParams.page,tag:v.queryParams.tag},{notify:!1}).then(function(){n.reload()})}function h(){n.go(".",{keyword:null,page:v.queryParams.page,tag:null},{notify:!1}).then(function(){n.reload()})}function f(e){var a={ids:[e]};o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/blog/:id",{id:"@id"})["delete"]({id:a.ids},function(e){r.toastr({type:"success",data:{title:"Xóa",message:"Xóa vài viết thành công"}}),n.reload(),o.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("blog",["view"])||n.go("error403"),v.loading=!0,v.selectedItems=[],v.keyword=a.keyword,v.queryParams=a,v.imagesDirectory=settingJs.configs.uploadDirectory.blog,v.userRoles=i,v.listBlog=[],v.typeBlog=a.type||"GB",v.filter=m,v.filterReset=h,v.remove=f,p(),g(),c.onPagesChanged(function(){e.vmListBlog.queryParams.page=v.table.page(),n.go(".",e.vmListBlog.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","blogSvc"],angular.module("bzBlog").controller("blogListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),blogEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g,m,h){function f(e){_.formData.slug=g.textToSlug(e)}function v(){d.getTagsBlog().then(function(e){e.success&&(_.listTag=e.data)})}function y(e){return d.get(e)}function b(){l.api(t.settings.services.admin+"/blog").get({limit:100,page:1,parrent_id:"*"},function(e){_.listBlog=e.items},function(e){r.toastr({type:"error",data:{title:"Lấy danh mục hiện có",message:e}})})}function T(){var e=a.slug;d.get(e).then(function(e){_.formData=e})["catch"](function(e){r.toastr({type:"error",data:{title:"Không thể tải bài viết",message:e.data}})})}function P(){_.formData.listImgDelete=_.listImgDelete,d.update(_.formData,_.slug).then(function(e){r.toastr({type:"success",data:{title:"Bài viết",message:"Cập nhật viết thành công"}}),"CS"==e.type?n.go("blogsPolicy"):"GB"==e.type?n.go("blogsPost"):"MV"==e.type?n.go("blogsTip"):n.go("blogsBanner")})["catch"](function(e){r.toastr({type:"error",data:{title:"Bài viết",message:e.message}})})}function $(e){_.submitted=!0,_.lockForm=!0,e?_.formData.slug!=a.slug?y(_.formData.slug).then(function(e){e.status?r.toastr({type:"error",data:{title:"Không thể cập nhật",message:"Bạn đã nhập slug đang được sử dụng bởi bài viết khác!"}}):P()})["catch"](function(e){r.toastr({type:"error",data:{title:"Không thể cập nhật",message:e.message}})}):P():_.submitted=!0}function C(e,t){_.formData.featured_image.splice(e,1),_.listImgDelete.push({url:_.imagesDirectory,fileName:t})}function S(n){if(_.formData.featured_image.length>=5)return alert("Không thể thêm! Số ảnh tối đa là 5!"),!1;if(n.length>0&&_.formData.featured_image.length<5){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"blog_image",prefix:"blog_image"}}).then(function(t){_.formData.featured_image.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}function w(e,t){o.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,a){n.popupScope={image:_.imagesDirectory+t,event:"crop:image",ratio:407/305,width:407,height:305},n.$on("crop:image",function(n,o){h.uploadBase64({directory:"blog_image",image:o.image}).then(function(n){_.listImgDelete.push({url:_.imagesDirectory,fileName:t}),_.formData.featured_image[e].url=n.name,r.toastr({type:"success",data:{title:"Thành công!",message:"Crop ảnh thành công"}}),a.close()})["catch"](function(e){console.log("er",e)})})}]})}function H(){"CS"==_.formData.type?n.go("blogsPolicy"):"GB"==_.formData.type?n.go("blogsPost"):"MV"==_.formData.type?n.go("blogsTip"):n.go("blogsBanner")}var _=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("blog",["edit"])||n.go("error403"),_.lockFOrm=!1,_.save=$,_.submitted=!1,_.uploadImage=S,_.removeImage=C,_.listImgDelete=[],_.generatorSlug=f,_.imagesDirectory=settingJs.configs.uploadDirectory.blog,_.ckeOpt=m,_.userCurrently=s.getProfile(),_.slug=a.slug,_.cropImage=w,_.cancel=H,b(),v(),T()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","blogSvc","Upload","bzUtilsSvc","CKEditorOptBlog","bzUpload"],angular.module("bzBlog").controller("blogEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),blogAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d,p,g,m,h){function f(e){H.formData.slug=g.textToSlug(e)}function v(){d.getTagsBlog().then(function(e){e.success&&(H.listTag=e.data)})}function y(e){return d.get(e)}function b(){l.api(t.settings.services.admin+"/blog").get({limit:100,page:1,parrent_id:"*"},function(e){H.listBlog=e.items},function(e){r.toastr({type:"error",data:{title:"Lấy danh mục hiện có",message:e}})})}function T(){H.formData.listImgDelete=H.listImgDelete,d.create(H.formData).then(function(e){r.toastr({type:"success",data:{title:"Bài viết",message:"Thêm bài viết thành công"}}),"CS"==e.type?n.go("blogsPolicy"):"GB"==e.type?n.go("blogsPost"):"MV"==e.type?n.go("blogsTip"):n.go("blogsBanner")})["catch"](function(e){r.toastr({type:"error",data:{title:"Không thể thêm",message:e.data.message}})})}function P(e){H.submitted=!0,H.lockForm=!0,e?y(H.formData.slug).then(function(e){e.slug==H.formData.slug?r.toastr({type:"error",data:{title:"Không thể thêm",message:"Bạn dã nhập slug đang được sử dụng bởi danh mục khác!"}}):T()})["catch"](function(e){T()}):H.submitted=!0}function $(e,t){H.formData.featured_image.splice(e,1),H.listImgDelete.push({url:H.imagesDirectory,fileName:t})}function C(n){if(H.formData.featured_image.length>=5)return alert("Không thể thêm! Số ảnh tối đa là 5!"),!1;if(n.length>0&&H.formData.featured_image.length<5){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"blog_image",prefix:"blog_image"}}).then(function(t){H.formData.featured_image.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}}),S(H.formData.featured_image.length-1,H.formData.featured_image[H.formData.featured_image.length-1].url)},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}function S(e,t){o.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,a){n.popupScope={image:H.imagesDirectory+t,event:"crop:image",ratio:407/305,width:407,height:305},n.$on("crop:image",function(n,o){h.uploadBase64({directory:"blog_image",image:o.image}).then(function(n){H.listImgDelete.push({url:H.imagesDirectory,fileName:t}),H.formData.featured_image[e].url=n.name,r.toastr({type:"success",data:{title:"Thành công!",message:"Crop ảnh thành công"}}),a.close()})["catch"](function(e){console.log("er",e)})})}]})}function w(){"CS"==a.type?n.go("blogsPolicy"):"GB"==a.type?n.go("blogsPost"):"MV"==a.type?n.go("blogsTip"):n.go("blogsBanner")}var H=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("blog",["add"])||n.go("error403"),H.lockFOrm=!1,H.save=P,H.submitted=!1,H.uploadImage=C,H.removeImage=$,H.listImgDelete=[],H.listTag=[],H.generatorSlug=f,H.imagesDirectory=settingJs.configs.uploadDirectory.blog,H.ckeOpt=m,H.userCurrently=s.getProfile(),H.cropImage=S,H.cancel=w,b(),v(),H.formData={name:"",slug:"",type:a.type,meta_title:"",meta_keywords:"",meta_description:"",short_description:"",content:"",auth_id:H.userCurrently.uid,featured_image:[],tags:[],status:!0}}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","blogSvc","Upload","bzUtilsSvc","CKEditorOptBlog","bzUpload"],angular.module("bzBlog").controller("blogAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}();!function(){function e(e,t,n,a,r,o){function i(){l.lockForm=!1,l.submitted=!1,l.formData={phone:"",password:""}}function s(e){l.submitted=!0,!l.lockForm&&e&&(l.lockForm=!0,t.pageMethods.authSvc.siteLogin(l.formData,function(e){a.location.href=settingJs.configs.adminUrl,l.lockForm=!1},function(e){r.toastr({type:"error",data:{title:"Login",message:e.data.message}}),l.lockForm=!1}))}function u(){o.getFacebook().then(function(e){e.error?(r.toastr({type:"error",data:{title:"Login",message:""+e.error}}),l.lockForm=!1):(c("facebook",e),l.lockForm=!0,t.pageMethods.authSvc.facebookLogin(e,function(e){a.location.href="/",l.lockForm=!1},function(e){r.toastr({type:"error",data:{title:"Login",message:e.data.message}}),l.lockForm=!1}))})}function c(e,n){t.social={type:e,id:n.id,name:n.name,email:n.email,profile_picture:n.picture+"?sz=200"},"facebook"==e&&(t.social.profile_picture="https://graph.facebook.com/v2.5/"+n.id+"/picture?width=200&height=200")}var l=this;l.siteLogin=s,l.loginFacebook=u,i()}e.$inject=["$rootScope","$scope","$state","$window","$bzPopup","authSvc"],angular.module("bzAuth").controller("authCtrl",e)}();var permissionListCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l){function d(){u.get().then(function(e){e.success&&(m.data=e.data)})["catch"](function(e){console.log(e)})}function p(e,n){r.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(r,o){r.popTitle="Xóa",r.message="Bạn muốn xóa quyền "+e+" trên "+n+"?",r.ok=function(){u.removeResource(e,n).then(function(r){a.toastr({type:"success",data:{title:"Permission",message:"Deleted "+n+"'s "+e+"!"}}),t.reload(),o.close()})["catch"](function(e){a.toastr({type:"success",data:{title:"Permission",message:e.message}})})}}]})}function g(e){r.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popTitle="Xóa",n.message="Bạn muốn xóa "+e+"?",n.ok=function(){u.removeRole(e).then(function(n){a.toastr({type:"success",data:{title:"Permission",message:"Deleted "+e+"!"}}),t.reload(),r.close()})["catch"](function(e){a.toastr({type:"success",data:{title:"Permission",message:e.message}})})}}]})}var m=this;s.isSuperAdmin()||t.go("error403"),d(),m.listAction=c,m.listResource=l,m.getData=d,m.data=[],m.removeRole=g,m.removeResource=p}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","authSvc","permissionSvc","listAction","listResource"],angular.module("bzPermission").controller("permissionListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),permissionEditCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){u.getResoureRole(n.role).then(function(e){"add-resource"==f.modEdit?e.data.forEach(function(e,t){l.indexOf(e.resource)!=-1&&l.splice(l.indexOf(e.resource),1)}):(f.formData.resource=[f.resource],e.data.forEach(function(e,t){e.resource==f.resource&&(f.formData.permission=e.permissions)}),f.formData.permission.indexOf("*")!=-1&&(f.fullPermission=!0)),f.listPermission=c,f.listResource=l})["catch"](function(e){})}function g(){f.fullPermission&&(f.formData.permission=Array.of("*"))}function m(){f.formData.role=d.textToSlug(f.formData.role)}function h(e){f.submitted=!0,f.lockForm=!0,e?(f.formData.permission.indexOf("*")!==-1&&(f.formData.permission="*"),"add-resource"==f.modEdit&&u.addResource(f.formData,f.formData.role).then(function(e){a.toastr({type:"success",data:{title:"Phân quyền",message:e.message}}),t.go("permission")})["catch"](function(e){a.toastr({type:"error",data:{title:"Phân quyền",message:e.data.message}})}),"edit-permission"==f.modEdit&&u.update(f.formData,f.formData.role,f.formData.resource).then(function(e){a.toastr({type:"success",data:{title:"Phân quyền",message:e.message}}),t.go("permission")})["catch"](function(e){a.toastr({type:"error",data:{title:"Phân quyền",message:e.data.message}})})):f.submitted=!0}var f=this;s.isSuperAdmin()||t.go("error403"),f.type=n.type,f.resource=n.resource,f.modEdit=n.mod,f.formData={role:n.role,resource:[]},f.save=h,f.checkName=m,f.onChangePermission=g,f.getResource=p}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","authSvc","permissionSvc","listAction","listResource","bzUtilsSvc"],angular.module("bzPermission").controller("permissionEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),permissionAddCtrl=function(){function e(e,t,n,a,r,o,i,s,u,c,l,d){function p(){f.fullPermission&&(f.formData.permission=Array.of("*"))}function g(){f.formData.role=d.textToSlug(f.formData.role)}function m(e,t){var n=!1;u.get().then(function(a){a.success&&a.data.forEach(function(t,a){t.role==e&&(n=!0)}),t(n)})["catch"](function(e){t(n)})}function h(e){f.submitted=!0,f.lockForm=!0,e?(f.formData.permission.indexOf("*")!==-1&&(f.formData.permission=["*"]),m(f.formData.role,function(e){e?a.toastr({type:"error",data:{title:"Phân quyền",message:"Tên quyền đã tồn tại!"}}):u.create(f.formData).then(function(e){a.toastr({type:"success",data:{title:"Phân quyền",message:e.message}}),t.go("permission")})["catch"](function(e){a.toastr({type:"error",data:{title:"Phân quyền",message:e.message}})})})):f.submitted=!0}var f=this;s.isSuperAdmin()||t.go("error403"),f.formData={role:"",resource:[],permission:[]},f.fullPermission=!1,f.listPermission=c,f.listResource=l,f.save=h,f.checkName=g,f.onChangePermission=p}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","authSvc","permissionSvc","listAction","listResource","bzUtilsSvc"],angular.module("bzPermission").controller("permissionAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}();!function(){Application.registerRouter({
state:"vocabularys",config:{url:"/vocabularys?page&limit&id&keyword&class",data:{title:"Vocabulary",menuType:"vocabulary"},params:{page:"1",sort:"-createdAt",limit:"15"},templateUrl:"modules/admin-vocabulary/view/client/list/list-vocabulary.html",controller:"vocabularysCtrl",controllerAs:"vmVocabularys"}})}(),function(){Application.registerRouter({state:"editVocabulary",config:{url:"/vocabularys/edit/{id}",data:{title:"Edit Vocabulary",menuType:"vocabulary"},params:{},templateUrl:"modules/admin-vocabulary/view/client/edit/edit-vocabulary.html",controller:"vocabularyEditCtrl",controllerAs:"vmEditVocabularys"}})}(),function(){Application.registerRouter({state:"createVocabulary",config:{url:"/vocabularys/add",data:{title:"Create new Vocabulary",menuType:"add-vocabulary"},params:{},templateUrl:"modules/admin-vocabulary/view/client/add/add-vocabulary.html",controller:"vocabularyAddCtrl",controllerAs:"vmAddVocabularys"}})}(),function(){Application.registerRouter({state:"user-shipping",config:{url:"/user-shipping/{id}",data:{title:"UserShipping",menuType:"user-shipping"},templateUrl:"modules/admin-user/view/client/user-shipping/view.html",controller:"userShippingCtrl",controllerAs:"vmUserShipping",resolve:userShippingCtrl.resolve}})}(),function(){Application.registerRouter({state:"users",config:{url:"/users?page&limit&sort&role&id&keyword&status",data:{title:"Users",menuType:"user"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-user/view/client/list-user/view.html",controller:"usersCtrl",controllerAs:"vmUsers",resolve:usersCtrl.resolve}})}(),function(){Application.registerRouter({state:"user-edit",config:{url:"/user-edit?id",data:{title:"Tài khoản",menuType:"add-user"},params:{},templateUrl:"modules/admin-user/view/client/edit/view.html",controller:"userEditCtrl",controllerAs:"userEdit",resolve:userEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"units",config:{url:"/units?page&limit&id&keyword&class",data:{title:"Unit",menuType:"unit"},params:{page:"1",sort:"-createdAt",limit:"15"},templateUrl:"modules/admin-unit/view/client/list-unit/view.html",controller:"unitsCtrl",controllerAs:"vmUnits"}})}(),function(){Application.registerRouter({state:"editUnit",config:{url:"/units/edit/{id}",data:{title:"Edit Unit",menuType:"unit"},params:{},templateUrl:"modules/admin-unit/view/client/edit-unit/view.html",controller:"unitEditCtrl",controllerAs:"vmEditUnits"}})}(),function(){Application.registerRouter({state:"createUnit",config:{url:"/units/add",data:{title:"Create new Unit",menuType:"add-unit"},params:{},templateUrl:"modules/admin-unit/view/client/add-unit/view.html",controller:"unitAddCtrl",controllerAs:"vmAddUnits"}})}(),function(){Application.registerRouter({state:"test-resize-img",config:{url:"/test/resize-img",data:{title:"test resize",menuType:"test-resize"},templateUrl:"modules/admin-test/view/client/test-resize/view.html",controller:"testResizeCtrl",controllerAs:"vmTestResize",resolve:testResizeCtrl.resolve}})}(),function(){Application.registerRouter({state:"tag-product",config:{url:"/tag-product?type&tag",data:{title:"Tag",menuType:"tag-product"},params:{type:"SP"},templateUrl:"modules/admin-tag/view/client/tag-product/view.html",controller:"tagProductCtrl",controllerAs:"vmTagProduct"}})}(),function(){Application.registerRouter({state:"tag-processing",config:{url:"/tag-processing?type",data:{title:"Tag",menuType:"tag-processing"},params:{type:"CN"},templateUrl:"modules/admin-tag/view/client/tag-processing/view.html",controller:"tagProcesssingCtrl",controllerAs:"vmTagProcessing"}})}(),function(){Application.registerRouter({state:"tag-list",config:{url:"/tag-list?page&limit&sort&role&id&keyword",data:{title:"Tag",menuType:"tag"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-tag/view/client/list-tag/view.html",controller:"tagCtrl",controllerAs:"vmTags"}})}(),function(){Application.registerRouter({state:"tag-edit",config:{url:"/tag-edit/{id}",data:{title:"Tag",menuType:"tag"},templateUrl:"modules/admin-tag/view/client/edit-tag/view.html",controller:"tagEditCtrl",controllerAs:"vmEditTags"}})}(),function(){Application.registerRouter({state:"tag-create",config:{url:"/tag-create",data:{title:"Tag",menuType:"tag"},templateUrl:"modules/admin-tag/view/client/create-tag/view.html",controller:"tagAddCtrl",controllerAs:"vmAddTags"}})}(),function(){Application.registerRouter({state:"suppliers",config:{url:"/suppliers?page&limit&sort&role&id&keyword",data:{title:"Suppliers",menuType:"supplier"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-supplier/view/client/list-supplier/view-list.html",controller:"supplierListCtrl",controllerAs:"vmListSupplier",resolve:supplierListCtrl.resolve}})}(),function(){Application.registerRouter({state:"importProductHistory",config:{url:"/suppliers/history-import-product/{id}?page&limit",data:{title:"Import Product History",menuType:"supplier"},params:{page:"1",limit:"10"},templateUrl:"modules/admin-supplier/view/client/import-product-history/view.html",controller:"supplierImportProductHistoryCtrl",controllerAs:"vmSupplierImportProductHistory"}})}(),function(){Application.registerRouter({state:"editSupplier",config:{url:"/suppliers/edit/{id}",data:{title:"Update info Supplier",menuType:"supplier"},params:{},templateUrl:"modules/admin-supplier/view/client/edit-supplier/view-edit.html",controller:"supplierEditCtrl",controllerAs:"vmsupplierEdit"}})}(),function(){Application.registerRouter({state:"createSupplier",config:{url:"/suppliers/add",data:{title:"Create new Supplier",menuType:"supplier"},params:{},templateUrl:"modules/admin-supplier/view/client/add-supplier/view-add.html",controller:"supplierAddCtrl",controllerAs:"vmsupplierAdd"}})}(),function(){Application.registerRouter({state:"shippingfee-list",config:{url:"/shippingfee-list?page&limit&sort&role&id&keyword",data:{title:"ShippingFee",menuType:"shippingfee"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-shippingfee/view/client/list-shippingfee/view.html",controller:"shippingfeeCtrl",controllerAs:"vmShippingFees"}})}(),function(){Application.registerRouter({state:"shippingfee-edit",config:{url:"/shippingfee-edit/{id}",data:{title:"ShippingFee",menuType:"shippingfee"},templateUrl:"modules/admin-shippingfee/view/client/edit-shippingfee/view.html",controller:"shippingfeeEditCtrl",controllerAs:"vmEditShippingFees"}})}(),function(){Application.registerRouter({state:"shippingfee-create",config:{url:"/shippingfee-create",data:{title:"ShippingFee",menuType:"shippingfee"},templateUrl:"modules/admin-shippingfee/view/client/create-shippingfee/view.html",controller:"shippingfeeAddCtrl",controllerAs:"vmAddShippingFees"}})}(),function(){Application.registerRouter({state:"search-list",config:{url:"/search?page&limit",data:{title:"Search",menuType:"search"},params:{page:"1",limit:"20"},templateUrl:"modules/admin-search/view/client/list-search/view.html",controller:"searchListCtrl",controllerAs:"vmSeL",resolve:searchListCtrl.resolve}})}(),function(){Application.registerRouter({state:"search-edit",config:{url:"/search-edit/{id}",data:{title:"Search",menuType:"search"},templateUrl:"modules/admin-search/view/client/edit-search/view.html",controller:"searchEditCtrl",controllerAs:"vmSeE",resolve:searchEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"search-add",config:{url:"/search-add",data:{title:"Search",menuType:"search"},templateUrl:"modules/admin-search/view/client/add-search/view.html",controller:"searchAddCtrl",controllerAs:"vmSeA",resolve:searchAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"promotion-list",config:{url:"/promotion?page&limit",data:{title:"Promotion",menuType:"promotion"},params:{page:"1",limit:"20"},templateUrl:"modules/admin-promotion/view/client/list-promotion/view.html",controller:"promotionListCtrl",controllerAs:"vmPoL",resolve:promotionListCtrl.resolve}})}(),function(){Application.registerRouter({state:"promotion-edit",config:{url:"/promotion-edit/{id}",data:{title:"promotion",menuType:"promotion"},templateUrl:"modules/admin-promotion/view/client/edit-promotion/view.html",controller:"promotionEditCtrl",controllerAs:"vmPoE",resolve:promotionEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"promotion-add",config:{url:"/promotion-add",data:{title:"promotion",menuType:"promotion"},templateUrl:"modules/admin-promotion/view/client/add-promotion/view.html",controller:"promotionAddCtrl",controllerAs:"vmPoA",resolve:promotionAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"product",config:{url:"/product?page&limit&name&status&active&category&tag&dueDate",data:{title:"Product",menuType:"product"},params:{page:"1",limit:"10"},templateUrl:"modules/admin-product/view/client/list-product/view.html",controller:"productListCtrl",controllerAs:"vmPrL",resolve:productListCtrl.resolve}})}(),function(){Application.registerRouter({state:"product-edit",config:{url:"/product-edit/{id}",data:{title:"Product",menuType:"product"},templateUrl:"modules/admin-product/view/client/edit-product/view.html",controller:"productEditCtrl",controllerAs:"vmPrE",resolve:productEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"product-add",config:{url:"/product-add",data:{title:"Product",menuType:"product"},templateUrl:"modules/admin-product/view/client/add-product/view.html",controller:"productAddCtrl",controllerAs:"vmPrA",resolve:productAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"order-report",config:{url:"/order-report?page&limit&customer_name&coupon&date&status&type&user&user_id&min_order&max_order",data:{title:"Report order",menuType:"order-report"},params:{page:"1",limit:"50"},templateUrl:"modules/admin-order/view/client/report-order/view.html",controller:"orderReportCtrl",controllerAs:"vmOrR",resolve:orderReportCtrl.resolve}})}(),function(){Application.registerRouter({state:"order-list",config:{url:"/order?page&limit&customer_name&coupon&date&status&type&user&user_id&min_order&max_order&export",data:{title:"Order list",menuType:"order"},params:{page:"1",limit:"50"},templateUrl:"modules/admin-order/view/client/list-order/view.html",controller:"orderListCtrl",controllerAs:"vmOrL",resolve:orderListCtrl.resolve}})}(),function(){Application.registerRouter({state:"order-edit",config:{url:"/order/{id}",data:{title:"Order edit",menuType:"order"},templateUrl:"modules/admin-order/view/client/edit-order/view.html",controller:"orderEditCtrl",controllerAs:"vmOrE",resolve:orderEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"order-add",config:{url:"/order-add",data:{title:"Order add",menuType:"order"},params:{page:"1",limit:"10"},templateUrl:"modules/admin-order/view/client/add-order/view.html",controller:"orderAddCtrl",controllerAs:"vmOrA",resolve:orderAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"logs",config:{url:"/log?page&limit&action&label&date",data:{title:"System log",menuType:"log"},params:{page:"1",limit:"20"},templateUrl:"modules/admin-log/view/client/list/log-list.html",controller:"auditLogCtrl",controllerAs:"vmLog",resolve:auditLogCtrl.resolve}})}(),function(){Application.registerRouter({state:"coupon-list",config:{url:"/coupon-list?page&limit&sort&role&id&keyword",data:{title:"Coupon",menuType:"coupon"},params:{page:"1",sort:"-createdAt",limit:"20"},templateUrl:"modules/admin-coupon/view/client/list-coupon/view.html",controller:"couponCtrl",controllerAs:"vmCoupons"}})}(),function(){Application.registerRouter({state:"coupon-edit",config:{url:"/coupon-edit/{id}",data:{title:"Coupon",menuType:"coupon"},templateUrl:"modules/admin-coupon/view/client/edit-coupon/view.html",controller:"couponEditCtrl",controllerAs:"vmEditCoupons"}})}(),function(){Application.registerRouter({state:"coupon-create",config:{url:"/coupon-create",data:{title:"Coupon",menuType:"coupon"},templateUrl:"modules/admin-coupon/view/client/create-coupon/view.html",controller:"couponAddCtrl",controllerAs:"vmAddCoupons"}})}(),function(){Application.registerRouter({state:"configs",config:{url:"/configs?page&limit&sort&role&id&keyword",data:{title:"Configs",menuType:"config"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-config/view/client/list/view.html",controller:"configListCtrl",controllerAs:"vmListConfig",resolve:configListCtrl.resolve}})}(),function(){Application.registerRouter({state:"editConfig",config:{url:"/config/edit/{id}",data:{title:"Edit Config",menuType:"config"},params:{},templateUrl:"modules/admin-config/view/client/edit/view.html",controller:"configEditCtrl",controllerAs:"vmEditConfig"}})}(),function(){Application.registerRouter({state:"createConfig",config:{url:"/configs/add",data:{title:"Create new Config",menuType:"config"},params:{},templateUrl:"modules/admin-config/view/client/add/view.html",controller:"configAddCtrl",controllerAs:"vmAddConfigs"}})}(),function(){Application.registerRouter({state:"certificate-list",config:{url:"/certificate-list?page&limit&sort&role&id&keyword",data:{title:"Certificate",menuType:"certificate"},params:{page:"1",sort:"-createdAt",limit:"20"},templateUrl:"modules/admin-certificate/view/client/list-certificate/view.html",controller:"certificateCtrl",controllerAs:"vmCertificates"}})}(),function(){Application.registerRouter({state:"certificate-edit",config:{url:"/certificate-edit/{id}",data:{title:"Certificate",menuType:"certificate"},templateUrl:"modules/admin-certificate/view/client/edit-certificate/view.html",controller:"certificateEditCtrl",controllerAs:"vmEditCertificates"}})}(),function(){Application.registerRouter({state:"certificate-create",config:{url:"/certificate-create",data:{title:"Certificate",menuType:"certificate"},templateUrl:"modules/admin-certificate/view/client/create-certificate/view.html",controller:"certificateAddCtrl",controllerAs:"vmAddCertificates"}})}(),function(){Application.registerRouter({state:"certificate-product",config:{url:"/certificate-product/{id}?page&limit&sort&role&keyword",data:{title:"Certificate",menuType:"certificate"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-certificate/view/client/certificate-product/view.html",controller:"certificateProductCtrl",controllerAs:"vmCertificateProduct"}})}(),function(){Application.registerRouter({state:"categories",config:{url:"/categories/{parrentSlug}?page&limit&sort&role&id&keyword",data:{title:"Categories",menuType:"category"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-category/view/client/list-category/view-list.html",controller:"categoryListCtrl",controllerAs:"vmListCategory"}})}(),function(){Application.registerRouter({state:"editCategory",config:{url:"/category/edit/{slug}",data:{title:"Edit new Category",menuType:"category"},params:{},templateUrl:"modules/admin-category/view/client/edit-category/view-edit.html",controller:"categoryEditCtrl",controllerAs:"vmcategoryEdit"}})}(),function(){Application.registerRouter({state:"createCategory",config:{url:"/category/add/{parrentId}",data:{title:"Create new Category",menuType:"category"},params:{},templateUrl:"modules/admin-category/view/client/add-category/view-add.html",controller:"categoryAddCtrl",controllerAs:"vmcategoryAdd",resolve:categoryAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"blogsPost",config:{url:"/blog-post?page&limit&sort&role&id&keyword&type&tag",data:{title:"Blogs Post",menuType:"blog-post"},params:{page:"1",sort:"-createdAt",limit:"10",type:"GB"},templateUrl:"modules/admin-blog/view/client/list/view-post.html",controller:"blogListCtrl",controllerAs:"vmListBlog",resolve:blogListCtrl.resolve}}),Application.registerRouter({state:"blogsPolicy",config:{url:"/blogs-policy?page&limit&sort&role&id&keyword&type",data:{title:"Blogs Policy",menuType:"blog-policy"},params:{page:"1",sort:"-createdAt",limit:"10",type:"CS"},templateUrl:"modules/admin-blog/view/client/list/view-policy.html",controller:"blogListCtrl",controllerAs:"vmListBlog",resolve:blogListCtrl.resolve}}),Application.registerRouter({state:"blogsBanner",config:{url:"/blogs-banner?page&limit&sort&role&id&keyword&type",data:{title:"Blogs Banner",menuType:"blog-banner"},params:{page:"1",sort:"-createdAt",limit:"10",type:"BN"},templateUrl:"modules/admin-blog/view/client/list/view-banner.html",controller:"blogListCtrl",controllerAs:"vmListBlog",resolve:blogListCtrl.resolve}}),Application.registerRouter({state:"blogsTip",config:{url:"/blogs-tip?page&limit&sort&role&id&keyword&type",data:{title:"Blogs Tips",menuType:"blog-tip"},params:{page:"1",sort:"-createdAt",limit:"10",type:"MV"},templateUrl:"modules/admin-blog/view/client/list/view-tip.html",controller:"blogListCtrl",controllerAs:"vmListBlog",resolve:blogListCtrl.resolve}})}(),function(){Application.registerRouter({state:"editPost",config:{url:"/blog/edit/{slug}",data:{title:"Edit Post",menuType:"blog-post"},params:{},templateUrl:"modules/admin-blog/view/client/edit/view.html",controller:"blogEditCtrl",controllerAs:"vmEditBlog"}})}(),function(){Application.registerRouter({state:"createPost",config:{url:"/blog/add?type",data:{title:"Create new Post",menuType:"blog-post"},params:{type:"GB"},templateUrl:"modules/admin-blog/view/client/add/view.html",controller:"blogAddCtrl",controllerAs:"vmBlogAdd"}})}(),function(){Application.registerRouter({state:"permission",config:{url:"/permission",data:{title:"Permission",menuType:"permission"},params:{},templateUrl:"modules/admin-acl/view/client/list/view.html",controller:"permissionListCtrl",controllerAs:"vmPermission",resolve:permissionListCtrl.resolve}})}(),function(){Application.registerRouter({state:"editPermission",config:{url:"/permission/edit/{mod}/{role}/{resource}",data:{title:"Edit Permission",menuType:"permission"},params:{},templateUrl:"modules/admin-acl/view/client/edit/view.html",controller:"permissionEditCtrl",controllerAs:"vmEditPermission",resolve:permissionListCtrl.resolve}})}(),function(){Application.registerRouter({state:"add-permission",config:{url:"/permission/add",data:{title:"Add permission",menuType:"permission"},params:{},templateUrl:"modules/admin-acl/view/client/add/view.html",controller:"permissionAddCtrl",controllerAs:"vmAddPermission",resolve:permissionAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"dashboard",config:{url:"/",data:{title:"Dashboard",menuType:"dashboard"},params:{},templateUrl:"modules/admin-dashboard/view/client/view.html",controller:"dashboardCtrl",controllerAs:"vmDashboard",resolve:dashboardCtrl.resolve}})}(),function(){Application.registerRouter({state:"error404",config:{url:"/error404",data:{title:"Error 404",menuType:"error404"},templateUrl:"modules/admin-core/view/client/error/404.html"}}),Application.registerRouter({state:"error403",config:{url:"/error403",data:{title:"Error 403",menuType:"error403"},templateUrl:"modules/admin-core/view/client/error/403.html"}})}();